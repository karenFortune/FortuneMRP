@model FortuneSystem.Models.Pedidos.OrdenesCompra

@{
    ViewBag.Title = "Style PO";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>

<!-- DevExtreme themes -->
<link rel="stylesheet" type="text/css" href="~/Content/dx.common.css" />
<link rel="stylesheet" type="text/css" href="~/Content/dx.light.css" />


<!-- DevExtreme library -->
<script type="text/javascript" src="~/Scripts/jszip.min.js"></script>
<script type="text/javascript" src="~/Scripts/dx.all.js"></script>

<script src="~/Scripts/general/obtenerListadoQC.js"></script>

<script src="~/Scripts/general/date.format.js"></script>
<!--<link type="text/css" href="~/Content/cssGeneral/estiloRadioButtonPrintS.css" rel="stylesheet" />-->

<script src="~/Content/datetimepicker-master/jquery.datetimepicker.js"></script>
<script src="~/Content/datetimepicker-master/build/jquery.datetimepicker.full.min.js"></script>
<link rel="stylesheet" type="text/css" href="~/Content/datetimepicker-master/build/jquery.datetimepicker.min.css" />

<style>
    tr.highlighted td {
        background: #b3e0ff;
    }

    .table-responsive {
        overflow: visible !important
    }

    input[type=number] {
        width: 50%;
        text-align: center;
    }

    input.numeric {
        width: 50%;
        text-align: center;
    }

    input.number {
        width: 50%;
        text-align: center;
    }

    /*th, td {
        border: 1px solid blue;
        width: 100px;
        word-wrap: break-word;
    }
    */
    #guardarBatch {
        margin-left: 1000px;
        margin-top: 1px;
        width: 100px;
        height: 40px;
        border: none;
        font-size: 20px;
        font-weight: 600;
    }

    #registrarNuevo {
        margin-left: 50px;
        margin-top: 1px;
        width: 170px;
        height: 40px;
        border: none;
        font-size: 15px;
        font-weight: 600;
    }

    #modificarBatch {
        margin-left: 750px;
        margin-top: 1px;
        width: 120px;
        height: 40px;
        border: none;
        font-size: 20px;
        font-weight: 600;
    }

    #detailsPack {
        margin-left: 10px;
        margin-top: 1px;
        width: 210px;
        height: 40px;
        border: none;
        font-size: 20px;
        font-weight: 600;
    }

    input.txtDes {
        background-color: transparent;
        border: 0px;
        outline: none;
        -webkit-box-shadow: none;
        -moz-box-shadow: none;
        box-shadow: none;
        width: 50%;
        text-align: center;
        font-size: 15px;
        font-weight: bold;
    }



    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 60%;
        height: 25%;
    }

    .tImagen {
        text-align: center;
        font-size: 20px;
    }

    #flecha {
        cursor: auto;
    }

    img {
        cursor: zoom-in;
    }

    #pie {
        height: 500px;
    }

    .letrero {
        font-family: impact, sans-serif;
        font-size: 3em;
        text-align: center;
        letter-spacing: 3.8pt;
        color: #2f77b5;
    }

    .edit_driver {
    }

        .edit_driver:hover {
            color: white !important;
            background: #3479bf !important;
            border-radius: 15px;
        }
</style>
<script>
    $(function () {
        $("#QCReport_Fecha").datepicker();
        $('#QCReport_FechaRM').datepicker({
            closeText: 'Cerrar',
            prevText: '<Ant',
            nextText: 'Sig>',
            currentText: 'Hoy',
            monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            changeMonth: true,
            changeYear: true,
            showButtonPanel: true,
            dateFormat: 'MM yy',
            onClose: function (dateText, inst) {
                $(this).datepicker('setDate', new Date(inst.selectedYear, inst.selectedMonth, 1));
            }
        });

        $("#QCReport_Fecha2").datepicker();
        $('#selectPL').select2({
        });

    })


    $(document).ready(function () {

        $('#fechas2').datetimepicker({
            datepicker: false,
            format: 'H:i'
        });
        $('#fechasp').datetimepicker({
            datepicker: false,
            format: 'H:i'
        });
    });


</script>
@{
    if (TempData["eliminarBatch"] != null)
    {
        <script type="text/javascript">
            alertify.set('notifier', 'position', 'top-right');
            alertify.notify(@Html.Raw(Json.Encode(TempData["eliminarBatch"])), 'success', 5, null);

        </script>
    }
}
</div>
<div class="modal fade" id="enlargeImageModal" tabindex="-1" role="dialog" aria-labelledby="enlargeImageModal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel">ART</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
            </div>
            <div class="modal-body">
                <img class="enlargeImageModalSource center" style="width: 80%;">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal PACKING-->
<div class="modal fade" id="ModalPacking" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalCenterTitle">PACKING QUANTITY</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="titulo_Tipo_Empaque" style="display:none; text-align:center"></div>
                <div style="width: 100%; height:400px; overflow:auto;" id="tablaPackingcont">
                    <table id="tablePacking" class="table table-sm table-striped table-hover">
                        <thead class="encabezado"></thead>
                        <tbody class="tbodyP"></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal PRINTSHOP-->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalCenterTitle">PRINTSHOP QUANTITY</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <table id="tableGeneral" class="table table-sm table-striped table-hover ">
                    <thead class="encabezado"></thead>
                    <tbody class="tbodysPrintShop"></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid" style="padding-left:6em; padding-right:8em;">
    <div class="letrero">QC REPORT</div>
    <div class="panel panel-primary" id="consultaPO">
        <div class="panel-heading">
            <h2>Reference Order: <label style="font-size: x-large; font-weight: 500; color:white;" id="PO"> @Html.DisplayFor(model => model.PO, new { @class = "control-label col-md-6" })</label>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      Purchase Order: <label style="font-size: x-large; font-weight: 500; color:white;" id="VPO">@Html.DisplayFor(model => model.VPO, new { @class = "control-label col-md-6" })</label></h2>

            <br />
            <br />
        </div>
        @Html.HiddenFor(model => model.IdPedido)
        @Html.HiddenFor(model => model.CatClienteFinal.NombreCliente)
        @Html.HiddenFor(model => model.NumeroPedido)
    </div>

    <div class="container-fluid">
        <div class="form-row">
            <div class="form-group col-sm-4 estilo">
                <label style="font-size: x-large; font-weight: 500">
                    @Html.LabelFor(model => model.CatCliente.Nombre, new { @class = "control-label" }):
                    <label style="font-size: x-large; font-weight: 500" id="cliente">@Html.DisplayFor(model => model.CatCliente.Nombre, new { @class = "control-label col-md-6" })</label>
                </label>
            </div>
            <div class="form-group col-sm-7 estilo">
                <label style="font-size: x-large; font-weight: 500">
                    @Html.LabelFor(model => model.CatClienteFinal.NombreCliente, new { @class = "control-label" }):
                    <label style="font-size: x-large; font-weight: 300" id="clienteF">@Html.DisplayFor(model => model.CatClienteFinal.NombreCliente, new { @class = "control-label col-md-6" })</label>
                </label>
            </div>
        </div>
    </div>

    <div class="panel panel-primary" id="consultaPO">
        <div class="panel-heading">

            @Html.HiddenFor(model => model.InfoSummary.IdItems)
            <input type="text" class="form-control pull-right" style="width:20%" id="searchPO" placeholder="Type to search PO...">
            <div class="form-group">
                <h4>STYLES</h4>

            </div>
        </div>
        <div id="div_tabla_estilos" style="width: 100%; height:250px; overflow:auto; ">
            <br />
            <div class="form-group">
                <input type="text" class="form-control pull-right" style="width:20%" id="search" placeholder="Type to search Style...">
            </div>
            <table id="tableEstilos" class="table table-sm table-striped table-hover ">
                <thead>
                    <tr>
                        <th style="border-top-left-radius:0px !important;">#</th>
                        @if (Model.CatCliente.Customer == 2)
                        {
                            <th>PO FANTASY#</th>
                        }
                        <th>ITEM</th>
                        <th>ITEM DESCRIPTION</th>
                        <th>COLOR CODE</th>
                        <th>COLOR DESCRIPTION</th>
                        <th>QTY</th>
                        <th>PRICE</th>
                        <th>TOTAL</th>
                        <th>ACTIONS</th>
                    </tr>
                </thead>
                <tbody class="tbodyQC"></tbody>
            </table>
        </div>

    </div>

    <br />
    <br />

    <div class="row" style="display:none;" id="panelReport">
        <div class="col-sm-13">
            <div class="panel panel-primary" id="datosReporte" style="visibility:hidden;  height: 1600px; ">
                <div class="panel-heading">
                    <h4>QC REPORT</h4>
                    @Html.HiddenFor(model => model.QCReport.IdQCReport)
                </div>
                <div id="menuTabs" style="padding-left:1em;">
                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="#turn1">PrintShop Report</a></li>
                        <li><a data-toggle="tab" href="#MisPrint">MisPrint</a></li>
                        <li><a data-toggle="tab" href="#ReportM">Monthly Report</a></li>
                    </ul>
                    <div class="tab-content">
                        <div id="turn1" class="tab-pane fade in active" style="padding-left:1em;">
                            <h3>REPORT</h3>
                            <div class="container-fluid">
                                <div class="form-row">
                                    <div class="form-group col-md-4">
                                        @Html.LabelFor(model => model.QCReport.Turnos, htmlAttributes: new { @class = "control-label " })
                                        @Html.EnumDropDownListFor(model => model.QCReport.Turnos, "Select Shift", new { @class = "form-control" })
                                        @Html.ValidationMessageFor(model => model.QCReport.Turnos, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                            <div id="contenedorReporte" style="display:none;">
                                <div class="container-fluid">
                                    <div class="form-row">
                                        <div class="form-group col-md-4">
                                            @Html.LabelFor(model => model.QCReport.Fecha, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.Fecha, new { htmlAttributes = new { @class = "form-control date-picker nuevo_rep" } })
                                            @Html.ValidationMessageFor(model => model.QCReport.Fecha, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="form-group col-md-4">
                                            @Html.LabelFor(model => model.QCReport.Maquinas, htmlAttributes: new { @class = "control-label " })
                                            @Html.EnumDropDownListFor(model => model.QCReport.Maquinas, "Select Machine", new { @class = "form-control" })
                                        </div>

                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <div class="form-row">
                                        <div class="form-group ">
                                            @Html.LabelFor(model => model.QCReport.ReporteG, htmlAttributes: new { @class = "control-label " }) <br />
                                            @Html.TextAreaFor(model => model.QCReport.ReporteG, 10, 20, new { @class = "form-control nuevo_rep", style = "max-width:100% !important;" })
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <h2>Personal</h2>
                                    <div class="form-group col-sm-6 estilo">
                                        <div class="form-group col-md-8">
                                            @Html.LabelFor(model => model.QCReport.Sacador, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.Sacador, new { htmlAttributes = new { @class = "form-control nuevo_rep", @style = "text-transform:uppercase" } })
                                        </div>
                                        <div class="form-group col-md-8">
                                            @Html.LabelFor(model => model.QCReport.Cachador, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.Cachador, new { htmlAttributes = new { @class = "form-control nuevo_rep", @style = "text-transform:uppercase" } })
                                        </div>
                                        <div class="form-group col-md-8">
                                            @Html.LabelFor(model => model.QCReport.Metedor, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.Metedor, new { htmlAttributes = new { @class = "form-control nuevo_rep", @style = "text-transform:uppercase" } })
                                        </div>
                                        <div class="form-group col-md-8">
                                            @Html.LabelFor(model => model.QCReport.QCInspector, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.QCInspector, new { htmlAttributes = new { @class = "form-control  nuevo_rep", @style = "text-transform:uppercase" } })
                                        </div>
                                    </div>
                                    <div class="form-group col-sm-5 estilo">
                                        <div class="form-group col-md-8">
                                            @Html.LabelFor(model => model.QCReport.AQL, htmlAttributes: new { @class = "control-label" })<br />
                                            @Html.DropDownListFor(model => model.QCReport.AQL,
                                                new List<SelectListItem> {
                                                     new SelectListItem { Value = "true" , Text = "Approved" },
                                                     new SelectListItem { Value = "false" , Text = "Not Approved" }
                                                  },
                                                new { @class = "form-control  nuevo_rep myselect" })
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <h2>WASH TEST</h2>
                                    <div class="table-responsive">
                                        <table class="table table-striped table-bordered" id="tablaPruebaLavado">
                                            <thead>
                                                <tr>
                                                    <th style="text-align:center">HOUR</th>
                                                    <th style="text-align:center">SIZE</th>
                                                    <th style="text-align:center">RESULT</th>
                                                </tr>
                                            </thead>
                                            <tbody class="tbodyPruebaLavado"></tbody>
                                        </table>
                                        <table class="table table-striped table-bordered" id="tablaPruebaLavadoModif">
                                            <thead>
                                                <tr>
                                                    <th style="text-align:center">#</th>
                                                    <th style="text-align:center">HOUR</th>
                                                    <th style="text-align:center">SIZE</th>
                                                    <th style="text-align:center">RESULT</th>
                                                </tr>
                                            </thead>
                                            <tbody class="tbodyPruebaLavadoModif"></tbody>
                                        </table>
                                    </div>

                                </div>
                                <div class="container-fluid">
                                    <div class="text-center margin-bottom col-sm-12">
                                        <button type="button" class="btn btn-success" id="nuevoReporteT1" onclick="registrarReporte1();" data-toggle="modal">
                                            <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Save
                                        </button>
                                        <button type="button" class="btn btn-success" id="modificarReportT1" onclick="actualizarReporte();" data-toggle="modal">
                                            <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Modify
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="MisPrint" class="tab-pane fade" style="padding-left:1em;">

                            <div class="container-fluid">
                                <h2>MisPrint</h2>
                                <div class="container-fluid">
                                    <div class="form-row">
                                        <div class="form-group col-md-4">
                                            @Html.LabelFor(model => model.QCReport.Fecha2, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.Fecha2, new { htmlAttributes = new { @class = "form-control date-picker nuevo_rep" } })
                                            @Html.ValidationMessageFor(model => model.QCReport.Fecha2, "", new { @class = "text-danger" })
                                        </div>

                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped " id="tablaMisprints">
                                        <thead class="encabezado"></thead>
                                        <tbody class="tbodyMisp"></tbody>
                                    </table>
                                </div>
                            </div>
                            <script src="~/Scripts/general/calculosPrintShop.js"></script>
                            <div class="container-fluid">
                                <div class="text-center margin-bottom col-sm-12">
                                    <button type="button" class="btn btn-success" id="nuevoRegistroMP" onclick="registrarTablaMisprint();" data-toggle="modal">
                                        <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Save
                                    </button>
                                    <button type="button" class="btn btn-success" id="modificarMP" onclick="actualizarTablaMisprint();" data-toggle="modal">
                                        <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Modify
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="ReportM" class="tab-pane fade" style="padding-left:1em;">

                            <div class="container-fluid">
                                <h2>Monthly Report</h2>
                                <div class="container-fluid">
                                    <div class="form-row">

                                        <div class="form-group col-md-2">
                                            @Html.LabelFor(model => model.QCReport.FechaRM, htmlAttributes: new { @class = "control-label" })
                                            @Html.EditorFor(model => model.QCReport.FechaRM, new { htmlAttributes = new { @class = "form-control date-picker nuevo_rep" } })
                                            @Html.ValidationMessageFor(model => model.QCReport.FechaRM, "", new { @class = "text-danger" })

                                        </div>
                                        <div class="form-group col-md-4">
                                            <br />
                                            <button type="button" class="btn btn-primary  " id="buscarReporte">
                                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Search
                                            </button>

                                        </div>

                                    </div>
                                </div>
                                <div class="table-responsive" id="contenedorTRM" style="display:none">
                                    <table class="table table-striped " id="tablaReporteMensual">
                                        <thead class="encabezado"></thead>
                                        <tbody class="tbodyTRM"></tbody>
                                    </table>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>

                <br />

            </div>

        </div>
    </div>

</div>
<br />
<br />
<br />
<a href='@Url.Action("Index", "Pnl")'>
    <img src='@Url.Content("~/Content/img/backToPage.png")' id="flecha" title="Go Back" />
</a>


<script>

    $('.tbodyMisp').keydown(function (e) {
        var $table = $(this);
        var $active = $('input:focus,select:focus', $table);
        var $next = null;
        var focusableQuery = 'input:visible,select:visible,textarea:visible';
        var position = parseInt($active.closest('td').index()) + 1;
        switch (e.keyCode) {
            case 37:
                $next = $active.parent('td').prev().find(focusableQuery);
                break;
            case 38:
                $next = $active
                    .closest('tr')
                    .prev()
                    .find('td:nth-child(' + position + ')')
                    .find(focusableQuery);
                break;
            case 39:
                $next = $active.closest('td').next().find(focusableQuery);
                break;
            case 40:
                $next = $active
                    .closest('tr')
                    .next()
                    .find('td:nth-child(' + position + ')')
                    .find(focusableQuery);
                break;
        }
        if ($next && $next.length) {
            $next.focus();
        }
    });

    $('#buscarReporte').click(function (e) {
        var error = 0;
        var fecha = $("#QCReport_FechaRM").val();
        if (fecha === "") {
            error++;
            $('#QCReport_FechaRM').css('border', '2px solid #e03f3f');
        }
        else {
            $('#QCReport_FechaRM').css('border', '');
        }

        if (error !== 0) {
            var alert = alertify.alert("Message", 'Please capture the search date.').set('label', 'Aceptar');
            alert.set({ transition: 'zoom' });
            alert.set('modal', false);
        } else {
            debugger
            $("#datosReporte").css("visibility", "visible");
            var estiloId = $("#InfoSummary_IdItems").val();
            obtenerTablaReporteMensual(estiloId, fecha);
        }

    });
</script>
