@{
    ViewBag.Title = "TRIMS";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-zh-CN.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
<link href="~/Content/base_m.css" rel="stylesheet" />
<script>
    /***************************************************************************************************************************************************************/
    /*INICIO*/
    var trims, cajas,auditoria;
    $(document).on("input", ".numeric", function () {
        this.value = this.value.replace(/\D/g, '');
    });
    $(document).on("input", ".validacion", function () {
        var c = this.selectionStart,
            r = /[^a-zA-Z0-9áéíóúÁÉÍÓÚñÑ .()!@@/#_%-]/,
            v = $(this).val();
        if (r.test(v)) {
            $(this).val(v.replace(r, ''));
            c--;
        }
        this.setSelectionRange(c, c);
    });
    $(document).on("click", "a", function () { $("#loading").css('display', 'none'); });

    var myVar, usuario; usuario = @ViewBag.usuario, sucursal=@ViewBag.sucursal;
    var lista_familias;
    $('.js-example-basic-single').select2({
  placeholder: 'Select an option'
});
    $(document).ready(function () {
        buscar_familias();
        trims = 0; cajas = 0;
        llenar_tabla_trims_minimos();
        llenar_tabla_ordenes_inicio(); //pos con sus familias
        llenar_items_trim();
        llenar_tabla_trim_recibido_inicio();//trim recibidos
        $('.js-example-basic-single').select2();
        $('.js-example-basic-single2').select2();        
        $("body").tooltip({ selector: '[data-toggle=tooltip]' });
        $(document).on("input", ".po", function () { $('.po').autocomplete({ source: '@Url.Action("Autocomplete_po")' }); });
        $(document).on("input", "#caja_location", function () { $('#caja_location').autocomplete({ source: '@Url.Action("Autocomplete_ubicacion")' }); });
        $(document).on("input", "#caja_lugar_nuevo", function () { $('#caja_lugar_nuevo').autocomplete({ source: '@Url.Action("Autocomplete_ubicacion")' }); });

    });
    $(document).on("input", "#caja_lugar_nuevo", function () { $('#caja_lugar_nuevo').autocomplete({ source: '@Url.Action("Autocomplete_ubicacion")' }); });
    $(function () {
        $.datepicker.regional['es'] = {
            closeText: 'Cerrar',
            prevText: '<Ant',
            nextText: 'Sig>',
            currentText: 'Hoy',
            monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
                'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
            dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mié', 'Juv', 'Vie', 'Sáb'],
            dayNamesMin: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sá'],
            weekHeader: 'Sm',
            dateFormat: 'yy-mm-dd',
            firstDay: 1,
            isRTL: false,
            showMonthAfterYear: false,
            yearSuffix: ''
        };
        $.datepicker.setDefaults($.datepicker.regional['es']);
        $('[data-toggle="tooltip"]').tooltip();
        $('#caja_fecha_recibo').datepicker();
        $('#caja_busqueda_fecha_trim_recibo').datepicker();
        $('#caja_inicio').datepicker();
        $('#caja_final').datepicker();
        $('#caja_inicio_lista_entrega').datepicker();
        $('#caja_final_lista_entrega').datepicker();
        $('#caja_inicio_transfer').datepicker();
        $('#caja_final_transfer').datepicker();
    });//DATEPICKER
    function buscar_familias() {
        $.ajax({
            url: '/Trims/buscar_familias_trims',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                lista_familias = jsonData.Data.familias;
                var html = '';
                 $.each(lista_familias, function (key, item) {
                    html += '<option>' + item.family + '</option>';
                 });
                $('.familia_trim').html(html);
            }
        });
    }
    function llenar_tabla_ordenes_inicio() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_ordenes_tabla_inicio',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    var total_orden = 0, total_recibido = 0, total_final = 0;
                    total_final = ((item.cantidad * 100) / item.total).toFixed(2);

                    if (item.cantidad >= item.total || item.estado==2) {
                        html += '<tr style="color:#3c763d;">'; //verde
                    } else {
                        if (item.estado == 1) {
                            html += '<tr style="color:#941c1c;">'; //rojo
                        } else {
                            if (item.estado == 3) {
                                html += '<tr style="color:#020954;">';//azul
                            } else {
                                html += '<tr style="color:#101112;">'; //gris
                            }
                        }    
                    }

                    /*if (item.estado == 1) {
                       html += '<tr style="color:#941c1c;">'; //rojo
                    } else {
                        if (item.estado == 2) {
                            html += '<tr style="color:#3c763d;">';//verde
                        } else {
                            if (item.estado == 3) {
                                html += '<tr style="color:#020954;">';//azul
                            } else {
                                html += '<tr style="color:#101112;">'; //gris
                            }
                        }
                    }   */ 

                    /*if (item.cantidad >= item.total) {
                        html += '<tr style="color:#3c763d;">'; //verde
                    } else {
                        html += '<tr style="color:#941c1c;">'; //rojo
                    }*/
                    if (item.cantidad == 0 && item.total == 0) { total_final = 0; }
                    html += '<td style="width:10%;">' + item.id_pedido + '</td>';
                    html += '<td style="width:15%;">' + item.pedido + '</td>';
                    html += '<td style="width:15%;">' + item.total  + '</td>';
                    html += '<td style="width:20%;">' + item.cantidad + '</td>';
                    html += '<td style="width:20%;">' + total_final + '% </td>';
                    if (item.estado == 1) {
                        html += '<td style="width:20%;">OPEN</td>';
                    } else {
                        if (item.estado == 2) {
                            html += '<td style="width:20%;">CLOSED</td>';
                        } else {
                            html += '<td style="width:20%;">CANCELED</td>';
                        }
                    }                    
                    html += '</tr>';
                });
                $(".body_tabla_ordenes_inicio").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_items_trim() {
       $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_inventario_items_trim',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_item + '">' + item.descripcion + '</option>';
                });
                $(".items_request").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_tabla_trim_recibido_inicio() {
        $("#load_trim").css('display', 'inline');
        var busqueda, fecha;
        if ($("#caja_busqueda_trim_recibido").val() == "") { busqueda = '0'; } else { busqueda = $("#caja_busqueda_trim_recibido").val();}
        if ($("#caja_busqueda_fecha_trim_recibo").val() == "") { fecha = '0'; } else { fecha = $("#caja_busqueda_fecha_trim_recibo").val();}
        $.ajax({
            url: '/Trims/buscar_trims_recibidos_tabla_inicio',
            contentType: 'application/json',
            data: "{'busqueda':'" +busqueda + "','fecha':'" + fecha+"'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.tabla;
                var mps = jsonData.Data.mps;
                var html = '';
                $.each(result, function (key, item) {
                    if (item.auditoria==1) {
                        html += '<tr style="color:#3c763d;">';
                    } else {
                        html += '<tr style="color:#941c1c;">';
                    }
                    html += '<td>' + item.id_inventario + '</td>';
                    html += '<td>' + item.po + '</td>';
                    html += '<td>' + item.descripcion + '</td>';
                    html += '<td>' + item.fecha + '</td>';
                    html += '<td>' + item.total + '</td>';
                    if (item.auditoria == 1) {
                        html += '<td><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></td>';
                    } else {
                        html += '<td><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></td>';
                    }
                    html += '</tr>';
                });
                $(".body_tabla_trim_recibido").html(html);
                html = 'MP Numbers today: ';
                $.each(mps, function (key, item) {
                    html += ' '+item.mp_number +' ';
                });
                $("#mp_numbers_label").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    /*INICIO*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*ITEMS*/
    $(document).on("click", ".items_catalogue_class", function () {
        $("#load_trim").css('display', 'inline');
        llenar_items_edicion();
    });
    function llenar_tabla_catalogo() {
      var busqueda;
      if ($('#caja_busqueda_catalogo').val() != '') { busqueda = $('#caja_busqueda_catalogo').val(); }
      else { busqueda = 0; }
        $.ajax({
            url: '/Trims/buscar_items_recibos_trims',
            data:"{'busqueda':'"+busqueda+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $(".body_tabla_catalogo").html('');
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:5%">'+item.id_item+'</td>';
                    html += '<td style="width:20%">'+item.componente+'</td>';
                    html += '<td style="width:45%">'+item.descripcion+'</td>';
                    html += '<td style="width:20%">' + item.familia + '</td>';
                    html += '<td style="width:5%"><button type="button" class="btn boton_tabla glyphicon glyphicon-pencil" aria-hidden="true" onclick="buscar_datos_edicion_trim(' + item.id_item + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " >  </button></td>';
                    html += '<td style="width:5%"><button type="button" class="btn boton_tabla glyphicon glyphicon-remove" aria-hidden="true" onclick="eliminar_item_catalogo(' + item.id_item + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " >  </button></td>';
                    html += '</tr>';
                });
                $(".body_tabla_catalogo").html(html);
            }
        });
    }
    function llenar_items_edicion() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_items_trims',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var trim = jsonData.Data.trim;
                var html = '';
                $.each(trim, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:5%">'+item.id_item+'</td>';
                    html += '<td style="width:20%">'+item.item+'</td>';
                    html += '<td style="width:45%">'+item.descripcion+'</td>';
                    html += '<td style="width:20%">' + item.family + '</td>';
                    html += '<td style="width:5%"><button type="button" class="btn boton_tabla glyphicon glyphicon-pencil" aria-hidden="true" onclick="buscar_datos_edicion_trim(' + item.id_item + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " >  </button></td>';
                    html += '<td style="width:5%"><button type="button" class="btn boton_tabla glyphicon glyphicon-remove" aria-hidden="true" onclick="eliminar_item_catalogo(' + item.id_item + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " >  </button></td>';
                    html += '</tr>';
                });
                $(".body_tabla_catalogo").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function buscar_datos_edicion_trim(id) {
        $('#id_item_hidden').val(id);
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_informacion_trim',
            contentType: 'application/json',
            data: "{'id':'" + id+"'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var trim = jsonData.Data.trim;
                var html = '';
                 $.each(lista_familias, function (key, item) {
                    html += '<option>' + item.family + '</option>';
                 });
                 $('#caja_family_trim_edit').html(html);
                html = '';
                $.each(trim, function (key, item) {
                    $("#edicion_trim_catalogo").css('display','inline');
                    $("#id_trim_edicion").val(item.id_item);
                    $("#caja_trim_item_edit").val(item.item);
                    $("#caja_minimo_trim_edit").val(item.minimo);
                    $("#caja_descripcion_edit").val(item.descripcion);
                    $("#caja_family_trim_edit").val(item.family);
                    $("#caja_unit_trim_edit").val(item.unit);
                });
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function eliminar_item_catalogo(id) {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/eliminar_trim_catalogo',
            data: "{'id':'" + id+ "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#load_trim").css('display', 'none');
                llenar_items_edicion();
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function recibir(event) {
        var error = 0;
        $(".must_ttrim").each(function () {
            var id = $(this).attr('id');
            if ($(this).val() == '') {
                $("#" + id).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $("#" + id).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            alta_de_item();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function alta_de_item() {
        var item, manufacturer, color, size, body_type, gender, fabric_type, fabric_percent, yarn, division, type = 2, descripcion, unit ='Pza', minimo;
        if ($("#caja_trim_item").val() == "") { item = "N/A"; } else { item = $("#caja_trim_item").val(); }
        if ($("#caja_descripcion").val() == "") { descripcion = "N/A"; } else { descripcion = $("#caja_descripcion").val(); }
        if ($("#caja_family_trim").val() == "") { fabric_type = "N/A"; } else { fabric_type = $("#caja_family_trim").val(); }
        if ($("#caja_minimo_trim").val() == "") { minimo = "N/A"; } else { minimo = $("#caja_minimo_trim").val(); }
        size = "N/A"; manufacturer = "N/A"; color = "N/A"; body_type = "N/A"; gender = "N/A"; fabric_percent = "N/A"; division = "N/A"; yarn = "N/A";
        var actionData = "{'actionData':'" + item + "*" + manufacturer + "*" + color + "*" + size + "*" + body_type + "*" + gender + "*" + fabric_type + "*" + fabric_percent + "*" + yarn + "*" + division + "*" + type + "*" + descripcion + "','unit':'" + unit + "','minimo':'" + minimo + "'}";
        $.ajax({
            url: '/Almacen/agregar_item_catalogo',
            data: actionData,
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                $(".must_ttrim").each(function () {
                    $(this).val("");
                });
                alertify.success('Success!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function guardar_edicion_trim() {
        var error = 0;
        $(".edit_trim").each(function () {
            var id = $(this).attr('id');
            if ($(this).val() == '') {
                $("#" + id).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $("#" + id).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            modificar_item();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function modificar_item() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/editar_trim_catalogo',
            data: "{'id':'" +  $('#id_item_hidden').val() + "','item':'" + $("#caja_trim_item_edit").val() + "','minimo':'" + $("#caja_minimo_trim_edit").val() + "','descripcion':'" + $("#caja_descripcion_edit").val() + "','family':'" + $("#caja_family_trim_edit").val() + "','unidad':'Pza'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
               $("#edicion_trim_catalogo").css('display', 'none');
                llenar_items_edicion();
                $("#load_trim").css('display', 'none');
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    $(document).on("click", "#boton_cerrar_edicion_catalogo ", function () { $("#edicion_trim_catalogo").toggle("slow"); });
    /*ITEMS*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*RECIBOS*/
    var contador_trims_recibos;
    $(document).on("click", ".btn_nuevo_recibo_trim", function () {
        llenar_po_recibo_trims();
        llenar_tabla_items();
        contador_trims_recibos = 0;
        $("#div_tabla_trims_recibos").css('visibility','hidden');
        $(".body_tabla_trims_recibos").html('');
    });
    function llenar_po_recibo_trims() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">NONE</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_recibo_trims").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function llenar_tabla_items() {
        var busqueda = "";
        if ($("#caja_busqueda_recibo_trims").val() != '') {
            busqueda = $("#caja_busqueda_recibo_trims").val();
        } else {
            busqueda = 0;
        }
        $.ajax({
            url: '/Trims/buscar_items_recibos_trims',
            contentType: 'application/json',
            data:"{'busqueda':'"+busqueda+"'}",
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:6em;" >' + item.id_item + '</td>';
                    html += '<td style="width:10em;" >' + item.componente + '</td>';
                    html += '<td style="width:20em;" >' + item.descripcion + '</td>';
                    html += '<td style="width:6em;" >' + item.familia + '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_trims_recibos_temporal").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("dblclick", "#tabla_trims_recibos_temporal tr", function () {
        var row = this.rowIndex;
        var id = $('#tabla_trims_recibos_temporal tr:eq(' + row + ') td:eq(0)').html();
        var amt = $('#tabla_trims_recibos_temporal tr:eq(' + row + ') td:eq(1)').html();
        var descripcion = $('#tabla_trims_recibos_temporal tr:eq(' + row + ') td:eq(2)').html();
        agregar_fila_recibos(id + "&" + amt + "&" + descripcion );
    });
    function agregar_fila_recibos(data) {
        var datos = data.split('&');
        var html = '<tr>';
        html += '<td style="width:10%;">'+datos[0]+'</td>';
        html += '<td style="width:15%;">'+datos[1]+'</td>';
        html += '<td style="width:40%;">' + datos[2] + '</td>';
        html += '<td style="width:15%;"><select class="form-control ubicaciones_request "  >';
        if ($('#caja_sucursal_recibo').val() == 1) {
            html += '<option  value="73">TRIM OFFICE</option>';
        }
        html += '<option  value="72">BODEGA</option>';
        html += '<option  value="77">STOCK IMPRESIONES</option>';
        html += '</select></td>';
        html += '<td style="width:15%;"><input maxlength="10" class="numeric form-control cant_rec_trim " placeholder="QTY" /></td>';
        html += '<td style="width:5%;"><button type="button" class="btn btn-light delItemRecTrim"><b>-</b></button></td> ';
        html += '</tr>';
        $(".body_tabla_trims_recibos").append(html);
        contador_trims_recibos++;
        $("#div_tabla_trims_recibos").css('visibility','visible');
    }
    $(document).on("click", ".delItemRecTrim", function () {
        var row = this.rowIndex;
        $(this).closest("tr").remove();
        contador_trims_recibos--;
        if (contador_trims_recibos == 0) {
            $("#div_tabla_trims_recibos").css('visibility', 'hidden');
        }
    });
    var pedido_recibo_trim, po_number_recibo_trim, mp_recibo_trim,millpo_recibo_trim, item_recibo_trim, estilo_recibo_trim, cantidad_recibo_trim,packing_number_trim,fecha_recibo_trim,comentarios_recibo_trim,sucursal_recibo_trim,cliente_recibo_trim;
    var ubicacion_recibo_trim;
    function guardar_recibo_trims(event) {
        var error = 0;
        ubicacion_recibo_trim = '';
        item_recibo_trim = ''; estilo_recibo_trim = ''; cantidad_recibo_trim = ''; millpo_recibo_trim = ''; pedido_recibo_trim = ''; sucursal_recibo_trim = '';cliente_recibo_trim='';
        pedido_recibo_trim = $("#caja_pedido_recibo").val();
        fecha_recibo_trim = $("#caja_fecha_recibo").val();
        if ($("#caja_comentarios_recibo").val() != '') { comentarios_recibo_trim = $("#caja_comentarios_recibo").val(); } else { comentarios_recibo_trim = 'N/A'; }
        mp_recibo_trim = $("#caja_mp_recibo").val();
        millpo_recibo_trim = $("#caja_millpo_recibo").val();
        po_number_recibo_trim = millpo_recibo_trim;
        packing_number_trim = millpo_recibo_trim;
        $(".check_rec_trim").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        $(".cant_rec_trim").each(function () {
            if ($(this).val() == '' || $(this).val() == '0') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            $('#tabla_trims_recibos tbody tr').each(function () {
                item_recibo_trim += "*" + $(this).find('td:eq(0) ').html();
                cantidad_recibo_trim += "*" + $(this).find('td:eq(4) input').val();
                ubicacion_recibo_trim += "*" + $(this).find('.ubicaciones_request').val();
                estilo_recibo_trim += "*0";
            });
            sucursal_recibo_trim = $('#caja_sucursal_recibo').val();
            cliente_recibo_trim = $('#caja_cliente_recibo').val();
            enviar_datos_recibo_trim();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_recibo_trim() {
        $.ajax({
            url: '/Trims/guardar_recibo_trims',
            data: "{'pedido':'" + pedido_recibo_trim + "','mp':'" + mp_recibo_trim + "','millpo':'" + millpo_recibo_trim + "','po_number':'" + po_number_recibo_trim + "','item':'" + item_recibo_trim + "','estilo':'" + estilo_recibo_trim + "','cantidad':'" + cantidad_recibo_trim + "','packing_number':'" + packing_number_trim + "','cliente':'" + cliente_recibo_trim + "','sucursal':'" + sucursal_recibo_trim + "','fecha':'" + fecha_recibo_trim + "','comentarios':'" + comentarios_recibo_trim + "','ubicacion':'"+ubicacion_recibo_trim+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#caja_pedido_recibo").val('');
                $("#caja_po_number_recibo").val('');
                $("#caja_mp_recibo").val('');
                $("#div_tabla_trims_recibos").css('visibility', 'hidden');
                $(".body_tabla_trims_recibos").html('');
                $("#div_busqueda").css('visibility', 'hidden');
                $("#modal_recibos_trims").modal("hide");
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    $(document).on("click", "#ver_recibos_trim", function () {
        $("#load_trim").css('display', 'inline');
        cargar_recibos_trims('');
    });
    $(function () { $('tabla_recibos_trim tr').tooltip(); })
    function cargar_recibos_trims(busqueda) {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: "/Trims/buscar_informacion_recibos_trims",
            data: "{'busqueda':'" + busqueda + "'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';
                var pedido = '';
                $.each(result, function (key, item) {
                    html += '<tr class="toolxd" data-toggle="tooltip" data-placement="bottom" title="'+item.comentarios+'">';//
                    html += '<td style="width:5%;">' + item.id_recibo + '</td>';
                    html += '<td style="width:10%;">' + item.fecha + '</td>';
                    html += '<td style="width:10%;">' + item.mp_number + '</td>';
                    html += '<td style="width:15%;">' + item.mill_po + '</td>';
                    $.each(item.lista_recibos_item, function (key, i) {
                        pedido = i.pedido;
                    });
                    html += '<td style="width:10%;">' + pedido + '</td>';
                    html += '<td style="width:10%;">' + item.customer + '</td>';
                    html += '<td style="width:25%; font-size:0.8em;">';
                    $.each(item.lista_recibos_item, function (key, i) {
                        html += '<p>' + i.item_description+'</p>';
                    });
                    html += '</td>';
                    html += '<td style="width:10%; font-size:0.8em;">';
                    $.each(item.lista_recibos_item, function (key, i) {
                        html += '<p>' + i.total + '</p>';
                    });
                    html += '</td>';
                    html += '<td style="width:5%;">';
                    html += '<button type="button"  class="btn boton_tabla glyphicon glyphicon-pencil" aria-hidden="true" onclick="editar_recibo(' + item.id_recibo + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " >  </button>';
                    html += '<button type="button"  class="btn boton_tabla glyphicon glyphicon-remove" aria-hidden="true" onclick="eliminar_recibo(' + item.id_recibo + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " >  </button>';
                   html += '</td>';
                    html += '</tr>';
                });
                $(".rows_tabla_recibos_trim").html(html);
                $("#load_trim").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    function llenar_po_recibo_trims_edit() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">NONE</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $("#caja_pedido_recibo_edit").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var contador_trims_recibos_edit;
    function llenar_tabla_items_edit() {
        var busqueda = "";
        if ($("#caja_busqueda_recibo_trims_edit").val() != '') {
            busqueda = $("#caja_busqueda_recibo_trims_edit").val();
        } else {
            busqueda = 0;
        }
        $.ajax({
            url: '/Trims/buscar_items_recibos_trims',
            contentType: 'application/json',
            data:"{'busqueda':'"+busqueda+"'}",
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:6em;" >' + item.id_item + '</td>';
                    html += '<td style="width:10em;" >' + item.componente + '</td>';
                    html += '<td style="width:20em;" >' + item.descripcion + '</td>';
                    html += '<td style="width:6em;" >' + item.familia + '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_trims_recibos_temporal_edit").html(html);
            }
        });
    }
    $(document).on("dblclick", "#tabla_trims_recibos_temporal_edit tr", function () {
        var row = this.rowIndex;
        var id = $('#tabla_trims_recibos_temporal_edit tr:eq(' + row + ') td:eq(0)').html();
        var amt = $('#tabla_trims_recibos_temporal_edit tr:eq(' + row + ') td:eq(1)').html();
        var descripcion = $('#tabla_trims_recibos_temporal_edit tr:eq(' + row + ') td:eq(2)').html();
        agregar_fila_recibos_edit(id + "&" + amt + "&" + descripcion );
    });
    function agregar_fila_recibos_edit(data) {
        var datos = data.split('&');
        var html = '<tr>';
        html += '<td style="width:10%;">'+datos[0]+'</td>';
        html += '<td style="width:15%;">'+datos[1]+'</td>';
        html += '<td style="width:40%;">'+datos[2]+'</td>';
        html += '<td style="width:15%;"><select class="form-control ubicaciones_request_edit "  >';
        if ($('#caja_sucursal_recibo_edit').val() == 1) {
            html += '<option  value="73">TRIM OFFICE</option>';
        }
        html += '<option  value="72">BODEGA</option>';
        html += '<option  value="77">STOCK IMPRESIONES</option>';
        html += '</select></td>';
        html += '<td style="width:15%;"><input maxlength="10" class="numeric form-control cant_rec_trim_edit " placeholder="QTY" /></td>';
        html += '<td style="width:5%;"><button type="button" class="btn btn-light delItemRecTrimEdit"><b>-</b></button></td> ';
        html += '</tr>';
        $(".body_tabla_trims_recibos_edit").append(html);
        contador_trims_recibos_edit++;
        $("#div_tabla_trims_recibos_edit").css('visibility','visible');
    }
    $(document).on("click", ".delItemRecTrimEdit", function () {
        var row = this.rowIndex;
        $(this).closest("tr").remove();
        contador_trims_recibos_edit--;
        if (contador_trims_recibos_edit == 0) {
            $("#div_tabla_trims_recibos_edit").css('visibility', 'hidden');
        }
    });
    function editar_recibo(recibo) {
        $("#load_trim").css('display', 'inline');
        llenar_po_recibo_trims_edit();
        llenar_tabla_items_edit();
        contador_trims_recibos_edit = 0;
        $.ajax({
            url: '/Trims/obtener_informacion_recibos_edicion',
            data:"{'recibo':'"+recibo+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#modal_listado_recibos").modal("hide");
                $.each(result, function (key, p) {
                    $("#id_recibo_hidden").val(p.id_recibo);
                    $("#caja_pedido_recibo_edit").val(p.id_pedido);
                    //$("#caja_po_number_recibo_edit").val(p.po_referencia);
                    $("#caja_mp_recibo_edit").val(p.mp_number);
                    $("#caja_millpo_recibo_edit").val(p.mill_po);
                    $("#caja_comentarios_recibo_edit").val(p.comentarios);
                    //$("#caja_packing_number_trim_edit").val(p.packing_number);
                    $("#caja_cliente_recibo_edit").val(p.id_customer);
                    $("#caja_sucursal_recibo_edit").val(p.id_sucursal);
                    $('#caja_fecha_recibo_edit').val(p.fecha);

                    $(".body_tabla_trims_recibos_edit").html('');
                    $('#caja_pedido_recibo_edit option').each(function (i, e) {
                        if (this.value == p.id_pedido) {
                            $(this).attr('selected', 'selected');
                            $(this).val(p.id_pedido).change();
                        }
                    });
                    $.each(p.lista_recibos_item, function (key, i) {
                        var html = '<tr>';
                        html += '<td style="width:10%;">'+i.id_item+'</td>';
                        html += '<td style="width:15%;">' + '</td>';
                        html += '<td style="width:40%;">' + i.item_description + '</td>';
                        html += '<td style="width:15%;"><select class="form-control ubicaciones_request_edit "  >';
                        if (p.id_sucursal == 1) {
                            if (i.id_ubicacion == 73) {
                                html += '<option selected value="73">TRIM OFFICE</option>';
                                html += '<option  value="72">BODEGA</option>';
                                html += '<option  value="77">STOCK IMPRESIONES</option>';
                            } else {
                                if (i.id_ubicacion == 77) {
                                    html += '<option  value="73">TRIM OFFICE</option>';
                                    html += '<option  value="72">BODEGA</option>';
                                    html += '<option selected  value="77">STOCK IMPRESIONES</option>';
                                } else {
                                    html += '<option  value="73">TRIM OFFICE</option>';
                                    html += '<option selected value="72">BODEGA</option>';
                                    html += '<option  value="77">STOCK IMPRESIONES</option>';
                                }
                            }
                        }else {
                            if (i.id_ubicacion == 72) {
                                html += '<option selected value="72">BODEGA</option>';
                            } else {
                                html += '<option  value="72">BODEGA</option>';
                            }
                        }
                        html += '</select></td>';
                        html += '<td style="width:15%;"><input maxlength="10" class="numeric form-control cant_rec_trim_edit " value="'+i.total+'" /></td>';
                        html += '<td style="width:5%;"><button type="button" class="btn btn-light delItemRecTrimEdit"><b>-</b></button></td> ';
                        html += '</tr>';
                        $(".body_tabla_trims_recibos_edit").append(html);
                        contador_trims_recibos_edit++;
                        $("#div_tabla_trims_recibos_edit").css('visibility','visible');
                    });
                });
                $("#modal_editar_recibo_trims").modal("show");
                $('.js-example-basic-single').select2();
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function guardar_recibo_trims_edit(event) {
        var error = 0;
        item_recibo_trim = ''; estilo_recibo_trim = ''; cantidad_recibo_trim = ''; millpo_recibo_trim = ''; pedido_recibo_trim = '';
        pedido_recibo_trim = $("#caja_pedido_recibo_edit").val();
        ubicacion_recibo_trim = '';
        mp_recibo_trim = $("#caja_mp_recibo_edit").val();
        millpo_recibo_trim = $("#caja_millpo_recibo_edit").val();
        packing_number_trim = millpo_recibo_trim;
        po_number_recibo_trim = millpo_recibo_trim;
        comentarios_recibo_trim = $("#caja_comentarios_recibo_edit").val();
        fecha_recibo_trim=$("#caja_fecha_recibo_edit").val();
        $(".check_rec_trim_edit").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        $(".cant_rec_trim_edit").each(function () {
            if ($(this).val() == '' || $(this).val() == '0') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            $('#tabla_trims_recibos_edit tbody tr').each(function () {
                item_recibo_trim += "*" + $(this).find('td:eq(0) ').html();
                cantidad_recibo_trim += "*" + $(this).find('td:eq(4) input').val();
                ubicacion_recibo_trim += "*" + $(this).find('.ubicaciones_request_edit').val();
                estilo_recibo_trim += "*0";
            });
            enviar_datos_recibo_trim_edit();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_recibo_trim_edit() {
        $.ajax({
            url: '/Trims/guardar_edicion_recibo_trims',
            data: "{'recibo':'" + $("#id_recibo_hidden").val() + "','pedido':'" + pedido_recibo_trim + "','mp':'" + mp_recibo_trim + "','millpo':'" + millpo_recibo_trim + "','po_number':'" + po_number_recibo_trim + "','item':'" + item_recibo_trim + "','estilo':'" + estilo_recibo_trim + "','cantidad':'" + cantidad_recibo_trim + "','packing_number':'" + packing_number_trim + "','cliente':'" + $('#caja_cliente_recibo_edit').val() + "','sucursal':'" + $('#caja_sucursal_recibo_edit').val() + "','fecha':'" + fecha_recibo_trim + "','comentarios':'" + comentarios_recibo_trim + "','ubicacion':'"+ubicacion_recibo_trim+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#modal_editar_recibo_trims").modal("hide");
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function eliminar_recibo(recibo) {
        $.ajax({
            url: '/Trims/eliminar_recibo',
            data:"{'recibo':'"+recibo+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
               alertify.success('Succes!');
               alertify.set('notifier', 'position', 'top-right');
               cargar_recibos_trims('');
            }
        });
    }
    function buscar_recibos_fechas(event) {
        cargar_recibos_trims($("#caja_inicio").val() + "*" + $("#caja_final").val()+ "*" + $("#caja_busqueda_recibo_trim").val());
    }
    /*RECIBOS*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*TRIM REQUEST*/
    $(document).on("click", "#ver_request", function () {
        $("#load_trim").css('display', 'inline');
        $(".pedidos_request").html("");
        llenar_po_request();
        $("#div_estilos_request").css('visibility', 'visible');
        $("#div_estilos_request").css('display', 'none');
        $("#div_tallas_request").css('visibility', 'visible');
        $("#boton_guardar_request").css('display', 'none');

    });
    function llenar_po_request() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; 
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_request").append(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var estilos_trims_anteriores;
    var tallas_request;
    $(document).on("change", "#caja_pedido_request", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_estilos',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_request").val()+"'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.estilos;
                var doblado = jsonData.Data.fold_size;
                var colgado = jsonData.Data.hang_size;
                var estado = jsonData.Data.estado;
                $("#caja_estado_request").val(estado);
                tallas_request = jsonData.Data.tallas;
                estilos_trims_anteriores = jsonData.Data.trims_anteriores;
                var empaque = jsonData.Data.empaque;
                if (empaque == 1) { $("#caja_instruccion_empaque_cb").prop('checked', true); } else { $("#caja_instruccion_empaque_cb").prop('checked', false); }
                var html = '';
                html += '<label for="caja_pedido_request">Style</label><select class="form-control  estilos_request " style="" id="caja_estilo_request"  multiple="multiple">';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_po_summary + '">'  + item.descripcion+ '</option>';
                });
                html += '</select>';
                $("#div_estilos_request").css('display', 'inline');
                $("#div_estilos_request").html(html);
                $("#caja_fold_size_trim").val(doblado);
                $("#caja_hang_size_trim").val(colgado);
                $("#load_trim").css('display', 'none');
                agregar_trims_anteriores();
                html = '';
                html += '<label for="caja_talla_request">Size</label><select class="form-control tallas_request" style="" id="caja_talla_request" multiple="multiple" >';//'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                $.each(tallas_request, function (key, item) {
                    html += '<option  value="' + item.id_talla + '">' + item.talla + '</option>';
                });
                html += '</select>';
                $("#div_tallas_request").css('display', 'inline');
                $("#div_tallas_request").html(html);
                $("#div_item_request").css('visibility', 'visible');
                $("#div_button_add").css('visibility', 'visible');
                llenar_items_trim();
            }
        });
    });
    var request_anteriores;
    function agregar_trims_anteriores() {
        $("#load_trim").css('display', 'inline');
        request_anteriores = '';
        $.each(estilos_trims_anteriores, function (key, i) {
            request_anteriores += '*' + i.id_request;
            var html = '';
            if (i.tipo_item != 'BOXES') {
                trims++;
                html = '<tr id="' + i.id_item + '">';
                html += '<td style="font-size:0.9em;"><select class="form-control " style="width:20em;font-size:0.9em; ">';//<-----------------------------------------------------------------------
                $.each(i.lista_estilos, function (key, r) {
                    html += '<option>' + r.descripcion;
                    $.each(r.lista_tallas, function (key, t) {
                        html += '&nbsp;&nbsp;' + t.talla;
                    });
                    html += '</option>';
                });
                html += '</select></td>';
                html += '<td>' + i.item + '</td>';
                $("#div_tabla_trim_seleccionado").css('display', 'inline');
                html += '<td><input maxlength="10" style="width:4em;" class="numeric form-control check_trims" id="qty_' + trims + '" value="' + i.cantidad + '" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                html += '<td><input maxlength="10" style="width:4em;" class="numeric form-control check_trims " id="blank_' + trims + '" value="' + i.blanks + '" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                html += '<td><input maxlength="10" style="" class="numeric form-control check_trims " id="total_' + trims + '" value="' + i.total + '" /></td>';  //boxes
                html += '<td><button type="button" class="btn btn-light deleteRowTrim"><b>-</b></button></td>';
                html += '<td style="visibility:hidden; font-size:0.1em;">';
                $.each(i.lista_estilos, function (key, r) {
                    html += '*' + r.id_summary;
                });
                html += '</td>';
                html += '<td style="visibility:hidden; font-size:0.1em;" id = "item_' + trims + '" >' + i.id_item + '</td> ';
                html += '<td style="visibility:hidden; font-size:0.1em;" id="totalTalla_' + trims + '" >' + i.total + '</td>';
                html += '<td style="visibility:hidden; font-size:0.1em;" id="' + trims + '" >';
                var contador = 0;
                $.each(i.lista_estilos, function (key, r) {
                    if (contador == 0) {
                        $.each(r.lista_tallas, function (key, t) {
                            html += '*' + t.id_talla;
                            contador++;
                        });
                    }
                });
                html += '</td>';
                html += '<td style="visibility:hidden; font-size:0.1em;">' + i.id_request + '</td></tr>';
                $("#boton_guardar_request").css('display', 'inline');
                $(".body_tabla_trim_seleccionado").append(html);
            } else {
                cajas++;
                html = '<tr id="' + i.id_item + '">';
                html += '<td><select class="form-control " style="width:20em;font-size:0.9em; ">';
                $.each(i.lista_estilos, function (key, r) {
                    html += '<option>' + r.descripcion;
                    $.each(r.lista_tallas, function (key, t) {
                        html += '&nbsp;&nbsp;' + t.talla;
                    });
                    html += '</option>';
                });
                html += '<select></td>';
                html += '<td>' + i.item + '</td>';
                $("#div_tabla_cajas_seleccionadas").css('display', 'inline');
                html += '<td><input   maxlength="6" class="numeric form-control check_boxes " id="" value="' + i.total + '" /></td>';  //boxes
                html += '<td><button type="button" class="btn btn-light deleteRowCaja"><b>-</b></button></td>';
                html += '<td style="visibility:hidden; font-size:0.1em;">';
                $.each(i.lista_estilos, function (key, r) {
                    html += '*' + r.id_summary;
                });
                html += '</td>';
                html += '<td style="visibility:hidden; font-size:0.1em;">' + i.id_item + '</td>';
                html += '<td style="visibility:hidden; font-size:0.1em;" id="' + cajas + '" >';
                var contador = 0;
                $.each(i.lista_estilos, function (key, r) {
                    if (contador == 0) {
                        $.each(r.lista_tallas, function (key, t) {
                            html += '*' + t.id_talla;
                            contador++;
                        });
                    }
                });
                html += '<td style="visibility:hidden; font-size:0.1em;">' + i.id_request + '</td>';
                html += '</td>';
                html += '</tr> ';
                $("#boton_guardar_request").css('display', 'inline');
                $(".body_tabla_cajas_seleccionadas").append(html);
            }
        });
        $("#load_trim").css('display', 'none');
    }
    function llenar_items_trim() {
       $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_inventario_items_trim',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_item + '">' + item.descripcion + '</option>';
                });
                $(".items_request").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("click", ".cerrar_material_request", function () {
        cerrar_modal_trim_request();
    });
    function cerrar_modal_trim_request() {
        trims = 0; cajas = 0;
        $("#div_tabla_cajas_seleccionadas").css('display', 'none');
        $("#div_tabla_trim_seleccionado").css('display', 'none');
        $("#div_estilos_request").css('display', 'none');
        $("#div_tallas_request").css('display', 'none');
        $("#div_item_request").css('visibility', 'hidden');
        $(".body_tabla_trim_seleccionado").html("");
        $(".body_tabla_cajas_seleccionadas").html("");
        $("#caja_pedido_request").val('0');
        $("#myselect caja_pedido_request[value=0]").attr('selected', 'selected');
    }
     var datos_sizers;
    function agregar_item_tablas() {
        $.each($("#caja_item_request option:selected"), function () {
            $("#load_trim").css('display', 'inline');
            var id_item = $(this).val(), item = $(this).text();
            var summarys = '', estilos_seleccionados = '<select class="form-control " style="width:20em; font-size:0.9em;">';
            $.each($("#caja_estilo_request option:selected"), function () {
                summarys += '*' + $(this).val();
                estilos_seleccionados += '<option>' + $(this).text();
                $.each($("#caja_talla_request option:selected"), function () {
                    estilos_seleccionados += ' ' + $(this).text();
                });
                estilos_seleccionados += '</option>';
            });

            estilos_seleccionados += "</select>";
            var tallas = '', tallas_seleccionadas = '';
            $.each($("#caja_talla_request option:selected"), function () {
                tallas += "*" + $(this).val();
                tallas_seleccionadas += ' ' + $(this).text();
            });
            $.ajax({
                url: '/Trims/buscar_total_estilo',
                data: "{'pedido':'" + $("#caja_pedido_request").val() + "','summary':'" + summarys + "','talla':'" + tallas + "','item':'" + $(this).val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (jsonData) {
                    var categoria = jsonData.Data.categoria, total = jsonData.Data.total, cajas_total = jsonData.Data.cajas, carton_label = jsonData.Data.carton_label;
                    var html = '';
                    if (categoria != 'BOXES') {
                        trims++;
                        html = '<tr id="' + trims + '"><td  style="font-size:0.9em;">' + estilos_seleccionados + ' </td><td>' + item + '</td>';
                        $("#div_tabla_trim_seleccionado").css('display', 'inline');
                        html += '<td><input  style="width:4em;"   maxlength="10" class="numeric form-control check_trims" id="qty_' + trims + '" value="1" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                        html += '<td><input  style="width:4em;"   maxlength="10" class="numeric form-control check_trims " id="blank_' + trims + '" value="1" onkeyup="change_total_trim(' + trims + ')"  /></td>';  //boxes
                        if (categoria == 'CARTON LABEL' || categoria == 'TAPE') { //if (carton_label == 1) {
                            html += '<td><input  style=""   maxlength="10" class="numeric form-control check_trims " id="total_' + trims + '" value="' + cajas_total + '" /></td>';  //boxes
                        } else {
                            html += '<td><input   style=""  maxlength="10" class="numeric form-control check_trims " id="total_' + trims + '" value="' + total + '" /></td>';  //boxes
                        } html += '<td><button type="button" class="btn btn-light deleteRowTrim"><b>-</b></button></td>';

                        html += '<td style="visibility:hidden; font-size:0.1em;">' + summarys + '</td>';
                        html += '<td style="visibility:hidden; font-size:0.1em;" id="item_' + trims + '" >' + id_item + '</td>';
                        html += '<td style="visibility:hidden; font-size:0.1em;" id="totalTalla_' + trims + '" >' + total + '</td><td style="visibility:hidden;font-size:0.1em;" id="' + trims + '" >' + tallas + '</td>';
                        html += '<td style="visibility:hidden; font-size:0.1em;">0</td></tr>';
                        $(".body_tabla_trim_seleccionado").append(html);
                    } else {
                        cajas++;
                        html = '<tr id="' + trims + '"><td>' + estilos_seleccionados +  '</td><td>' + item + '</td>';
                        $("#div_tabla_cajas_seleccionadas").css('display', 'inline');
                        html += '<td><input   maxlength="6" class="numeric form-control check_boxes " id="" value="' + cajas_total + '" /></td>';  //boxes
                        html += '<td><button type="button" class="btn btn-light deleteRowCaja"><b>-</b></button></td>';

                        html += '<td style="visibility:hidden; font-size:0.1em;">' + summarys + '</td>';
                        html += '<td style="visibility:hidden; font-size:0.1em;">' + id_item + '</td><td style="visibility:hidden; font-size:0.1em;" id="' + trims + '" >' + tallas + '</td>';
                        html += '<td style="visibility:hidden; font-size:0.1em;">0</td></tr>';
                        $(".body_tabla_cajas_seleccionadas").append(html);
                    }
                    $("#boton_guardar_request").css('display', 'inline');
                }
            });
            $("#load_trim").css('display', 'none');
        });//CADA ITEM
    }
    function change_total_trim(row) {
        var qty = 0, blanks = 0, total = 0;
        qty = $('#qty_' + row).val();
        blanks = $('#blank_' + row).val();
        totalTalla = parseFloat($('#totalTalla_' + row).html());
        total = qty * (totalTalla / blanks);
        $('#total_' + row).val(total);
    }
    $(document).on("click", ".deleteRowTrim", function () {
        $(this).closest("tr").remove();
        trims--;
        if (trims <= 0) {
            $("#div_tabla_trim_seleccionado").css('display', 'none');
        } else {
            $("#div_tabla_trim_seleccionado").css('display', 'inline');
        }
        if (trims == 0 && cajas == 0) {
            $("#boton_guardar_request").css('display', 'none');
        }
    });
    $(document).on("click", ".deleteRowCaja", function () {
        $(this).closest("tr").remove();
        cajas--;
        if (cajas <= 0) {
            $("#div_tabla_cajas_seleccionadas").css('display', 'none');
        } else {
            $("#div_tabla_cajas_seleccionadas").css('display', 'inline');
        }
        if (trims == 0 && cajas == 0) {
            $("#boton_guardar_request").css('display', 'none');
        }
    });
    var estilo, item, total, talla, cantidad, blank, request, instruccion, fold_size_trim, hang_size_trim, estado;
    function guardar_request(event) {
        if (trims >= 1 || cajas >= 1) {
            $("#load_trim").css('display', 'inline');
            var error = 0;
            if (trims >= 1) {
                $(".check_trims").each(function () {
                    if ($(this).val() == '0' || $(this).val() == '' || $(this).val() == 0) {
                        $(this).css('border', '2px solid #e03f3f');
                        error++;
                    } else {
                        $(this).css('border', '1px solid #cccccc');
                    }
                });
            }
            if (cajas >= 1) {
                $(".check_boxes").each(function () {
                    if ($(this).val() == '0' || $(this).val() == '' || $(this).val() == 0) {
                        $(this).css('border', '2px solid #e03f3f');
                        error++;
                    } else {
                        $(this).css('border', '1px solid #cccccc');
                    }
                });
            }
            if (error == 0) {
                estilo = ''; item = ''; total = ''; talla = ''; cantidad = ''; black = ''; request = ''; fold_size_trim = '';
                if ($("#caja_fold_size_trim").val() == '') { fold_size_trim = "n/a"; } else { fold_size_trim = $("#caja_fold_size_trim").val(); }
                if ($("#caja_hang_size_trim").val() == '') { hang_size_trim = "n/a"; } else { hang_size_trim = $("#caja_hang_size_trim").val(); }
                if ($('#caja_instruccion_empaque_cb').is(":checked")) { instruccion = 1; } else { instruccion = 0; }
                estado=$("#caja_estado_request").val();
                if (trims >= 1) {
                    $('#tabla_trim_seleccionado tbody tr').each(function () {
                        total += "*" + $(this).find('td:eq(4) input').val();
                        cantidad += "*" + $(this).find('td:eq(2) input').val();
                        blank += "*" + $(this).find('td:eq(3) input').val();
                        estilo += "&" + $(this).find('td:eq(6) ').html();
                        item += "*" + $(this).find('td:eq(7) ').html();
                        talla += "&" + $(this).find('td:eq(9)').html();
                        request += "*" + $(this).find('td:eq(10)').html();
                    });
                }
                if (cajas >= 1) {
                    $('#tabla_cajas_seleccionadas tbody tr').each(function () {
                        total += "*" + $(this).find('td:eq(2) input').val();
                        estilo += "&" + $(this).find('td:eq(4) ').html();
                        item += "*" + $(this).find('td:eq(5) ').html();
                        talla +=  "&" + $(this).find('td:eq(6) ').html();
                        cantidad += "*0"; blank += "*0";
                        request += "*" + $(this).find('td:eq(7)').html();
                    });
                }
               enviar_request();
            } else {
                $("#load_trim").css('display', 'none');
                event.preventDefault();
                alertify.alert('Error!', 'Check empty fields, please');
                return false;
            }
        }
    }
    function enviar_request() {
        var pedido = $("#caja_pedido_request").val();
        $.ajax({
            url: '/Trims/enviar_datos_request',
            data: "{'pedido':'" + $("#caja_pedido_request").val()+"','total':'" + total + "','estilo':'" + estilo + "','item':'" + item + "','talla':'" + talla + "','cantidad':'" + cantidad + "','blank':'" + blank + "','request':'" + request + "','request_original':'" + request_anteriores + "','instruccion':'" + instruccion + "','fold_size':'" + fold_size_trim+"','hang_size':'" + hang_size_trim+"','estado':'"+estado+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                trims = 0; cajas = 0;
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                $(".body_tabla_trim_seleccionado").html('');
                $(".body_tabla_cajas_seleccionadas").html('');
                $("#div_tabla_trim_seleccionado").css('display', 'none');
                $("#div_tabla_cajas_seleccionadas").css('display', 'none');
                $("#boton_guardar_request").css('display', 'none');
                $("#modal_request").modal("hide");
                $("#caja_fold_size_trim").val('');
                $("#load_trim").css('display', 'none');
                llenar_pedidos_stock_order();
                $("#modal_lista_stock_orden").modal("show");
                setTimeout(function () {
                    $('#caja_pedido_stock_orden option').each(function (i, e) {
                    if (this.value == pedido) {
                        $(this).attr('selected', 'selected');
                        $(this).val(pedido).change();
                    }
                    });
                }, 2000);
                setTimeout(function(){ $('#caja_pedido_stock_orden').trigger("change"); }, 2000);

            }
        });
    }  
    /*TRIM REQUEST*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*COLORES*/
    $(document).on("click", "#ver_modal_archivo_colores", function () {
        $.ajax({
            url: '/Trims/buscar_todos_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $("#caja_pedido_reporte_colores").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    });
     function enviar_datos_reporte_colores() {
        //caja_inicio_colores
        var fecha_inicio, fecha_final;
        if ($("#caja_inicio_colores").val() != '') { fecha_inicio = $("#caja_inicio_colores").val(); } else { fecha_inicio = '0'; }
        if ($("#caja_final_colores").val() != '') { fecha_final = $("#caja_final_colores").val(); } else { fecha_final = '0'; }
        $.ajax({
            url: '/Trims/datos_reporte_colores',
            data: "{'orden':'" + $("#caja_pedido_reporte_colores").val() + "','estado':'" + $("#caja_estado_reporte_colores").val() + "','customer':'" + $("#caja_cliente_reporte_colores").val() + "','inicio':'"+fecha_inicio+"','final':'"+fecha_final+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                $('#modal_archivo_colores').modal('hide');
            }
        });
        $("#espera_t").css('display', 'inline');
        var boton = document.getElementById('link_excel_colores');
        setTimeout(function () { $("#espera_t").css('display', 'none'); }, 2000);
        boton.click();
    }
    /*COLORES*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*PRICE TICKET */
    $(document).on("click", ".btn_subir_archivo", function () {
        $("#div_formulario_archivo").css('display','inline');
        llenar_po_subir_archivo();
        $(".rows_tabla_price_ticket").html('');
        $("#div_tabla_price_ticket").css('visibility', 'hidden');
    });
    function llenar_po_subir_archivo() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_subir_archivos").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("click", "#boton_back_pt", function () {
        $("#div_formulario_archivo").css('display','inline');
        llenar_po_subir_archivo();
        $(".rows_tabla_price_ticket").html('');
        $("#div_tabla_price_ticket").css('visibility', 'hidden');
    });
    $(document).on("click", "#btnUpload", function () {
        $("#load_trim").css('display', 'inline');
        var archivo = $("#FileUpload1").val();
        if ($("#caja_pedido_subir_archivos").val() != 0) {
            if (archivo.indexOf("xlsx") >= 0 || archivo.indexOf("xls") >= 0 || archivo.indexOf("xlsm") >= 0) {
                guardar_sesion_pedido();
                // Checking whether FormData is available in browser
                if (window.FormData !== undefined) {
                    var fileUpload = $("#FileUpload1").get(0);
                    var files = fileUpload.files;
                    // Create FormData object
                    var fileData = new FormData();
                    // Looping over all files and add it to FormData object
                    for (var i = 0; i < files.length; i++) { fileData.append(files[i].name, files[i]); }
                    // Adding one more key to FormData object
                    fileData.append('username', 'Manas');
                    $.ajax({
                        url: '/Trims/UploadFiles',
                        type: "POST",
                        contentType: false, // Not to set any content header
                        processData: false, // Not to process data
                        data: fileData,
                        success: function (jsonData) {
                            var html = ''; var contador = 1;
                            var id_pedido = jsonData.Data.id_pedido;
                            var pedido = jsonData.Data.pedido;
                            $("#titulo_pedido_price_tickets").html("Order "+pedido);
                            var lista = jsonData.Data.lista;
                            $("#div_formulario_archivo").css('display', 'none');
                            $("#id_pedido_hidden").val(id_pedido);
                            var contador_extra = 0;
                            $.each(lista, function (key, item) {
                                html += '<tr>';
                                html += '<td>' + contador + '</td>';
                                if (item.estado == 0) { html += '<td>Found</td>'; } else { html += '<td>Not found</td>'; }
                                var po = (item.total).split('*');
                                html += '<td>';
                                var contador_extra = 0;
                                $.each(po, function (key, i) {
                                    if (contador_extra == 0) {
                                        html += '<input type="radio" class="totales_radio" name="total_' + contador + '" value="' + i + '" checked > ' + i + '<br>';
                                    } else {
                                        html += '<input type="radio" class="totales_radio" name="total_' + contador + '" value="' + i + '"  > ' + i + '<br>';
                                    }
                                    contador_extra++;
                                });
                                html += '</td>';

                                var style = (item.estilo).split('*');
                                html += '<td>';
                                contador_extra = 0;
                                $.each(style, function (key, i) {
                                    if (contador_extra == 0) {
                                       html += '<input type="radio" name="estilo_' + contador + '" value="' + i + '" checked > ' + i + '<br>';
                                    } else {
                                       html += '<input type="radio" name="estilo_' + contador + '" value="' + i + '"  > ' + i + '<br>';
                                    }
                                    contador_extra++;
                                });
                                html += '</td>';

                                var upc = (item.upc).split('*');
                                html += '<td>';
                                contador_extra = 0;
                                $.each(upc, function (key, i) {
                                    if (contador_extra == 0) {
                                      html += '<input type="radio" name="upc_' + contador + '" value="' + i + '" checked > ' + i + '<br>';
                                    } else {
                                       html += '<input type="radio" name="upc_' + contador + '" value="' + i + '"  > ' + i + '<br>';
                                    }
                                    contador_extra++;
                                });
                                html += '</td>';

                                var descripcion = (item.descripcion_estilo).split('*');
                                html += '<td>';
                                contador_extra = 0;
                                $.each(descripcion, function (key, i) {
                                    if (contador_extra == 0) {
                                       html += '<input type="radio" name="descripcion_' + contador + '" value="' + i + '" checked > ' + i + '<br>';
                                    } else {
                                        html += '<input type="radio" name="descripcion_' + contador + '" value="' + i + '"  > ' + i + '<br>';
                                    }
                                    contador_extra++;
                                });
                                html += '</td>';

                                var color = (item.color).split('*');
                                html += '<td>';
                                contador_extra = 0;
                                $.each(color, function (key, i) {
                                     if (contador_extra == 0) {
                                       html += '<input type="radio" name="color_' + contador + '" value="' + i + '" checked > ' + i + '<br>';
                                    } else {
                                       html += '<input type="radio" name="color_' + contador + '" value="' + i + '"  > ' + i + '<br>';
                                    }
                                    contador_extra++;
                                });
                                html += '</td>';

                                var tallas = (item.talla).split('*');
                                html += '<td>';
                                 contador_extra = 0;
                                $.each(tallas, function (key, i) {
                                    if (contador_extra == 0) {
                                       html += '<input type="radio" name="talla_' + contador + '" value="' + i + '" checked > ' + i + '<br>';
                                    } else {
                                        html += '<input type="radio" name="talla_' + contador + '" value="' + i + '"  > ' + i + '<br>';
                                    }
                                    contador_extra++;
                                });
                                html += '</td>';

                                html += '<td>' + item.tickets + '</td>';
                                html += '<td>' + item.dept + '</td>';
                                html += '<td>' + item.clas + '</td>';
                                html += '<td>' + item.sub + '</td>';
                                html += '<td>' + item.retail + '</td>';
                                html += '<td>' + item.cl + '</td>';
                                html += '</tr>';
                                contador++;
                            });
                            $(".rows_tabla_price_ticket").html(html);
                            $("#div_tabla_price_ticket").css('visibility', 'visible');
                            $("#load_trim").css('display', 'none');
                        },
                        error: function (err) { alert(err.statusText); }
                    });
                } else {
                    $("#load_trim").css('display', 'none');
                    alertify.alert("FormData is not supported.");
                }
            } else {
                $("#load_trim").css('display', 'none');
                alertify.alert('Error!', 'File not supported, please select an excel file');
            }
        } else {
            $("#load_trim").css('display', 'none');
            alertify.alert('Error!', 'Check empty fields, please');
        }
    });
    function guardar_sesion_pedido() {
        $.ajax({
            url: '/Trims/guardar_pedido_sesion',
            data: "{'pedido':'" + $("#caja_pedido_subir_archivos").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
            }
        });
    }
    var total, estilo, upc, descripcion, color, talla, ticket, dept,clas, sub, retail, cl;
    function guardar_price_tickets(event) {
        total = ''; estilo = ''; upc = ''; descripcion = ''; color = ''; talla = ''; ticket = ''; dept = ''; clas = ''; sub = ''; retail = ''; cl = '';
        var indice, impreso=0;
        $('#tabla_price_ticket tbody tr').each(function () {
            indice = $(this).find('td:eq(0)').html();
            total += '*' + $('input[name="total_'+indice+'"]:checked').val();
            estilo += '*' + $('input[name="estilo_' + indice + '"]:checked').val();
            upc += '*' + $('input[name="upc_' + indice + '"]:checked').val();
            descripcion += '*' + $('input[name="descripcion_' + indice + '"]:checked').val();
            color += '*' + $('input[name="color_' + indice + '"]:checked').val();
            talla += '*' + $('input[name="talla_' + indice + '"]:checked').val();
            if ($(this).find('td:eq(8) ').html() != '') { ticket += '*' + $(this).find('td:eq(8) ').html(); } else { ticket += '*0'; }
            if ($(this).find('td:eq(9) ').html() != '') { dept += '*' + $(this).find('td:eq(9) ').html(); } else { dept += '*0'; }
            if ($(this).find('td:eq(10) ').html() != '') { clas += '*' + $(this).find('td:eq(10) ').html(); } else { clas += '*0'; }
            if ($(this).find('td:eq(11) ').html() != '') { sub += '*' + $(this).find('td:eq(11) ').html(); } else { sub += '*0'; }
            if ($(this).find('td:eq(12) ').html() != '') { retail += '*' + $(this).find('td:eq(12) ').html(); } else { retail += '*N/A'; }
            if ($(this).find('td:eq(13) ').html() != '') { cl += '*' + $(this).find('td:eq(13) ').html(); } else { cl += '*N/A'; }
        });
        if ($("#caja_impreso").is(":checked")) { impreso = 1; } else { impreso = 0; }
        $.ajax({
            url: '/Trims/guardar_price_tickets',
            data: "{'pedido':'" + $("#id_pedido_hidden").val() + "','total':'" + total +"','estilo':'" + estilo +"','upc':'" + upc +"','descripcion':'" + descripcion +"','color':'" + color +"','talla':'" + talla +"','ticket':'" + ticket +"','dept':'" + dept +"','clas':'" + clas +"','sub':'"+sub+"','retail':'"+retail+"','cl':'"+cl+"','impreso':'"+impreso+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#caja_impreso").prop('checked', true);
                $("#modal_comparar_excel").modal("hide");
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    $(document).on("click", ".btn_buscar_pt", function () {
        $(".pedidos_buscar_pt").html('');
        llenar_po_buscar_pt();
        $(".rows_tabla_buscar_price_ticket").html('');
        $("#div_tabla_buscar_price_ticket").css('visibility', 'hidden');
    });
    function llenar_po_buscar_pt() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_buscar_pt").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_buscar_price_ticket", function () { price_tickets_orden(); });
    function price_tickets_orden() {
        $("#load_trim").css('display', 'inline');
        $("#titulo_buscar_price_tickets").html('ORDER ' + $("#caja_pedido_buscar_price_ticket option:selected").text() +'<button type="button" class="btn btn-primary mb-2" id="" onclick="marcar_pedido_completo('+ $("#caja_pedido_buscar_price_ticket").val() +')" style=""><span class="glyphicon glyphicon-check" aria-hidden="true"  style="padding 0px !important;"></span></button>');
        $.ajax({
            url: '/Trims/buscar_price_tickets',
            data: "{'pedido':'" + $("#caja_pedido_buscar_price_ticket").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    $("#titulo_buscar_price_tickets").html('ORDER ' + item.pedido +'<button type="button" class="btn btn-primary mb-2" id="" onclick="marcar_pedido_completo('+item.id_pedido+')" style=""><span class="glyphicon glyphicon-check" aria-hidden="true"  style="padding 0px !important;"></span></button>');
                    html += '<tr>';
                    html += '<td>' + item.id_price_ticket + '</td>';
                    html += '<td>' + item.total + '</td>';
                    html += '<td>' + item.estilo + '</td>';
                    html += '<td>' + item.upc + '</td>';
                    html += '<td>' + item.descripcion_estilo + '</td>';
                    html += '<td>' + item.color + '</td>';
                    html += '<td>' + item.talla + '</td>';
                    html += '<td>' + item.tickets + '</td>';
                    html += '<td>' + item.dept + '</td>';
                    html += '<td>' + item.clas + '</td>';
                    html += '<td>' + item.sub + '</td>';
                    html += '<td>' + item.retail + '</td>';
                    html += '<td>' + item.cl + '</td>';
                    html += '<td>' + item.fecha+ '</td>';
                    html += '<td>' + item.usuario + '</td>';
                    if (item.impreso == 0) {
                         html += '<td><span class="glyphicon glyphicon-remove" aria-hidden="true"  style="padding 0px !important;"></span></td>';
                    } else {
                         html += '<td><span class="glyphicon glyphicon-ok" aria-hidden="true"  style="padding 0px !important;"></span></td>';
                    }
                    html += '<td>';
                    if (item.impreso == 0) {
                        html += '<button type="button" title="Print" class="btn edit_driver edicion" onclick="marcar_pt_impreso(\'' + item.id_price_ticket + '*' + item.id_summary + '*' + item.id_talla + '*'+item.id_pedido+'\')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-print" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                    } else {
                        html += '<button type="button"  title="Unprint" class="btn edit_driver edicion" onclick="revertir_impresion(\'' + item.id_price_ticket + '*' + item.id_summary + '*' + item.id_talla+ '*'+item.id_pedido + '\')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-floppy-remove" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                    }
                    html += '<button type="button" title="Delete" class="btn edit_driver edicion" onclick="eliminar_pt(' + item.id_price_ticket + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"  style="padding 0px !important;"></span> </button>'
                    html += '</td>';
                    html += '</tr>';
                });
                $(".rows_tabla_buscar_price_ticket").html(html);
                $("#div_tabla_buscar_price_ticket").css('visibility', 'visible');
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function revertir_impresion(informacion) {
        $.ajax({
            url: '/Trims/cambiar_estado_pt',
            data: "{'datos':'" + informacion + "','estado':'0'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                price_tickets_orden();
            }
        });
    }
    function marcar_pt_impreso(informacion) {
        $.ajax({
            url: '/Trims/cambiar_estado_pt',
            data: "{'datos':'" + informacion + "','estado':'1'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                price_tickets_orden();
            }
        });
    }
    function marcar_pedido_completo(id) {
        $.ajax({
            url: '/Trims/marcar_pt_orden_impresos',
            data: "{'pedido':'" + id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                price_tickets_orden();
            }
        });
    }
    function eliminar_pt(id) {
        $.ajax({
            url: '/Trims/eliminar_pt',
            data: "{'pt':'" + id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                price_tickets_orden();
            }
        });
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////
    var trims_tallas = ''; var total_trims_tallas;
    $(document).on("click", ".btn_ver_pt", function () {
        pt_orden();
    });
    function pt_orden() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_ordenes_pt',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                var total_estilos;
                $.each(result, function (key, item) {//PEDIDO
                    total_estilos = 0;
                    $.each(item.lista_trims, function (key, i) {
                        $.each(i.lista_estilos, function (key, r) {
                            total_estilos++;
                        });
                    });
                    html += '<tr>';
                    if (total_estilos == 0) {
                        html += '<td>' + item.pedido + '</td>';
                        html += '<td>' + item.customer + '</td>';
                        html += '<td></td>';
                        html += '<td></td>';
                        html += '</tr>';
                    } else {
                        html += '<td rowspan="' + total_estilos + '">' + item.pedido + '</td>';
                        html += '<td rowspan="' + total_estilos + '">' + item.customer + '</td>';
                        $.each(item.lista_trims, function (key, t) {
                            $.each(t.lista_estilos, function (key, r) {
                                html += '<td>' + r.descripcion + '</td>';
                                html += '<td>';
                                $.each(r.lista_tallas, function (key, lt) {
                                    if (lt.id_talla != 0) {
                                        if (lt.impreso == 0 ) {
                                            //html += '<input type="checkbox" class="trims_tallas_cb" id="' + t.id_request + '_' + t.id_inventario + '_' +lt.id_talla+'_'+ r.id_summary+ '" />&nbsp;<label style="font-weight:normal; margin-left:0.5em;" for="' + t.id_request + '_' + t.id_inventario + '_' +lt.id_talla+'_'+ t.id_summary+ '">' + lt.talla + '</label>&nbsp;&nbsp; ';
                                            html += '<input type="checkbox" class="trims_tallas_cb" id="' + t.id_request + '_' + 0 + '_' +lt.id_talla+'_'+ r.id_summary+ '" />&nbsp;<label style="font-weight:normal; margin-left:0.5em;" for="' + t.id_request + '_' + t.id_inventario + '_' +lt.id_talla+'_'+ t.id_summary+ '">' + lt.talla + '</label>&nbsp;&nbsp; ';
                                        } else {
                                            html += '<span class="glyphicon glyphicon-check" aria-hidden="true"></span>&nbsp;<label style="font-weight:normal; margin-left:0.5em;" >' + lt.talla + '</label>&nbsp;&nbsp;';
                                        }
                                    }
                                });
                                html += '</td>';
                                html += '</tr>';
                            });
                         });
                    }
                });
                total_trims_tallas = 0;
                $(".rows_tabla_order_price_ticket").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", ".trims_tallas_cb", function () {        
        if ($(this).is(":checked")) {
            total_trims_tallas++;
            $("#btn_marcar_pt").css('visibility', 'visible');
        } else {
            total_trims_tallas = total_trims_tallas - 1;
            if (total_trims_tallas == 0) {
                $("#btn_marcar_pt").css('visibility', 'hidden');
            }
        }
    });
    var prices_tickets_marcar;
    function obtener_datos_pt(event) {
        prices_tickets_marcar = '';
        $(".trims_tallas_cb").each(function () {
            if ($(this).is(":checked")) {
                prices_tickets_marcar += '*' + $(this).attr('id');
            }
        });
        $.ajax({
            url: '/Trims/marcar_pt_impreso',
            data: "{'informacion':'" + prices_tickets_marcar + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                pt_orden();
                $(".rows_tabla_order_price_ticket").html('');
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    /*PRICE TICKET */
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*STICKERS */
    $(document).on("click", ".btn_ver_stickers", function () {
        $(".pedidos_buscar_stickers").html('');
        llenar_po_buscar_stickers();
        $(".rows_tabla_stickers").html('');
        $("#div_tabla_stickers").css('visibility', 'hidden');
    });
    function llenar_po_buscar_stickers() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                $(".pedidos_buscar_stickers").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_buscar_stickers", function () { stickers_orden(); });
    function stickers_orden() {
        $("#load_trim").css('display', 'inline');
        $("#titulo_stickers").html('ORDER ' + $("#caja_pedido_buscar_stickers option:selected").text() +'<button type="button" class="btn btn-primary mb-2" id="" onclick="marcar_pedido_completo_stickers('+$("#caja_pedido_buscar_stickers").val()+')" style=""><span class="glyphicon glyphicon-check" aria-hidden="true"  style="padding 0px !important;"></span></button>');

        var x = $("#caja_pedido_buscar_stickers").val();
        $.ajax({
            url: '/Trims/buscar_stickers',
            data: "{'pedido':'" + $("#caja_pedido_buscar_stickers").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $(".rows_tabla_stickers").html("");
                $.each(result, function (key, item) {//Trim
                    $.each(item.lista_estilos, function (key, estilo) {//Estilos del trim
                        $.each(estilo.lista_tallas, function (key, talla) {//tallas del trim
                            html += '<tr>';
                            html += '<td>' + item.tipo_item+ '</td>';
                            html += '<td>' + item.item+ '</td>';
                            html += '<td>' + estilo.estilo + '</td>';
                            html += '<td>' + estilo.descripcion + '</td>';
                            html += '<td>' + talla.talla + '</td>';
                            if (talla.impreso == 0) {
                                 html += '<td><span class="glyphicon glyphicon-remove" aria-hidden="true"  style="padding 0px !important;"></span></td>';
                            } else {
                                 html += '<td><span class="glyphicon glyphicon-ok" aria-hidden="true"  style="padding 0px !important;"></span></td>';
                            }
                            html += '<td>';
                            if (talla.impreso == 0) {
                                html += '<button type="button" title="Print" class="btn edit_driver edicion" onclick="cambiar_estado_impresion_sticker(\'' + talla.id + '*' + item.id_request + '*' + 1 + '\')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-print" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                            } else {
                                html += '<button type="button"  title="Unprint" class="btn edit_driver edicion" onclick="cambiar_estado_impresion_sticker(\'' + talla.id + '*' + item.id_request +'*' +0+ '\')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-floppy-remove" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                            }
                            html += '</td>';
                            html += '</tr>';
                        });
                    });
                });
                $(".rows_tabla_stickers").html(html);
                $("#div_tabla_stickers").css('visibility', 'visible');
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function marcar_pedido_completo_stickers(id) {
        $.ajax({
            url: '/Trims/marcar_sticker_orden_impresos',
            data: "{'pedido':'" + id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                stickers_orden();
            }
        });
    }
    function cambiar_estado_impresion_sticker(informacion) {
        var datos = informacion.split('*');
        $.ajax({
            url: '/Trims/cambiar_estado_stickers_individual',
            data: "{'talla':'" + datos[0] + "','request':'"+datos[1]+"','estado':'"+datos[2]+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
               stickers_orden();
            }
        });
    }
    /*STICKERS */
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*STOCK*/
    $(document).on("click", ".btn_list_trim", function () {
        cerrar_div_cambio_inventario();
        llenar_tabla_inventario_trims();
    });
    function cerrar_div_cambio_inventario() {
        $("#div_pedido_inventario_trim").css('visibility', 'hidden');
        $("#div_cambiar_inventario").css('visibility', 'hidden');
    }
    function llenar_tabla_inventario_trims() {
        $("#load_trim").css('display', 'inline');
        var descripcion,orden,familia;
        if ($("#caja_busqueda_trim_inventario").val() != '') {
            descripcion = $("#caja_busqueda_trim_inventario").val();
        } else {
            descripcion = 0;
        }
        if ($("#caja_busqueda_familia_trim_inventario").val() != '') {
            familia = $("#caja_busqueda_familia_trim_inventario").val();
        } else {
            familia = 0;
        }
        $.ajax({
            url: '/Trims/buscar_inventario_trims',
            contentType: 'application/json',
            data: "{'descripcion':'" + descripcion + "','familia':'" + familia + "'}",
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td style="width:5%;" >' + item.id_inventario + '</td>';
                    html += '<td style="width:25%;" >' + item.descripcion + '</td>';
                    html += '<td style="width:10%;" >' + item.total + '</td>';
                    if (item.id_pedido != 0) {
                        html += '<td style="width:10%;" >' + item.po + '</td>';
                    } else {
                        html += '<td style="width:10%;" ></td>';
                    }
                    html += '<td style="width:10%;" >' + item.family_trim + '</td>';
                    html += '<td style="width:10%;" >' + item.customer + '</td>';
                    html += '<td style="width:10%;" >' + item.sucursal + '</td>';
                    if (item.id_location == 72) {
                        html += '<td style="width:11%;" >BODEGA</td>';
                    }
                    if (item.id_location == 73) {
                        html += '<td style="width:11%;" >TRIM OFFICE</td>';
                    }
                    if (usuario != 89 && usuario != 90) {
                        html += '<td style="width:3%;" ></td>';
                        html += '<td style="width:3%;" ><button type="button" title="Change total"  class="btn " onclick="editar_cantidad_stock( \'' + item.id_inventario + '*' + item.descripcion + '*' + item.total + '*' + item.po + '*' + item.id_pedido + '\')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-pencil" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                        html += '<td style="width:3%;" ></td>';
                    } else {
                        html += '<td style="width:3%;" ></td>';
                        html += '<td style="width:3%;" ><button type="button" title="Change total"  class="btn " onclick="editar_cantidad_stock( \'' + item.id_inventario + '*' + item.descripcion + '*' + item.total + '*' + item.po + '*' + item.id_pedido + '\')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-pencil" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                        html += '<td style="width:3%;" ></td>';
                    }
                    html += '</tr>';
                });
                $(".body_tabla_trims_lista_inventario").html(html);
                $('#caja_lugar_nuevo').val('')
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function editar_cantidad_stock(informacion) {
        var datos = informacion.split('*');
        $('#div_editar_inventario').css('display','inline');
        $('#caja_id_inventario_trim_ed').val(datos[0]);
        $('#etiqueta_item_cambiar_ed').val(datos[1]+' '+datos[3]);
        $('#caja_cantidad_cambio_trim_inventario_ed').val(datos[2]);
    }
    function cerrar_div_edicion_inventario() {
        $('#div_editar_inventario').css('display','none');
    }
    function editar_inventario_trims(event) {
        if ($("#caja_cantidad_cambio_trim_inventario_ed").val() != '' && $("#caja_cantidad_cambio_trim_inventario_ed").val() != '0') {
            $("#caja_cantidad_cambio_trim_inventario_ed").css('border', '1px solid #ccc');
            $("#load_trim").css('display', 'inline');
            $.ajax({
                url: '/Trims/editar_cantidades_inventario_trim',
                contentType: 'application/json',
                data: "{'inventario':'" + $('#caja_id_inventario_trim_ed').val() + "','cantidad':'" + $('#caja_cantidad_cambio_trim_inventario_ed').val() + "'}",
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    cerrar_div_edicion_inventario();
                    llenar_tabla_inventario_trims();
                    $("#load_trim").css('display', 'none');
                }
            });
        } else {
            event.preventDefault();
            $("#caja_cantidad_cambio_trim_inventario_ed").css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check your quantities, please');
            return false;
        }
    }
    function buscar_inventario_tabla_trims(event) {
        if (event.keyCode == 13) {
            llenar_tabla_inventario_trims();
            //alert("dfdfds");
        }
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    $(document).on("click", ".btn_cantidades_stock", function () {
        $(".body_tabla_cambiar_cantidades_stock").html('');
        cargar_stock_vacio();
    });
    function cargar_stock_vacio() {
         $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/obtener_stock',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, i) {
                    html += '<tr>';
                    html += '<td>' + i.id_inventario + '</td>';
                    html += '<td>' + i.descripcion + '</td>';
                    html += '<td>' + i.sucursal + '</td>';
                    html += '<td>' + i.location + '</td>';
                    html += '<td>' + i.total + '</td>';
                    html += '<td><input maxlength="10" class="numeric form-control  " value="' + i.total  + '" /></td>';
                    html += '<td style=" "><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus deleteRowCS"></button></td>';
                    html += '</tr>';
                });
                $(".body_tabla_cambiar_cantidades_stock").html(html);
                 $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("click", ".deleteRowCS", function () {
        $(this).closest("tr").remove();
    });
    function guardar_cambio_cantidades_stock(event) {
        $("#load_trim").css('display', 'inline');
        var error = 0;
        var inventario = '', total = '';
        $('#tabla_cambiar_cantidades_stock tbody tr').each(function () {
            if ($(this).find('td:eq(5) input').val() != '') {
                inventario += "*" + $(this).find('td:eq(0) ').html();
                total += "*" + $(this).find('td:eq(5) input').val();
            } else {
                error++;
            }
        });
        if (error == 0) {
            $.ajax({
                url: '/Trims/cambiar_totales_stock',
                data: "{'inventario':'"+inventario+"','total':'"+total+"'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#modal_cantidades_stock').modal('hide');
                     $("#load_trim").css('display', 'none');
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                }
            });
        } else {
             $("#load_trim").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    $(document).on("change", "#caja_sucursal_stock_list", function () {
       if ( $("#caja_sucursal_stock_list").val() =='2' || $("#caja_sucursal_stock_list").val() =='3' ) {
            $("#caja_location_stock_list").html('<option value="72">BODEGA</option>');
       } else {
           if ($("#caja_sucursal_stock_list").val() == '0') {
               $("#caja_location_stock_list").html('<option value="0">ALL</option>');
           } else {
               $("#caja_location_stock_list").html('<option value="0">ALL</option><option value="72">BODEGA</option><option value="73">TRIM OFFICE</option>');
           }
        }
    });
    function ver_reporte_stock(event) {
        var sucursal, location;
        sucursal = $("#caja_sucursal_stock_list").val();
        location=$("#caja_location_stock_list").val();
        if ( $("#caja_sucursal_stock_list").val()!='SELECT') {
            $.ajax({
                url: '/Trims/sesiones_lista_stock',
                data: "{'sucursal':'" + sucursal + "','location':'" + location + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (jsonData) {
                    $('#modal_lista_stock').modal('hide');
                }
            });
            $("#espera_t").css('display', 'inline');
            var boton = document.getElementById('link_excel_lista_stock');
            setTimeout(function () { $("#espera_t").css('display', 'none'); }, 2000);
            boton.click();
        } else {
            event.preventDefault();
            alertify.alert('Error!', 'Select the correct option');
            return false;
        }
    }
    /*STOCK*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*TRANSFERENCIA*/
    $(document).on("click", ".btn_transferencia_trim", function () {
        $(".body_transferencia_trim").html('');
        $("#caja_stock_transfer").html('');
        cargar_stock_transferencia();
    });
    var lista_stock_transfer;
    function cargar_stock_transferencia() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/obtener_stock',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_stock_transfer = result;
                var html = '';
                $.each(result, function (key, i) {
                    html += '<option value="' + i.id_inventario + '">' + i.descripcion + '</option>';
                });
                $("#caja_stock_transfer").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function agregar_transferencia() {
        var html = '';
        $("#load_trim").css('display', 'inline');
         $.each(lista_stock_transfer, function (key, i) {
             if (i.id_inventario == $("#caja_stock_transfer").val()) {
                 html += '<tr>';
                 html += '<td>' + i.id_inventario + '</td>';
                 html += '<td>' + i.descripcion + '</td>';
                 html += '<td>' + i.sucursal + '</td>';
                 html += '<td>' + i.location + '</td>';
                 html += '<td>' + i.total + '</td>';
                 html += '<td><select class="form-control  trans_branch"  >';
                 html += '<option  value="1">FORTUNE</option>';
                 html += '<option  value="2">LUCKY</option>';
                 html += '<option  value="3">LUCKY 2</option>';
                 html += '</select></td>';
                 html += '<td><select class="form-control  trans_location"  >';
                 html += '<option  value="72">BODEGA</option>';
                 html += '<option  value="73">TRIM OFFICE</option>';
                 html += '</select></td>';
                 html += '<td><input maxlength="10" class="numeric form-control  " value="' + i.total + '" /></td>';
                 html += '<td style=" "><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus deleteRowTrs"></button></td>';
                 html += '</tr>';
             }
         });
        $(".body_transferencia_trim").append(html);
        $("#load_trim").css('display', 'none');
    }
    $(document).on("click", ".deleteRowTrs", function () { $(this).closest("tr").remove(); });
    function guardar_transferencia_trims(event) {
        $("#load_trim").css('display', 'inline');
        var error = 0;
        var inventario = '', total = '',sucursal='',location='';
        $('#tabla_transferencia_trim tbody tr').each(function () {
            if ($(this).find('td:eq(7) input').val() != '' && $(this).find('td:eq(7) input').val() != '0' ) {
                inventario += "*" + $(this).find('td:eq(0) ').html();
                total += "*" + $(this).find('td:eq(7) input').val();
                sucursal += "*" + $(this).find('.trans_branch').val();
                location += "*" + $(this).find('.trans_location').val();
            } else {
                error++;
            }
        });
        if (error == 0) {
            $.ajax({
                url: '/Trims/guardar_transferencia_trims',
                data: "{'inventario':'"+inventario+"','total':'"+total+"','sucursal':'"+sucursal+"','location':'"+location+"'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#modal_transferencia_trim').modal('hide');
                    $("#load_trim").css('display', 'none');
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                }
            });
        } else {
            $("#load_trim").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
     $(document).on("click", ".btn_lista_transferencias", function () {
        buscar_transferencias();
     });
    function buscar_transferencias() {
        var inicio = 0, final = 0;
        if ($('#caja_inicio_transfer').val() != '') { inicio = $('#caja_inicio_transfer').val();}
        if ($('#caja_final_transfer').val() != '') { final = $('#caja_final_transfer').val();}
        $.ajax({
            url: '/Trims/buscar_transferencias',
            data: "{'inicio':'" + inicio + "','final':'" + final + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, t) {
                    var rows = 0;
                    $.each(t.lista_items, function (key, i) { rows++; });
                    html += '<tr>';
                    html += '<td rowspan="rows">'+t.fecha+'</td>';
                    html += '<td rowspan="rows">' + t.usuario + '</td>';
                    $.each(t.lista_items, function (key, i) {
                        html += '<td>'+i.item+'</td>';
                        html += '<td>'+i.total+'</td>';
                        html += '<td>'+i.sucursal+'</td>';
                        html += '<td>'+i.ubicacion+'</td>';
                        html += '<td>'+i.pedido+'</td>';
                        html += '<td>'+i.tipo+'</td>';
                        html += '</tr>';
                    });
                });
                $('.body_transferencias').html(html);
            }
        });
    }
    /*TRANSFERENCIA*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*STOCK A ORDEN*/
    var lista_pedidos_trans,lista_trims_tso,lista_trims_tos;
    $(document).on("click", "#ver_modal_transfer_stock_order", function () {
        buscar_pedidos_transfer();
        obtener_stock_tso();
        $('.rows_tabla_trans_stock_orden').html('');
    });
    function buscar_pedidos_transfer() {
         $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_pedidos_trans = result;
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function obtener_stock_tso() {
         $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/obtener_stock',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_trims_tso = result;
                var html = '';
                $.each(result, function (key, i) {
                    html += '<option value="' + i.id_inventario + '">' + i.descripcion + '</option>';
                });
                $("#caja_stock_tso").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function add_trim_tso() {
        var html = '';
        html += '<tr>';
        html += '<td>'+$('#caja_stock_tso').val()+'</td>';
        html += '<td>' + $('#caja_stock_tso option:selected').text() + '</td>';
        $.each(lista_trims_tso, function (key, i) {
            if ( i.id_inventario==$('#caja_stock_tso').val() ) {
                html += '<td>'+i.total+'</td>';
            }
        });
        html += '<td><select class="form-control js-example-basic-single tso" style="width:100%;  ">';
        $.each(lista_pedidos_trans, function (key, i) {
            html += '<option  value="' + i.id_pedido + '">' + i.pedido + '</option>';
        });
        html += '</select></td>';
        html += '<td><input maxlength="10" class="numeric form-control  "  /></td>';
        html += '<td><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus DelTSO"></button></td>';
        html += '</tr>';
        $('.rows_tabla_trans_stock_orden').append(html);
        $('.js-example-basic-single2').select2();
        $('.js-example-basic-single').select2();
    }
    $(document).on("click", ".DelTSO", function () { $(this).closest("tr").remove(); });
    function guardar_tso(event){
        $("#load_trim").css('display', 'inline');
        var error = 0,contador=0;
        var inventario = '', total = '',orden='';
        $('#tabla_trans_stock_orden tbody tr').each(function () {
            if ($(this).find('td:eq(4) input').val() != '' && $(this).find('td:eq(4) input').val() != '0' ) {
                inventario += "*" + $(this).find('td:eq(0) ').html();
                total += "*" + $(this).find('td:eq(4) input').val();
                orden += "*" + $(this).find('.tso').val();
                $(this).find('td:eq(4) input').css('border', '1px solid #cccccc');
                contador++;
            } else {
                error++;
                $(this).find('td:eq(4) input').css('border', '2px solid #e03f3f');
            }
        });
        if (error == 0 && contador!=0) {
            $.ajax({
                url: '/Trims/guardar_transferencia_stock_orden',
                data: "{'inventario':'"+inventario+"','total':'"+total+"','orden':'"+orden+"'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#modal_transfer_stock_order').modal('hide');
                    $("#load_trim").css('display', 'none');
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                }
            });
        } else {
            $("#load_trim").css('display', 'none');
            event.preventDefault();
            if (error != 0) {
                alertify.alert('Error!', 'Check empty fields, please');
            }
            if (contador == 0) {
                alertify.alert('Error!', 'There are not rows in the table');
            }
            return false;
        }
    }
    /*STOCK A ORDEN*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*ORDEN A STOCK*/
    $(document).on("click", "#ver_modal_transfer_order_stock", function () {
        buscar_pedidos_transfer_tos();
        $('.rows_tabla_trans_orden_stock').html('');
        $("#caja_items_pedido_tos").html('');
    });
    function buscar_pedidos_transfer_tos() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_pedidos_trans = result;
                var html = '';
                html += '<option value="0">SELECT</option>';
                $.each(lista_pedidos_trans, function (key, i) {
                    html += '<option  value="' + i.id_pedido + '">' + i.pedido + '</option>';
                });
                $('#caja_pedido_tos').html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_tos", function () {
        $.ajax({
            url: '/Trims/obtener_stock_orden',
            data:"{'orden':'"+$('#caja_pedido_tos').val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_trims_tos = result;
                var html = '';
                $.each(result, function (key, i) {
                    html += '<option value="' + i.id_item + '">' + i.descripcion + '</option>';
                });
                $("#caja_items_pedido_tos").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    });
    function add_trim_tos() {
        var html = '';
        html += '<tr>';
        html += '<td>'+$('#caja_items_pedido_tos').val()+'</td>';
        html += '<td>' + $('#caja_items_pedido_tos option:selected').text() + '</td>';
        $.each(lista_trims_tos, function (key, i) {
            if ( i.id_item==$('#caja_items_pedido_tos').val() ) {
                html += '<td><select class="form-control  pedido_tos" style="width:100%;  ">';
                html += '<option  value="' + $('#caja_pedido_tos').val() + '">' + $('#caja_pedido_tos option:selected').text() + '</option>';
                html += '</select></td>';
                html += '<td>'+i.total+'</td>';
            }
        });
        html += '<td><input maxlength="10" class="numeric form-control  "  /></td>';

        html += '<td><select class="form-control  branch_tos" style="width:100%;  ">';
        html += '<option  value="1">FORTUNE</option><option  value="2">LUCKY ONE</option><option  value="3">LUCKY 2</option>';
        html += '</select></td>';

        html += '<td><select class="form-control  location_tos" style="width:100%;  ">';
        html += '<option  value="72">BODEGA</option><option  value="73">TRIMS OFFICE</option><option  value="77">STOCK IMPRESIONES</option>';
        html += '</select></td>';

        html += '<td><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus DelTOS"></button></td>';
        html += '</tr>';
        $('.rows_tabla_trans_orden_stock').append(html);
        $('.js-example-basic-single2').select2();
    }
    $(document).on("click", ".DelTOS", function () { $(this).closest("tr").remove(); });
    function guardar_tos(event){
        $("#load_trim").css('display', 'inline');
        var error = 0,contador=0;
        var item = '', orden = '',total='',sucursal='',locacion='';
        $('#tabla_trans_orden_stock tbody tr').each(function () {
            if ($(this).find('td:eq(4) input').val() != '' && $(this).find('td:eq(4) input').val() != '0' ) {
                item += "*" + $(this).find('td:eq(0) ').html();
                total += "*" + $(this).find('td:eq(4) input').val();
                orden += "*" + $(this).find('.pedido_tos').val();
                sucursal += "*" + $(this).find('.branch_tos').val();
                locacion += "*" + $(this).find('.location_tos').val();
                $(this).find('td:eq(4) input').css('border', '1px solid #cccccc');
                contador++;
            } else {
                error++;
                $(this).find('td:eq(4) input').css('border', '2px solid #e03f3f');
            }
        });
        if (error == 0 && contador!=0) {
            $.ajax({
                url: '/Trims/guardar_transferencia_orden_stock',
                data: "{'item':'"+item+"','orden':'"+orden+"','total':'"+total+"','sucursal':'"+sucursal+"','locacion':'"+locacion+"'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#modal_transfer_order_stock').modal('hide');
                    $("#load_trim").css('display', 'none');
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                }
            });
        } else {
            $("#load_trim").css('display', 'none');
            event.preventDefault();
            if (error != 0) {
                alertify.alert('Error!', 'Check empty fields, please');
            }
            if (contador == 0) {
                alertify.alert('Error!', 'There are not rows in the table');
            }
            return false;
        }
    }
    /*ORDEN A STOCK*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*AUDITORIA*/
    $(document).on("click", "#btn_auditoria", function () {
        $('.rows_tabla_trims_ordenes').html('');
        $('#caja_items_audit').html('');
        $('#caja_estilo_audit').html('<option value="0">ALL</option>');
        $('#caja_talla_audit').html('<option value="0">ALL</option>');
        $("#div_ordenes_dos_semanas").css('display', 'inline');
        $('#div_tabla_trims_ordenes').css('visibility', 'hidden');
        buscar_pedidos_auditoria();
        setTimeout(function(){ buscar_pedidos_dos_semanas(); }, 2000);
    });
    function buscar_pedidos_dos_semanas() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pedidos_dos_semanas',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                var contador = 1;
                html += '<table>';
                $.each(result, function (key, i) {
                    if (contador == 1) { html += '<tr >'; }
                    html += '<td style="width:10%;">';
                    html += '<div style="border: 1px solid #f5f5f5;background: #fdfcfc;color: #a94442; border-radius: 5px; text-align: center;margin: 1em;">';
                    html += '<div class="card">';
                    html += '<div class="card-body">';
                    html += '<h5 class="card-title"  onclick="cambiar_pedido_auditoria(' + i.id_pedido +  ')" ><b>' + i.pedido + '</b></h5>';
                    html += '</div>';
                    html += '</div>';
                    html += '</div>';
                    html += '</td>';
                    if (contador == 10) {
                        contador = 1;
                        html += '</div>';
                        html += '</tr>';
                    } else { contador++;}
                }); if (contador!=10) { html += '</tr>'; }
                html += '</table>';
                $("#div_ordenes_dos_semanas").html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function cambiar_pedido_auditoria(info) {
        $('#caja_pedido_audit option').each(function (i, e) {
            if (this.value == info) {
                $(this).attr('selected', 'selected');
                $(this).val(info).change();
            }
        });
        $("#div_ordenes_dos_semanas").css('display', 'none');
    }
    function buscar_pedidos_auditoria() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                html += '<option value="0">SELECT</option>';
                $.each(result, function (key, i) {
                    html += '<option  value="' + i.id_pedido + '">' + i.pedido + '</option>';
                });
                $('#caja_pedido_audit').html(html);
                $('.js-example-basic-single').select2();
                $('#caja_pedido_audit').select2();
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var trim_orden_auditoria;
    $(document).on("change", "#caja_pedido_audit", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_trims_orden',
            data:"{'orden':'"+$('#caja_pedido_audit').val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                trim_orden_auditoria = jsonData.Data.trims_request;
                var trims_anteriores = jsonData.Data.trims_orden;
                $('.rows_tabla_trims_ordenes').html('');
                var html = '';
                html += '<option value="0">SELECT</option>';
                $.each(trim_orden_auditoria, function (key, i) {
                    html += '<option  value="' + i.id_request + '_'+i.id_item+'">' + i.item + '</option>';
                });
                $('#caja_items_audit').html(html);

                $.each(trims_anteriores, function (key, t) {
                    html = '<tr>';
                    html += '<td><p>' + t.usuario + '</p><p>' + t.fecha + '</p></td>';
                    if (t.po == '0') { html += '<td style="color:white;">' + t.po + '</td>'; } else { html += '<td>'+t.po+'</td>'; }
                    html += '<td><select class="form-control  item_aud auditoria" style="width:100%; -webkit-appearance: none; ">';
                    html += '<option  value="' + t.id_request + '_' + t.id_item + '">' + t.item + '</option></select></td>';
                    html += '<td><select class="form-control  estilo_aud auditoria" style="width:100%;-webkit-appearance: none;  ">';
                    if (t.id_summary == 0) { html += '<option  value="0">ALL</option></select></td>'; }
                    else { html += '<option  value="' + t.id_summary + '">' + t.estilo + '</option></select></td>'; }
                    html += '<td><select class="form-control  talla_aud auditoria" style="width:100%; -webkit-appearance: none; ">';
                    if (t.id_talla == 0) { html += '<option  value="0">ALL</option></select></td>'; }
                    else { html += '<option  value="' + t.id_talla + '">' + t.talla + '</option></select></td>'; }
                    html += '<td><input maxlength="10" class="numeric form-control "  value="'+t.total+'" /></td>';
                    html += '<td><select class="form-control  branch_aud auditoria" style="width:100%; -webkit-appearance: none; ">';
                    if (t.id_sucursal == 1) {
                        html += '<option selected value="1">FORTUNE</option>';
                        html += '<option  value="2">LUCKY ONE</option>';
                    } else {
                        html += '<option  value="1">FORTUNE</option>';
                        html += '<option selected  value="2">LUCKY ONE</option>';
                    }
                    html += '</select></td>';
                    html += '<td><input maxlength="10" class="validacion form-control locacion_auditoria " value="'+t.locacion+'"  /></td>';
                    html += '<td><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus delAudit"></button></td>';
                    html += '<td style="color:white; font-size:0.1em;">'+t.id_trim_order+'</td>';
                    html += '</tr>';
                    $('.rows_tabla_trims_ordenes').append(html);
                });
                $('#div_tabla_trims_ordenes').css('visibility', 'visible');
                $("#div_ordenes_dos_semanas").css('display', 'none');
                $("#load_trim").css('display', 'none');
            }
        });
    });
    $(document).on("change", "#caja_items_audit", function () {
        $("#load_trim").css('display', 'inline');
        var r = $('#caja_items_audit').val();
        var request = r.split('_');
        var html = '';
        html += '<option value="0">ALL</option>';
        $.each(trim_orden_auditoria, function (key, t) {
            if (request[0] == t.id_request) {
                $.each(t.lista_estilos, function (key, e) {
                    html += '<option  value="' + e.id_summary+'">' + e.descripcion + '</option>';
                });
            }
        });
        $('#caja_estilo_audit').html(html);
        $("#load_trim").css('display', 'none');
    });
    $(document).on("change", "#caja_estilo_audit", function () {
        $("#load_trim").css('display', 'inline');
        var r = $('#caja_items_audit').val();
        var request = r.split('_');
        var html = '';
        html += '<option value="0">ALL</option>';
        $.each(trim_orden_auditoria, function (key, t) {
            if (request[0] == t.id_request) {
                $.each(t.lista_estilos, function (key, e) {
                    if ($('#caja_estilo_audit').val() == e.id_summary) {
                        $.each(e.lista_tallas, function (key, tt) {
                            html += '<option  value="' + tt.id_talla+'">' + tt.talla + '</option>';
                        });
                    }
                });
            }
        });
        $('#caja_talla_audit').html(html);
        $("#load_trim").css('display', 'none');
    });
    var pos_ht;
    function add_trim_orden_row() {
        $("#load_trim").css('display', 'inline');
        var familia = '';
        var r = $('#caja_items_audit').val();
        var request = r.split('_');
        $.each(trim_orden_auditoria, function (key, t) {
            if (request[0] == t.id_request) {
                familia = t.tipo_item;
            }
        });
        new_trim_orden_row('0*' + $('#caja_talla_audit').val() + '*' + $('#caja_talla_audit option:selected').text());
        $("#load_trim").css('display', 'none');
    }
    function buscar_po_hottopic() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pos_ht',
            data:"{'orden':'"+$('#caja_pedido_audit').val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                pos_ht = result;
                $("#load_trim").css('display', 'none');
            }
        });
    }
    function new_trim_orden_row(informacion) {
        var datos = informacion.split('*');
        var html = '';
        html += '<tr>';
        html += '<td>NEW</td>';
        if (datos[0] == '0') {
            html += '<td style="color:white;">' + datos[0] + '</td>';//PO
        } else { html += '<td>'+datos[0]+'</td>'; }

        html += '<td><select class="form-control  item_aud auditoria" style="width:100%; -webkit-appearance: none; ">';
        html+='<option  value="'+$('#caja_items_audit').val()+'">'+$('#caja_items_audit option:selected').text() + '</option></select></td>';

        html += '<td><select class="form-control  estilo_aud auditoria" style="width:100%;-webkit-appearance: none;  ">';
        html += '<option  value="'+$('#caja_estilo_audit').val()+'">'+$('#caja_estilo_audit option:selected').text() + '</option></select></td>';

        html += '<td><select class="form-control  talla_aud auditoria" style="width:100%; -webkit-appearance: none; ">';
        html+= '<option  value="'+datos[1]+'">'+ datos[2] + '</option></select></td>';

        html += '<td><input maxlength="10" class="numeric form-control  " /></td>';
        html += '<td><select class="form-control  branch_aud auditoria" style="width:100%; -webkit-appearance: none; ">';
        html += '<option  value="1">FORTUNE</option><option  value="2">LUCKY ONE</option>';
        html += '</select></td>';
        html += '<td><input maxlength="10" class="validacion form-control locacion_auditoria "  /></td>';
        html += '<td><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus delAudit"></button></td>';
        html += '<td style="color:white; font-size:0.1em;">0</td>';
        html += '</tr>';
        $('.rows_tabla_trims_ordenes').append(html);
    }
    $(document).on("click", ".delAudit", function () { $(this).closest("tr").remove(); });
    $(document).on("input", ".locacion_auditoria", function () { $('.locacion_auditoria').autocomplete({ source: '@Url.Action("Autocomplete_ubicacion")' }); });
    function guardar_auditoria(event) {
        $("#load_trim").css('display', 'inline');
        var error = 0,contador=0;
        var orden = '', item = '', estilo = '', talla = '', total = '', sucursal = '', locacion = '',anterior='',po='';
        orden = $('#caja_pedido_audit').val();
        $('#tabla_trims_ordenes tbody tr').each(function () {
            if ($(this).find('td:eq(5) input').val() != '' && $(this).find('td:eq(5) input').val() != '0' && $(this).find('td:eq(7) input').val()!='' ) {
                item += "*" + $(this).find('.item_aud').val();
                estilo += "*" + $(this).find('.estilo_aud').val();
                talla += "*" + $(this).find('.talla_aud').val();
                total += "*" + $(this).find('td:eq(5) input').val();
                sucursal += "*" + $(this).find('.branch_aud').val();
                locacion += "*" + $(this).find('td:eq(7) input').val();
                anterior += "*" + $(this).find('td:eq(9)').html();
                if ($(this).find('td:eq(1)').html() != '') {
                    po += "*" + $(this).find('td:eq(1)').html();
                } else { po += "*0"; }
                $(this).find('td:eq(5) input').css('border', '1px solid #cccccc');
                $(this).find('td:eq(7) input').css('border', '1px solid #cccccc');
                contador++;
            } else {
                error++;
                if ($(this).find('td:eq(7) input').val() == '') {
                     $(this).find('td:eq(7) input').css('border', '2px solid #e03f3f');
                }
                if ($(this).find('td:eq(5) input').val() == '' || $(this).find('td:eq(4) input').val() == '0') {
                     $(this).find('td:eq(5) input').css('border', '2px solid #e03f3f');
                }
            }
        });
        if (error == 0 && contador!=0) {
            $.ajax({
                url: '/Trims/guardar_auditoria_trims_orden',
                data: "{'orden':'"+orden+"','item':'"+item+"','estilo':'"+estilo+"','talla':'"+talla+"','total':'"+total+"','sucursal':'"+sucursal+"','locacion':'"+locacion+"','anterior':'"+anterior+"','po':'"+po+"'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#modal_separar_cosas').modal('hide');
                    $("#load_trim").css('display', 'none');
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                }
            });
        } else {
            $("#load_trim").css('display', 'none');
            event.preventDefault();
            if (error != 0) {
                alertify.alert('Error!', 'Check empty fields, please');
            }
            if (contador == 0) {
                alertify.alert('Error!', 'There are not rows in the table');
            }
            return false;
        }
    }
    /*AUDITORIA*/
    /***************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************/
    /*ENTREGAS*/
    var trims_entregas;
    $(document).on("click", "#btn_entrega", function () {
        buscar_pedidos_entregas();
        //setTimeout(function(){ buscar_pedidos_dos_semanas(); }, 2000);
        $('#tabla_nueva_entrega').css('visibility', 'hidden');
        $('.rows_tabla_nueva_entrega').html('');
         $("#caja_stock_entrega").html('');
    });
    function buscar_pedidos_entregas() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                html += '<option  value="SELECT">SELECT</option>';
                html += '<option  value="0">NONE</option>';
                $.each(result, function (key, i) {
                    html += '<option  value="' + i.id_pedido + '">' + i.pedido + '</option>';
                });
                $('#caja_pedido_entrega').html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    $(document).on("change", "#caja_pedido_entrega", function () {
       if ($("#caja_pedido_entrega").val() != 'SELECT' && $("#caja_pedido_entrega").val() != '0') {
            $(".stock_entrega").css('display','none');
            $(".trims_entrega").css('display', 'inline');
           buscar_trims_pedido_entrega();
           setTimeout(function () {
                agregar_trims_nueva_entrega();
            }, 2000);
        } else {
           $(".stock_entrega").css('display','inline');
           $(".trims_entrega").css('display', 'none');
           buscar_trims_stock_entrega();
        }
         $('#tabla_nueva_entrega').css('visibility','visible');
    });
    function agregar_trims_nueva_entrega() {
         $("#load_trim").css('display', 'inline');
         $.each(trims_entregas, function (key, t) {
             var html = '';
             html += '<tr>';
             if (t.po != '0') { html += '<td>' + t.item +' '+t.po+ '</td>'; } else { html += '<td>' + t.item + '</td>'; }
             if (t.id_summary == 0) { html += '<td></td>'; } else { html += '<td>' + t.estilo + '</td>';}
             if (t.id_talla == 0) { html += '<td></td>'; } else { html += '<td>' + t.talla + '</td>'; }
             html += '<td>'+t.total+'</td>';//order
             html += '<td><input maxlength="10" class="numeric form-control " value="0"  /></td>';//total
             html += '<td><input maxlength="300" class="validacion form-control "  /></td>';//comentarios
             html += '<td><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus delEntrega"></button></td>';
             html += '<td style="color:white; font-size:0.1em;">0</td>';
             html += '<td style="color:white; font-size:0.1em;">' + t.id_pedido+ '</td>';
             html += '<td style="color:white; font-size:0.1em;">' + t.id_trim_order + '</td>';
             html += '<td style="color:white; font-size:0.1em;">' + t.id_request + '</td>';
             html += '</tr>';
             $('.rows_tabla_nueva_entrega').append(html);
         });
         $("#load_trim").css('display', 'none');
    }
    function agregar_stock_nueva_entrega() {
        var datos = ($("#caja_stock_entrega").val()).split('_');
        var html = '';
        html += '<tr>';
        html += '<td>' + $("#caja_stock_entrega option:selected").text() + '</td>';
        html += '<td></td>';
        html += '<td></td>';
        html += '<td>' +datos[1] + '</td>';//order
        html += '<td><input maxlength="10" class="numeric form-control "  /></td>';//total
        html += '<td><input maxlength="300" class="validacion form-control "  /></td>';//comentarios
        html += '<td><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus delEntrega"></button></td>';
        html += '<td style="color:white; font-size:0.1em;">' +datos[0] + '</td>';
        html += '<td style="color:white; font-size:0.1em;">0</td>';
        html += '<td style="color:white; font-size:0.1em;">0</td>';
        html += '<td style="color:white; font-size:0.1em;">0</td>';
        html += '</tr>';
        $('.rows_tabla_nueva_entrega').append(html);
    }
    $(document).on("click", ".delEntrega", function () { $(this).closest("tr").remove(); });
    function buscar_trims_pedido_entrega() {
        $.ajax({
            url: '/Trims/buscar_trims_pedido',
            contentType: 'application/json',
            data: "{'pedido':'" + $("#caja_pedido_entrega").val() + "'}",
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                trims_entregas = jsonData.Data.trims;
            }
        });
    }
    function buscar_trims_stock_entrega() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_inventario_stock_entrega',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, i) {
                    html += '<option  value="' + i.id_inventario + '_' + i.total+'">' + i.descripcion +'</option>';
                });
                $("#caja_stock_entrega").html(html);
                 $("#load_trim").css('display', 'none');
            }
        });
    }
    function guardar_entrega(event) {
        $("#load_trim").css('display', 'inline');
        var error = 0,contador=0;
        var orden,entrega,recibe,total='',comentario='',inventario='',pedido='',trim_orden='',request='';
        orden = $("#caja_pedido_entrega").val();
        $('#tabla_nueva_entrega tbody tr').each(function () {
            if ( $(this).find('td:eq(4) input').val() != '0' && $(this).find('td:eq(4) input').val() != '' ) {
                total += "*" + $(this).find('td:eq(4) input').val();
                inventario += "*" + $(this).find('td:eq(7) ').html();
                pedido += "*" + $(this).find('td:eq(8) ').html();
                trim_orden += "*" + $(this).find('td:eq(9) ').html();
                request += "*" + $(this).find('td:eq(10) ').html();
                $(this).find('td:eq(4) input').css('border', '1px solid #cccccc');
                if ($(this).find('td:eq(5) input').val() != '') {
                    comentario+= '*' + $(this).find('td:eq(5) input').val();
                } else {
                    comentario+= '*N/A';
                }
                contador++;
            }
        });
        if ($("#caja_nombre_entrega").val() == '0' || $("#caja_nombre_entrega").val() == '') {$("#caja_nombre_entrega").css('border', '2px solid #e03f3f'); error++; } else { $("#caja_nombre_entrega").css('border', '1px solid #cccccc');}
        if ($("#caja_nombre_recibe").val() == '0' || $("#caja_nombre_recibe").val() == '') {$("#caja_nombre_recibe").css('border', '2px solid #e03f3f'); error++; } else { $("#caja_nombre_recibe").css('border', '1px solid #cccccc');}
        entrega = $("#caja_nombre_entrega").val();
        recibe = $("#caja_nombre_recibe").val();
        if (contador == 0) { error++; }
        if (error == 0) {
            $.ajax({
                url: '/Trims/guardar_entrega',
                data: "{'orden':'" + orden + "','entrega':'" + entrega + "','recibe':'" + recibe + "','total':'" + total + "','comentario':'" + comentario + "','inventario':'" + inventario + "','pedido':'" + pedido + "','trim_orden':'" + trim_orden + "','request':'" + request + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (jsonData) {
                    $("#caja_nombre_entrega").val("");
                    $("#caja_nombre_recibe").val("");
                    $("#modal_nueva_entrega").modal("hide");
                    $("#load_trim").css('display', 'none');
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                }
            });
        } else {
            $("#load_trim").css('display', 'none');
            alertify.alert('Error!', 'Check your quantities/empty fields, please');
            event.preventDefault();
            return false;
        }
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    $(document).on("click", "#btn_lista_entrega", function () {
        buscar_pedidos_lista_entregas();
        $('#tabla_lista_entregas').css('visibility', 'hidden');
        $('.rows_tabla_lista_entregas').html('');
        $("#caja_inicio_lista_entrega").html('');
        $("#caja_final_lista_entrega").html('');
    });
    function buscar_pedidos_lista_entregas() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                html += '<option  value="0">SELECT</option>';
                $.each(result, function (key, i) {
                    html += '<option  value="' + i.id_pedido + '">' + i.pedido + '</option>';
                });
                $('#caja_pedido_lista_entrega').html(html);
                $("#load_trim").css('display', 'none');
            }
        });
    }
    var lista_entregas;
    $(document).on("change", "#caja_pedido_lista_entrega", function () {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_entregas_orden',
            data: "{'orden':'" + $('#caja_pedido_lista_entrega').val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_entregas = result;
                crear_tabla_entregas();
                $("#load_trim").css('display', 'none');
            }
        });
    });
    function crear_tabla_entregas() {
        $("#load_trim").css('display', 'inline');
        $('.rows_tabla_lista_entregas').html('');
        $.each(lista_entregas, function (key, e) {
            var html = '';
            var total_items = 0;
            $.each(e.lista_entregas, function (key, i) { total_items++;  });
            html += '<tr style="">';
            html += '<td rowspan="' + total_items + '">';
            html+='<span title="Delete full delivery" onclick="delete_delivery_completo('+e.id_entrega+')" class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span></td>';
            html += '<td rowspan="' + total_items + '">';
            if (e.id_pedido != 0) { html += '<p>'+e.pedido+'</p>'; }
            if (e.comentarios !='0') { html += '<p style="overflow-wrap: break-word;">'+e.comentarios+'</p>'; }
            html += '<p>' + e.fecha + '</p></td>';
            html += '<td rowspan="'+total_items+'">'+e.entrega+'</td>';
            html += '<td rowspan="' + total_items + '">' + e.recibe + '</td>';
            $.each(e.lista_entregas, function (key, i) {
                var color;
                if (i.id_inventario != 0) { color = 'white'; } else { if (i.restante >= 1) { color='#ffdcdc'; } else {color='#d0ffd0'; } }
                if (i.id_trim_orden != 0) {
                    html += '<td style="background:'+color+';border: solid 0px white;">' + i.item + ' '+i.estilo+' '+i.talla+'</td>';
                } else {
                    html += '<td style="background:'+color+';border: solid 0px white;">' + i.item + '</td>';
                }
                if (i.id_inventario != 0) {
                    html += '<td style="background:' + color + ';border: solid 0px white;"> </td>';
                } else {
                    html += '<td style="background:' + color + ';border: solid 0px white;">' + i.total_orden + '</td>';
                }
                html += '<td style="background:'+color+';border: solid 0px white;">' + i.total + '</td>';//ENTREGADO
                if (i.id_inventario != 0) {
                    html += '<td style="background:' + color + ';border: solid 0px white;"> </td>';
                } else {
                    if (i.restante >= 1) {
                         html += '<td style="background:' + color + ';border: solid 0px white;">' + i.restante + '</td>';
                    } else {
                        html += '<td style="background:' + color + ';border: solid 0px white;">0</td>';
                    }
                }
                html += '<td style="background:'+color+';border: solid 0px white;">' + i.comentarios + '</td>';
                html += '<td style="background:' + color + ';border: solid 0px white;">';
                html += '<span title="Return item"  onclick="return_items_entregados(\'' + i.id_entrega_item + '*' + i.total + '*'+i.item + '\')" class="glyphicon glyphicon-share-alt" aria-hidden="true"></span></td>';
                html += '<td style="background:' + color + ';border: solid 0px white;">';
                html += '<span title="Delete item" onclick="delete_delivery_individual(' + i.id_entrega_item + ')" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span></td>';
                html += '</tr>';
            });
            $('.rows_tabla_lista_entregas').append(html);
        });
        $("#caja_inicio_lista_entrega").html('');
        $("#caja_final_lista_entrega").html('');
        $('#tabla_lista_entregas').css('visibility', 'visible');
        $("#load_trim").css('display', 'none');
    }
    function buscar_entregas_por_fechas() {
        var inicio = 0, final = 0;
        if ($('#caja_inicio_lista_entrega').val() != '') {
            inicio = $('#caja_inicio_lista_entrega').val();
        }
        if ($('#caja_final_lista_entrega').val() != '') {
            final = $('#caja_final_lista_entrega').val();
        }
        $.ajax({
            url: '/Trims/obtener_entregas_fechas',
            data: "{'inicio':'" + inicio + "','final':'" + final + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                lista_entregas = result;
                crear_tabla_entregas();
            }
        });
    }
    function return_items_entregados(informacion) {
        var datos = informacion.split('*');//id,total,item
        $('#div_return_items').css('display', 'inline');
        $('#hidden_id_entrega_return').val(datos[0]);
        $('#hidden_total_original_return').val(datos[1]);
        $('#etiqueta_item_return').val(datos[2]);
        $('#caja_total_return').val(datos[1]);
    }
    function cerrar_div_return_items() {
       $("#caja_total_nuevo_return").val('');
       $('#div_return_items').css('display', 'none');
    }
    function return_item(event) {
        $("#load_trim").css('display', 'inline');
        if (($("#caja_total_nuevo_return").val() != '' && $("#caja_total_nuevo_return").val() != '0') && parseFloat($("#caja_total_nuevo_return").val())<=parseFloat($("#hidden_total_original_return").val()) ) {
            $("#load_trim").css('display', 'inline');
            $("#caja_total_nuevo_return").css('border', '1px solid #cccccc');
            $.ajax({
                url: '/Trims/regresar_item_entregado',
                data: "{'entrega':'" + $("#hidden_id_entrega_return").val() + "','total_original':'" + $("#hidden_total_original_return").val() + "','total_nuevo':'" + $("#caja_total_nuevo_return").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    cerrar_div_return_items();
                    if ($("#caja_pedido_busqueda_entrega").val() != "0") {
                        $("#caja_pedido_busqueda_entrega").trigger("change");
                    } else {
                       buscar_entregas_por_fechas();
                    }
                    $("#load_trim").css('display', 'none');
                }
            });
        } else {
            $("#load_trim").css('display', 'none');
            $("#caja_total_nuevo_return").css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check quantities');
            event.preventDefault();
            return false;
        }
    }
    function delete_delivery_individual(id) {
        $.ajax({
            url: '/Trims/eliminar_entrega_individual',
            data: "{'entrega':'" +id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                if ($("#caja_pedido_busqueda_entrega").val() != "0") {
                    $("#caja_pedido_busqueda_entrega").trigger("change");
                } else {
                    buscar_entregas_por_fechas();
                }
            }
        });
    }
    function delete_delivery_completo(id) {
        $.ajax({
            url: '/Trims/eliminar_entrega_completo',
            data: "{'entrega':'" +id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                if ($("#caja_pedido_busqueda_entrega").val() != "0") {
                    $("#caja_pedido_busqueda_entrega").trigger("change");
                } else {
                    buscar_entregas_por_fechas();
                }
            }
        });
    }
    /*ENTREGAS*/
    /***************************************************************************************************************************************************************/
    function busqueda_estado_pedido() {
        if (event.keyCode == 13) {
            $("#load_trim").css('display', 'inline');
            var busqueda;
            if ($("#caja_busqueda_estado_pedido").val() == "") { busqueda = "0"; } else { busqueda = $("#caja_busqueda_estado_pedido").val(); }
            $.ajax({
                url: '/Trims/buscar_especifico_ordenes_tabla_inicio',
                contentType: 'application/json',
                data: "{'busqueda':'" + busqueda + "'}",
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    var html = '';
                    $.each(result, function (key, item) {
                        var total_orden = 0, total_recibido = 0, total_final = 0;
                        total_final = ((item.cantidad * 100) / item.total).toFixed(2);;
                        if (item.cantidad >= item.total) {
                            html += '<tr style="color:#3c763d;">';
                        } else {
                            html += '<tr style="color:#941c1c;">';
                        }
                        if (item.total == 0 && item.cantidad == 0) { total_final = 0; }
                        html += '<td style="width:10%;">' + item.id_pedido + '</td>';
                        html += '<td style="width:15%;">' + item.pedido + '</td>';
                        html += '<td style="width:15%;">' + item.total + '</td>';
                        html += '<td style="width:20%;">' + item.cantidad+ '</td>';
                        html += '<td style="width:20%;">' + total_final + '% </td>';
                        if (item.estado == 1) {
                            html += '<td style="width:20%;">OPEN</td>';
                        } else {
                            if (item.estado == 2) {
                                html += '<td style="width:20%;">CLOSED</td>';
                            } else {
                                html += '<td style="width:20%;">CANCELED</td>';
                            }
                        }
                        html += '</tr>';
                    });
                    $(".body_tabla_ordenes_inicio").html(html);
                    $("#load_trim").css('display', 'none');
                }
            });
        }
    }
/**************************************************************************************************************************************************************************/
/**************************************************************************************************************************************************************************/
    $(document).on("dblclick", "#tabla_ordenes_inicio tr", function () {
        var row = this.rowIndex;
        obtener_informacion_trims_orden($('#tabla_ordenes_inicio tr:eq(' + row + ') td:eq(0)').html());
        $("#modal_trim_state").modal("show");
    });
    function obtener_informacion_trims_orden(pedido) {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/obtener_estado_total_pedido',
            data: "{'pedido':'" +pedido + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var p=jsonData.Data.pedido;
                var estado=jsonData.Data.estado;
                var html = '';
                var usuario = '';
                $("#titulo_colores").html(p.pedido);
                if (p.id_customer == 1) {
                    $('#tabla_trim_state_po tr:eq(0) td:eq(1)').css("background-color", "#ffcbe5");
                }
                $('#tabla_trim_state_po tr:eq(0) td:eq(1)').html(p.customer);
                $('#tabla_trim_state_po tr:eq(0) td:eq(3)').html(p.ship_date);
                $('#tabla_trim_state_po tr:eq(1) td:eq(1)').html(p.gender);
                $('#tabla_trim_state_po tr:eq(2) td:eq(1)').html(p.fold_size);
                if (estado == 1) { $('#tabla_trim_state_po tr:eq(2) td:eq(3)').html('OPEN'); }
                if (estado == 2) { $('#tabla_trim_state_po tr:eq(2) td:eq(3)').html('CLOSED'); }
                if (estado == 3) { $('#tabla_trim_state_po tr:eq(2) td:eq(3)').html('CANCELED'); }
                var empaque = '';
                $.each(p.lista_empaque, function (key, e) {
                    if (e.tipo_empaque == 1 || e.tipo_empaque == 5 ) {
                        empaque += '<p>'+e.estilo+'&nbsp;&nbsp;BP';
                        $.each(e.lista_ratio, function (key, lr) {
                            empaque += ' '+lr.talla+':'+lr.piezas +' &nbsp;';
                        });
                    } else {
                        empaque += '<p>'+e.estilo+'&nbsp;&nbsp;PPK';
                        $.each(e.lista_ratio, function (key, lr) {
                            empaque += ' ' + lr.ratio + '&nbsp; &nbsp;';
                        });
                    }
                    empaque += '</p>';
                });
                $.each(p.lista_assort, function (key, item) { //ASSORMENTS EN LISTA DE ESTILOS
                    empaque += '<p>'+item.nombre+'&nbsp;&nbsp;ASSORT '+item.cartones+' Cartons</p>';
                });
                $('#tabla_trim_state_po tr:eq(1) td:eq(3)').html(empaque);
                $.each(p.lista_families, function (key, item) {
                    var items = 0;
                    $.each(item.lista_requests, function (key, x) { items++; });
                    if (items == 0) {
                        html += '<tr><td style="vertical-align:middle;  " class="cabecera_tabla2" >' + item.family_trim + '</td>';
                        html += '<td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>';                       
                    } else {
                        if (items > 1) { items++; }
                        var total_total = 0,total_cantidad=0;
                        html += '<tr>';
                        html += '<td rowspan="' + items + '" style="vertical-align:middle; width:21%; " class="cabecera_tabla2">' + item.family_trim + '</td>';
                        $.each(item.lista_requests, function (key, i) {
                            var estilo_request = '', tallas_estilo_request = '';
                            var color = '';                           
                            if (item.family_trim == 'PRICE TICKETS' && !(p.pedido.includes('HOT'))&& !(p.pedido.includes('URB'))&& !(p.pedido.includes('SPC')) && !(p.pedido.includes('FEA')) )   {
                                if (i.impreso==1) { color = '#aefcae'; } else { color = '#ffff7a'; }
                            } else {
                                if (i.cantidad == 0) {
                                    color = '#ffff7a';
                                } else {
                                    if (i.cantidad >= i.total) {
                                        color = '#aefcae';
                                    } else {
                                        color = '#ff8585';
                                    }
                                }
                            }
                            var contador = 0;
                             $.each(i.lista_estilos, function (key, r) {
                                 if (contador == 0) {
                                     tallas_estilo_request += '<p>';
                                    $.each(r.lista_tallas, function (key, t) {
                                        tallas_estilo_request += ' ' + t.talla;
                                        contador++;
                                    });
                                     tallas_estilo_request += '</p>';
                                }
                             });
                             $.each(i.lista_estilos, function (key, r) {
                                    estilo_request += '<p>' + r.descripcion;                                    
                                    estilo_request += '</p>';
                             });
                             html += '<td style="background:' + color + '; border: none; width:20%;" >' + estilo_request + '</td>';
                             html += '<td style="background:' + color + '; border: none; width:5%;" >' + tallas_estilo_request + '</td>';
                             html += '<td style="background:' + color + '; border: none; width:20%;" >' + i.item + '</td>';
                             html += '<td style="background:' + color + '; border: none; width:5%;" >' + i.total + '</td>';
                             total_total += i.total;
                             html += '<td style="background:' + color + '; border: none; width:5%;" >' + i.cantidad + '</td>';
                             total_cantidad += i.cantidad;
                             var recibo, mills = '', fechas_recibo = '';
                             if (i.mill_po.includes('*')) {
                                recibo = i.mill_po.split('*');
                                for (var x = 1; x < recibo.length; x++) {
                                    var tempo = recibo[x].split('_');
                                    mills += ' <p>' + tempo[0] + '</p>';
                                    fechas_recibo += ' <p>' + tempo[1] + '</p>';
                                }
                             }
                             html += '<td style="background:' + color + '; border: none; width:8%;" >' + mills + '</td>';
                             html += '<td style="background:' + color + '; border: none; width:8%;" >' + fechas_recibo + '</td>';                           
                             html += '<td style="background:' + color + '; border: none; width:8%;" ></td>';
                             html += '</tr>';
                             usuario ="<b>Captured by </b>"+ i.usuario;
                        });
                        if (items > 1) {
                            html += '<td style="width:20%;"></td><td style="width:5%;"></td><td style="width:20%;"><b>TOTAL</b></td><td style="width:5%;"><b>' + total_total + '</b></td><td style="width:5%;"><b>' + total_cantidad + '</b></td><td style="width:8%;"></td><td style="width:8%;"></td><td style="width:8%;"></td></tr>';
                        }
                    }
                });
                $(".rows_tabla_trim_state_family").html(html);
                $("#usuario_capturo_requests").html(usuario);
                $("#load_trim").css('display', 'none');
            }
        });
    }
/**************************************************************************************************************************************************************************/
/**************************************************************************************************************************************************************************/
    $(document).on("click", ".btn_list_stock_order", function () {
        $("#caja_pedido_stock_orden").html('');
        $(".body_tabla_stock_orden").html('');
        llenar_pedidos_stock_order();
    });
    function llenar_pedidos_stock_order() {
        $.ajax({
            url: '/Trims/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.pedido + '</option>';
                });
                //html += '</select>';
                $("#caja_pedido_stock_orden").html(html);
                $('.js-example-basic-single').select2();
            }
        });
    }
    $(document).on("change", "#caja_pedido_stock_orden", function () {
        $("#load_trim").css('display', 'inline');
        contador_envio = 0;
         $.ajax({
            url: '/Trims/buscar_stock_orden',
            data:"{'pedido':'"+$("#caja_pedido_stock_orden").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                lista_stock = jsonData.Data.stock;
                var html = '';
                $.each(lista_stock, function (key, s) {
                    if (s.restante>=1) {
                        if (s.total == 0) { html += '<tr style="font-weight:bold;color:red;">'; } else { html += '<tr>'; }
                        html += '<td>' + s.item + '</td>';                        
                        if (s.total >= 1) {
                            html += '<td>' + s.total + '</td>';
                        } else {
                            html += '<td>0</td>';
                        }      
                        html += '<td>' + s.restante + '</td>';
                        if (s.id_sucursal == 1) { html += '<td>FORTUNE</td>'; }
                        if (s.id_sucursal == 2) { html += '<td>LUCKY</td>'; }
                        if (s.id_sucursal == 3) { html += '<td>LUCKY 2</td>'; }
                        if (s.id_location == 72) { html += '<td>BODEGA</td>'; }
                        if (s.id_location == 73) { html += '<td>TRIM OFFICE</td>'; }

                        if (s.total < s.cantidad) {
                            html += '<td><input id="caja_inv_' + s.id_inventario + '" maxlength="10" class="numeric form-control  " value="' + s.total + '" onchange="check_stock_orden(\'' + s.id_inventario + '*' + s.total + '*' + 1 + '\')" /></td>';
                        } else {
                            html += '<td><input id="caja_inv_' + s.id_inventario + '" maxlength="10" class="numeric form-control  " value="' + s.cantidad + '" onchange="check_stock_orden(\'' + s.id_inventario + '*' + s.cantidad + '*' + 1 + '\')" /></td>';
                        }
                        html += '<td style="color:white; font-size:0.1em; ">' + s.id_inventario + '</td>'; //visibility:hidden;
                        html += '<td style="color:white; font-size:0.1em; ">' + s.id_item + '</td>';
                        html += '<td style="color:white; font-size:0.1em; ">' + s.id_request + '</td>';
                        html += '<td style=" "><button title="Delete row from table" type="button" style="border-radius: 20px;" class="btn btn-sm btn-danger glyphicon glyphicon-minus deleteRowTSO"></button></td>';
                        html += '</tr>';
                    }
                });
                $(".body_tabla_stock_orden").html(html);
                $('#div_tabla_stock_orden').css('visibility', 'visible');
                $("#load_trim").css('display', 'none');
            }
         });
        $("#load_trim").css('display', 'none');
    });
    $(document).on("click", ".deleteRowTSO", function () {
        $(this).closest("tr").remove();
    });
    function guardar_stock_orden(event) {
        var error = 0;
        var inventario = '', request = '', item = '', total = '';
        $('#tabla_stock_orden tbody tr').each(function () {
            if ($(this).find('td:eq(5) input').val() != 0 && parseFloat($(this).find('td:eq(5) input').val()) <= parseFloat($(this).find('td:eq(1)').html()) && parseFloat($(this).find('td:eq(1)').html())!=0  ) {
                inventario += "*" + $(this).find('td:eq(6) ').html();
                request += "*" + $(this).find('td:eq(8) ').html();
                item += "*" + $(this).find('td:eq(7) ').html();
                total += "*" + $(this).find('td:eq(5) input').val();
            } else {
                error++;
            }
         });
        if (error == 0) {
            $.ajax({
                url: '/Trims/guardar_cambios_stock_orden',
                data: "{'pedido':'" + $("#caja_pedido_stock_orden").val() + "','inventario':'" + inventario + "','request':'" + request + "','item':'" + item + "','total':'" + total + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (jsonData) {
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                    $("#caja_pedido_stock_orden").html('');
                    $('#div_tabla_stock_orden').css('visibility', 'hidden');
                    $(".body_tabla_stock_orden").html('');
                    llenar_pedidos_stock_order();
                }
            });
        }else {
            $("#load_trim").css('display', 'none');
            alertify.alert('Error!', 'Check quantities');
            event.preventDefault();
            return false;
        }
    }
/**************************************************************************************************************************************************************************/
    /**************************************************************************************************************************************************************************/
     function llenar_tabla_trims_minimos() {
        $("#load_trim").css('display', 'inline');
        $.ajax({
            url: '/Trims/buscar_trims_tabla_inicio',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td>' + item.item + '</td>';
                    html += '<td>' + item.descripcion + '</td>';
                    html += '<td>' + item.minimo + '</td>';
                    html += '<td>' + item.total + '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_trims_inicio").append(html);
            }
        });
    }
</script>

<style>

    .ui-autocomplete {
        z-index: 2147483647;
    }

    .auditoria {
        border: 0px solid #fff;
        box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.075);
        background: none;
    }
    /***********************************/
    .btn.active {
        background: #2aa52c;
        color: white;
    }

    .btn:active {
        background: #2aa52c;
        color: white;
    }

    .boton_tabla {
    }

        .boton_tabla:hover {
            color: white !important;
            background: #3479bf !important;
            border-radius: 15px;
        }

    input[type=checkbox] {
        /* Double-sized Checkboxes */
        -ms-transform: scale(2); /* IE */
        -moz-transform: scale(2); /* FF */
        -webkit-transform: scale(2); /* Safari and Chrome */
        -o-transform: scale(2); /* Opera */
        padding: 10px;
    }

    /* Might want to wrap a span around your checkbox text */
    .checkboxtext {
        /* Checkbox text */
        font-size: 110%;
        display: inline;
    }

    input[type='radio']:after {
        width: 15px;
        height: 15px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #a7afb5;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 0px solid white;
    }

    input[type='radio']:checked:after {
        width: 15px;
        height: 15px;
        border-radius: 15px;
        top: -2px;
        left: -1px;
        position: relative;
        background-color: #ecaf2d;
        content: '';
        display: inline-block;
        visibility: visible;
        border: 0px solid white;
    }

    .cabecera_tabla2 {
        /*background:#3479bf; #46a772*/
        background: white;
        color: #3479bf;
        pointer-events: none;
        cursor: not-allowed;
    }

    .cabecera_tabla {
        /*background:#3479bf; #46a772*/
        background: #3479bf;
        color: white;
        pointer-events: none;
        cursor: not-allowed;
    }

    .select2-container--default .select2-selection--single {
        display: block !important;
        /*width: 100% !important;*/
        height: 34px !important;
        padding: 6px 12px !important;
        font-size: 14px !important;
        line-height: 1.42857143 !important;
        color: #555 !important;
        background-color: #fff !important;
        background-image: none !important;
        border: 1px solid #ccc !important;
        border-radius: 4px !important;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075) !important;
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075) !important;
        -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s !important;
        -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s !important;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s !important;
    }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            color: #444;
            line-height: 20px;
        }

    .modal-dialog {
        width: 75% !important;
        padding: 2em;
        height: 90% !important;
        min-height: 90% !important;
    }

    .modal-content {
        height: 90% !important;
    }

    .modal-lg {
        max-width: 80% !important;
    }

    a {
        text-decoration: none !important;
    }

    .boton_barra_menu, .btn-info {
        color: #fff;
        background-color: #3479bf !important;
        border-color: #3479bf !important;
    }

    .modal {
        /*z-index: 4 !important;*/
    }

    .dataTables_filter {
    }

    .dropbtn {
        background-color: #3479bf;
        color: white;
        padding: 16px;
        /*padding: 0.40em;*/
        font-size: 18px;
        border: none;
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        color: black;
        min-width: 160px;
        box-shadow: 1px 5px 25px 1px rgba(0,0,0,0.2);
        z-index: 999;
    }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

    .menu {
        background: #3479bf;
        border-radius: 5px;
        border: solid 1px #3479bf;
        margin-bottom: .5em;
        margin: 1em;
    }

    .dropdown-content a:hover {
        /*background-color: #f1f1f1;
        color: black;*/
        background-color: #61b363;
        color: white;
    }

    .dropdown:hover .dropdown-content {
        display: block;
    }


    .modal-header-primary {
        color: #fff;
        padding: 9px 15px;
        border-bottom: 1px solid #eee;
        background-color: #3479bf;
        -webkit-border-top-left-radius: 5px;
        -webkit-border-top-right-radius: 5px;
        -moz-border-radius-topleft: 5px;
        -moz-border-radius-topright: 5px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }

    .x {
        transition: transform .25s ease-in-out;
        color: white !important;
    }

        .x:hover {
            transform: rotate(180deg);
            color: white !important;
        }

        .x:before {
            transform: rotate(45deg);
            transform-origin: center;
        }

        .x:after {
            transform: rotate(-45deg);
            transform-origin: center;
        }

    tr {
        cursor: pointer;
    }
</style>
<input type="hidden" id="id_recibo_hidden">
<input type="hidden" id="total_blanks_hidden">
<input type="hidden" id="id_request_sticker_hidden">
<input type="hidden" id="id_pedido_hidden">
<a id="link_excel_colores" href="@Url.Action("excel_reporte_colores", "Trims")" style="visibility:hidden;">COLORES</a>
<a id="link_excel_lista_stock" href="@Url.Action("lista_stock", "Trims")" style="visibility:hidden;">STOCK</a>

<div id="load_trim" class="load">
    <div id="spinner" class="imagen_loading" style=""></div>
</div>
<div id="espera_t" class="" style="display:none; z-index:999; position:absolute; top:0; left:0; width:100%; height:100%; background:white; opacity:0.6; ">
    <div id="" class="" style="float:left; background-image:url('../../Content/img/gif/preloader.gif'); background-repeat: no-repeat; width:300px; height:160px; position:absolute; left:45%; top:25%; "></div>
    <div id="" class="" style="float:left; font-size:2em; color:#3479bf; top:50%; position:absolute; left:36%; width:100%;">We are making the report, please wait a few seconds</div>
</div>

<div class="container-fluid" style="padding-left:7em; padding-right:3em;">

    @if (ViewBag.usuario == 89 || ViewBag.usuario == 90 || ViewBag.usuario == 91)
    {
        <div class="row" style="margin-left:0px;">
            <div class="menu">
                <div class="dropdown">
                    <button class="dropbtn ">
                        T R I M S
                    </button>
                </div>
                <div class="dropdown">
                    <button class="dropbtn items_catalogue_class" type="button" href="#modal_catalogo" data-toggle="modal">
                        Items
                    </button>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Recibos</button>
                    <div class="dropdown-content">
                        <a href="#modal_recibos_trims" data-toggle="modal" class="btn_nuevo_recibo_trim">Nuevo</a>
                        <a href="#modal_listado_recibos" data-toggle="modal" id="ver_recibos_trim">Reporte</a>
                    </div>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Material</button>
                    <div class="dropdown-content">
                        <a href="#modal_nueva_entrega" data-toggle="modal" id="btn_entrega">Delivery</a>
                        <a href="#modal_lista_entrega" data-toggle="modal" id="btn_lista_entrega">Delivery history</a>
                    </div>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Stock</button>
                    <div class="dropdown-content">
                        <a href="#modal_lista_inventario_trim" data-toggle="modal" class="btn_list_trim">List</a>
                        <a href="#modal_cantidades_stock" data-toggle="modal" class="btn_cantidades_stock">Quantities</a>
                        <a href="#modal_transferencia_trim" data-toggle="modal" class="btn_transferencia_trim">Transfer</a>
                        <a href="#modal_lista_transferencias" data-toggle="modal" class="btn_lista_transferencias">Transfer list</a>
                        <a href="#modal_lista_stock" data-toggle="modal" class="btn_lista_stock">Report</a>
                    </div>
                </div>

            </div>
        </div>
    }
    else
    {
        <div class="row" style="margin-left:0px;">
            <div class="menu">
                <div class="dropdown">
                    <button class="dropbtn ">
                        T R I M S
                    </button>
                </div>
                <div class="dropdown">
                    <button class="dropbtn items_catalogue_class" type="button" href="#modal_catalogo" data-toggle="modal">
                        Items
                    </button>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Receives</button>
                    <div class="dropdown-content">
                        <a href="#modal_recibos_trims" data-toggle="modal" class="btn_nuevo_recibo_trim">New</a>
                        <a href="#modal_listado_recibos" data-toggle="modal" id="ver_recibos_trim">Report</a>
                        <a href="#modal_transfer_stock_order" data-toggle="modal" id="ver_modal_transfer_stock_order">Stock-Order</a>
                        <a href="#modal_transfer_order_stock" data-toggle="modal" id="ver_modal_transfer_order_stock">Order-Stock</a>
                    </div>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Orders</button>
                    <div class="dropdown-content">
                        <a href="#modal_request" data-toggle="modal" id="ver_request">Requests</a>
                        <a href="#modal_lista_stock_orden" data-toggle="modal" class="btn_list_stock_order">Stock & order</a>
                        <a href="#modal_archivo_colores" data-toggle="modal" id="ver_modal_archivo_colores">Report</a>
                    </div>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Material</button>
                    <div class="dropdown-content">
                        <a href="@Url.Action("auditoria", "Trims")" data-toggle="modal">Audit </a>
                        <a href="@Url.Action("entrega", "Trims")" data-toggle="modal">Delivery order </a>
                        <a href="#modal_nueva_entrega" data-toggle="modal" id="btn_entrega">Delivery stock</a>
                        <a href="#modal_lista_entrega" data-toggle="modal" id="btn_lista_entrega">Delivery history</a>
                        <!-- <a href="#modal_separar_cosas" data-toggle="modal" id="btn_auditoria">Audit</a>
                                <a href="#modal_nueva_entrega" data-toggle="modal" id="btn_entrega">Delivery</a>
                        <a href="#modal_lista_entrega" data-toggle="modal" id="btn_lista_entrega">Delivery history</a>-->
                    </div>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Print</button>
                    <div class="dropdown-content">
                        <a href="#modal_comparar_excel" data-toggle="modal" class="btn_subir_archivo">Add price tickets</a>
                        <a href="#modal_buscar_pt" data-toggle="modal" class="btn_buscar_pt">Search price tickets</a>
                        <a href="#modal_ver_pt" data-toggle="modal" class="btn_ver_pt">Orders price tickets</a>
                        <a href="#modal_stickers" data-toggle="modal" class="btn_ver_stickers">Stickers</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href="@Url.Action("packing_instruction","Trims")">
                        <button class="dropbtn" type="button" id="boton_trims">Trim card</button>
                    </a>
                </div>

                <div class="dropdown">
                    <button class="dropbtn">Stock</button>
                    <div class="dropdown-content">
                        <a href="#modal_lista_inventario_trim" data-toggle="modal" class="btn_list_trim">List</a>
                        <a href="#modal_cantidades_stock" data-toggle="modal" class="btn_cantidades_stock">Quantities</a>
                        <a href="#modal_transferencia_trim" data-toggle="modal" class="btn_transferencia_trim">Transfer</a>
                        <a href="#modal_lista_transferencias" data-toggle="modal" class="btn_lista_transferencias">Transfer list</a>
                        <a href="#modal_lista_stock" data-toggle="modal" class="btn_lista_stock">Report</a>
                        <!--<a href="#" onclick="resetear_stock()" class="btnr">Reset</a>-->
                    </div>
                </div>


            </div>
        </div>
    }

    <div class="row" style="height:250px;">
        <div style=" width: 45%; float:left; ">
            <div class="panel" style=" height:250px; width:98%; margin-left:2em; overflow:auto; margin-right:1em;border: 1px solid #3479bf; ">
                <!--<div class="panel-heading"><label class=" col-form-label">Prim guide</label></div>
                <table id="tabla_trims_inicio" class="table table-striped " style=" ">
                    <thead class="cabecera_tabla_trims_inicio cabecera_tabla"><tr><th>AMT</th><th>Description</th><th>Minimum</th><th>Stock</th></thead>
                    <tbody class="body_tabla_trims_inicio"></tbody>
                </table>
                 -->
            </div>
        </div>

        <div class="panel" style="float:right; width: 50%; height:250px; overflow:auto; margin-right:2em;border: 1px solid #3479bf; ">
            <div class="panel-heading"><label class=" col-form-label">To order</label></div>
            <table id="tabla_trims_inicio" class="table table-striped " style=" ">
                <thead class="cabecera_tabla_trims_inicio cabecera_tabla"><tr><th>AMT</th><th>Description</th><th>Minimum</th><th>Stock</th></thead>
                <tbody class="body_tabla_trims_inicio"></tbody>
            </table>
        </div>
    </div>
    <!-- -->
    <div class="row" style="height:300px; width:100%; margin-left: 1em; z-index: 999 !important;">
        <div class="panel" style="float:left; width: 45%; height:295px;  border: 1px solid #3479bf;">
            <div class="panel-heading" style="height:3.2em;">
                <label style="float:left;" class=" col-form-label">Trim status by order</label>
                <input style="float:right;z-index: 999 !important;" type="text" class="form-control validacion " maxlength="30" onkeyup="busqueda_estado_pedido(event)" id="caja_busqueda_estado_pedido">
            </div>
            <table id="" class="table table-striped " style=" z-index: 999 !important;">
                <thead class="cabecera_tabla_ordenes_inicio cabecera_tabla">
                    <tr><th style="width:10%;">#</th><th style="width:15%;">Order</th><th style="width:15%;">Total</th><th style="width:20%;">Total received</th><th style="width:20%;">Status</th><th style="width:20%;"></th>
                </thead>
            </table>
            <div style="height:195px; overflow:auto;z-index: 999 !important;">
                <table id="tabla_ordenes_inicio" class="table table-striped " style=" ">
                    <tbody class="body_tabla_ordenes_inicio"></tbody>
                </table>
            </div>
        </div>

        <div class="panel" style="float:right; width: 52%;height:295px; overflow:auto; border: 1px solid #3479bf; margin-right: 1em;z-index: 999 !important;">
            <div class="panel-heading">
                <label class=" col-form-label">Trim</label>
                <input type="text" style="float:right; width:15%;z-index: 999 !important;" placeholder="DATE" class="form-control must_trans_edit  " onchange="llenar_tabla_trim_recibido_inicio()" id="caja_busqueda_fecha_trim_recibo">
                <input style="float:right; width:20%; margin-right:1em;z-index: 999 !important;" type="text" placeholder="SEARCH" class="form-control validacion " maxlength="30" onkeyup="llenar_tabla_trim_recibido_inicio()" id="caja_busqueda_trim_recibido">
            </div>
            <div style="padding:0px; margin:0px; color:white; background:#3479bf; text-align:center;">
                <label id="mp_numbers_label" class=" col-form-label"></label>
            </div>
            <table id="tabla_trim_recibido" class="table table-striped " style="z-index: 999 !important; ">
                <thead class="cabecera_tabla_trim_recibido cabecera_tabla"><tr><th>#</th><th>Order</th><th>Item</th><th>Date</th><th>Total</th><th>Audited</th></thead>
                <tbody class="body_tabla_trim_recibido"></tbody>
            </table>
        </div>

    </div>

</div>


<div class="modal fade" id="modal_lista_stock_orden" data-target="#modal_lista_stock_orden">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Trims</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <div class="row" id="" style="padding: 0em 2em; ">
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Order</label>
                        <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_pedido_stock_orden"></select>
                    </div>
                </div>
                <div class="row panel" id="div_tabla_stock_orden" style="padding:0em 2em 0em 2em; visibility:hidden; ">

                    <table id="tabla_stock_orden" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla cabecera_tabla_stock_orden">
                            <tr>
                                <th>Description</th>
                                <th>Stock</th>
                                <th>Order</th>
                                <th></th>
                                <th></th>
                                <th>Total</th>
                                <th ></th>
                                <th ></th>
                                <th ></th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody class="body_tabla_stock_orden"></tbody>
                    </table>
                    <button type="button" class="btn btn-success mb-2" id="boton_intercambiar_inventario" onclick="guardar_stock_orden(event)" style=" margin-top:1.5em; float:right; margin-right:2em;">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="modal_nueva_entrega" data-target="#modal_nueva_entrega">
    <div class="modal-dialog" style="width:40% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Add delivery</h4>
            </div>
            <div class="modal-body " style="overflow:auto; padding: 3em;">

                <div class="row" id="" style="">
                    <div id="" class="form-group" style="">
                        <div class="form-group col-md-11 ">
                            <label for="">Deliver </label>
                            <input class="form-control " style="width:100%; " maxlength="200" id="caja_entrega_tc">
                        </div>
                        <div class="form-group col-md-11 ">
                            <label for="">Receive </label>
                            <input class="form-control " style="width:100%; " maxlength="200" id="caja_recibe_tc">
                        </div>
                        <div class="form-group col-md-11 ">
                            <label for="">Date </label>
                            <input class="form-control " style="width:100%; " maxlength="200" id="caja_fecha_tc">
                        </div>
                        <div class="form-group col-md-11 ">
                            <label for=""> </label>
                            <button type="button" class="btn btn-success mb-2" id="boton_edit_img" onclick="guardar_entrega_tc(event)" style=" margin-top:0.3em; float:right; margin-right:2em;">Save</button>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_trim_state" data-target="#modal_trim_state">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="titulo_colores"></h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <div style="height:300px; overflow:auto;">
                    <table id="tabla_trim_state_po" class="fold-table table table-striped table-hover ">
                        <tr>
                            <td class="cabecera_tabla" style="border: none !important;">Customer</td>
                            <td style="border: none !important;"></td>
                            <td class="cabecera_tabla" style="border: none !important;">Ship date</td>
                            <td style="border: none !important;"></td>
                        </tr>
                        <tr>
                            <td class="cabecera_tabla" style="border: none !important;">Gender</td>
                            <td style="border: none !important;"></td>
                            <td class="cabecera_tabla" style="border: none !important;">Packing</td>
                            <td style="border: none !important; font-size: 0.8em;"></td>
                        </tr>
                        <tr>
                            <td class="cabecera_tabla" style="border: none !important;">Fold size</td>
                            <td style="border: none !important;"></td>
                            <td class="cabecera_tabla" style="border: none !important;">Status</td>
                            <td style="border: none !important;"></td>
                        </tr>
                    </table>
                </div>
                <p><label id="usuario_capturo_requests" style="float:right;"></label></p>
                <table id="" class="fold-table table table-striped table-hover " style="margin:0px;">
                    <thead class="cabecera_tabla_trim_state_family" style="background:#3479bf; color:white;">
                        <tr>
                            <th style="width:21%;">Family</th>
                            <th style="width:20%;">Style</th>
                            <th style="width:5%;">Size</th>
                            <th style="width:20%;">Item</th>
                            <th style="width:5%;">Total</th>
                            <th style="width:5%;">Received</th>
                            <th style="width:8%;">MP Number</th>
                            <th style="width:8%;">Receive date</th>
                            <th style="width:8%;"></th>
                        </tr>
                    </thead>
                </table>
                <div style="margin:0px; height:450px; overflow:auto; border: solid 2px #3479bf; border-radius: 5px; border-top: none;">
                    <table id="tabla_trim_state_family" class="fold-table table table-striped table-hover ">
                        <tbody class="rows_tabla_trim_state_family"></tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_lista_entrega" data-target="#modal_lista_entrega">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>Delivery list</strong></h4>
            </div>
            <div class="modal-body " style="overflow:auto; ">

                <div class="row">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_entrega">Order </label><br />
                            <select class="form-control js-example-basic-single " style="width:100%;" id="caja_pedido_lista_entrega"></select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">From </label>
                            <input type="text" class=" form-control validacion entrega_item" maxlength="150" id="caja_inicio_lista_entrega">
                        </div>
                        <div class="form-group col-sm-2  ">
                            <label class=" col-form-label">To </label>
                            <input type="text" class=" form-control validacion entrega_item" maxlength="150" id="caja_final_lista_entrega">
                        </div>
                        <div class="form-group col-md-1 stock_entrega">
                            <label for="caja_request_entrega"> </label>
                            <button type="button" class="btn btn-success mb-2" onclick="buscar_entregas_por_fechas()" style="margin-top: 0.3em;">Search by dates</button>
                        </div>
                    </div>
                </div>

                <table id="tabla_lista_entregas" class="fold-table table table-striped table-hover " style="margin-top:2em;">
                    <thead class="cabecera_tabla_lista_entregas" style="background:#3479bf; color:white;pointer-events: none;">
                        <tr>
                            <th></th>
                            <th>Date</th>
                            <th>From</th>
                            <th>To</th>
                            <th>Item</th>
                            <th>Order</th>
                            <th>Total</th>
                            <th>Remaining</th>
                            <th>Comments</th>
                            <th>Return</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody class="rows_tabla_lista_entregas"></tbody>
                </table>

                <div style="width:50em; height:26em; position:absolute; top:45%; left:30%; display:none;background: white;border-radius: 5px; border: 2px #3c763d solid;" id="div_return_items">
                    <div class="row" style=" padding:2em 2em 0em 2em; ">
                        <h4 style="">Return </h4>
                        <div class="form-group">
                            <div class="form-group col-sm-1" style="float:right;">
                                <button type="button" class="btn btn-danger mb-2" onclick="cerrar_div_return_items()" style=" margin-top:1.5em;">X</button>
                            </div>
                            <input type="hidden" id="hidden_id_request_return">
                            <input type="hidden" id="hidden_id_entrega_return">
                            <input type="hidden" id="hidden_total_original_return">
                            <div class="form-group col-sm-12 ">
                                <label class=" col-form-label">Item</label>
                                <input readonly type="text" style="width:200%;" class=" form-control validacion " maxlength="30" id="etiqueta_item_return">
                            </div>
                            <div class="form-group col-sm-12 ">
                                <label class=" col-form-label">Delivered</label>
                                <input readonly type="text" style="width:200%;" class=" form-control validacion " maxlength="30" id="caja_total_return">
                            </div>
                            <div class="form-group col-sm-3 ">
                                <label class=" col-form-label">Total to return</label>
                                <input type="text" class=" form-control validacion " maxlength="30" id="caja_total_nuevo_return">
                            </div>
                            <div class="form-group col-sm-1">
                                <button type="button" class="btn btn-success mb-2" onclick="return_item(event)" style=" margin-top:1.5em;  margin-right:2em;">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_nueva_entrega" data-target="#modal_nueva_entrega">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>New delivery</strong></h4>
            </div>
            <div class="modal-body " style="overflow:auto; ">

                <div class="row">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_entrega">Order </label><br />
                            <select class="form-control js-example-basic-single " style="width:100%;" id="caja_pedido_entrega"></select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Deliver </label>
                            <input type="text" class=" form-control validacion entrega_item" maxlength="150" id="caja_nombre_entrega">
                        </div>
                        <div class="form-group col-sm-2  ">
                            <label class=" col-form-label">Receive </label>
                            <input type="text" class=" form-control validacion entrega_item" maxlength="150" id="caja_nombre_recibe">
                        </div>
                        <div class=" stock_entrega col-md-6">
                            <div class="form-group" style="padding-left:0px; ">
                                <div class="form-group col-md-10 stock_entrega">
                                    <label for="caja_request_entrega">Item </label>
                                    <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_stock_entrega"></select>
                                </div>
                                <div class="form-group col-md-1 stock_entrega">
                                    <label for="caja_request_entrega"> </label>
                                    <button type="button" class="btn btn-success mb-2" onclick="agregar_stock_nueva_entrega()" style="margin-top: 0.3em;">Add</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <table id="tabla_nueva_entrega" class="fold-table table table-striped table-hover " style="margin-top:2em;">
                    <thead class="cabecera_tabla_nueva_entrega" style="background:#3479bf; color:white;pointer-events: none;">
                        <tr>
                            <th>Item</th>
                            <th>Style</th>
                            <th>Size</th>
                            <th>Order </th>
                            <th>Total </th>
                            <th>Comments</th>
                            <th></th><!--BORRAR-->
                            <th></th><!--INVENTARIO-->
                            <th></th><!--PEDIDO-->
                            <th></th><!--TRIM-ORDER-->
                            <th></th><!--REQUEST-->
                        </tr>
                    </thead>
                    <tbody class="rows_tabla_nueva_entrega"></tbody>
                </table>
                <button type="button" class="btn btn-success mb-2" id="boton_guardar_entrega" onclick="guardar_entrega(event)" style="margin-top:0.3em; float:right; margin-right:2em;">Save</button>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_separar_cosas" data-target="#modal_separar_cosas">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong></h4>
            </div>
            <div class="modal-body " style="overflow:auto; ">


                <div class="row ">
                    <div class="form-group" style="padding-left:0px; ">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_audit">Order </label>
                            <select class="form-control js-example-basic-single  " style="width:100%; " id="caja_pedido_audit"></select>
                        </div>
                        <div class="form-group col-md-3 ">
                            <label for="caja_stock_tso">Item </label>
                            <select class="form-control " style="width:100%;  " id="caja_items_audit"></select>
                        </div>
                        <div class="form-group col-md-3 ">
                            <label for="caja_stock_tso">Style </label>
                            <select class="form-control " style="width:100%;  " id="caja_estilo_audit">
                                <option value="0">ALL</option>
                            </select>
                        </div>
                        <div class="form-group col-md-1 ">
                            <label for="caja_stock_tso">Size </label>
                            <select class="form-control " style="width:100%;  " id="caja_talla_audit">
                                <option value="0">ALL</option>
                            </select>
                        </div>
                        <div class="form-group col-md-3 ">
                            <label for="caja_request_entrega"> </label>
                            <button type="button" class="btn btn-success mb-2" onclick="add_trim_orden_row()" style="margin-top: 1.7em;">Add</button>
                        </div>
                    </div>
                </div>

                <div id="div_ordenes_dos_semanas" class="row" style="cursor: pointer;">


                </div>

                <div id="div_tabla_trims_ordenes" class="row" style="padding: 1em; visibility:hidden;">
                    <table id="tabla_trims_ordenes" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_trans_orden_stock" style="background:#3479bf; color:white;">
                            <tr><th>User</th><th>Po</th><th>Item</th><th>Style</th><th>Size</th><th>Total</th><th>Branch</th><th>Location</th><th></th><th></th></tr>
                        </thead>
                        <tbody class="rows_tabla_trims_ordenes"></tbody>
                    </table>
                    <button type="button" class="btn btn-warning mb-2" onclick="guardar_auditoria(event)" style="float:right;margin-top: 1.7em;">Save</button>
                </div>



            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_transfer_order_stock" data-target="#modal_transfer_order_stock">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Order to stock</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row ">
                    <div class="form-group" style="padding-left:0px; ">
                        <div class="form-group col-md-3 ">
                            <label for="caja_stock_tso">Order </label>
                            <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_pedido_tos"></select>
                        </div>
                        <div class="form-group col-md-3 ">
                            <label for="caja_stock_tso">Item </label>
                            <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_items_pedido_tos"></select>
                        </div>
                        <div class="form-group col-md-3 ">
                            <label for="caja_request_entrega"> </label>
                            <button type="button" class="btn btn-success mb-2" onclick="add_trim_tos()" style="margin-top: 1.7em;">Add</button>
                        </div>
                    </div>
                </div>

                <div class="row" style="padding: 1em;">
                    <table id="tabla_trans_orden_stock" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_trans_orden_stock" style="background:#3479bf; color:white;">
                            <tr><th>#</th><th>Item</th><th>Order</th><th>Stock</th><th>Total</th><th>Branch</th><th>Location</th><th></th></tr>
                        </thead>
                        <tbody class="rows_tabla_trans_orden_stock"></tbody>
                    </table>
                    <button type="button" class="btn btn-warning mb-2" onclick="guardar_tos(event)" style="float:right;margin-top: 1.7em;">Save</button>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_transfer_stock_order" data-target="#modal_transfer_stock_order">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Stock to order</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row ">
                    <div class="form-group" style="padding-left:0px; ">
                        <div class="form-group col-md-3 ">
                            <label for="caja_stock_tso">Item </label>
                            <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_stock_tso"></select>
                        </div>
                        <div class="form-group col-md-3 ">
                            <label for="caja_request_entrega"> </label>
                            <button type="button" class="btn btn-success mb-2" onclick="add_trim_tso()" style="margin-top: 1.7em;">Add</button>
                        </div>
                    </div>
                </div>

                <div class="row" style="padding: 1em;">
                    <table id="tabla_trans_stock_orden" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_trans_stock_orden" style="background:#3479bf; color:white;">
                            <tr><th>#</th><th>Item</th><th>Stock</th><th>Order</th><th>Total</th><th></th></tr>
                        </thead>
                        <tbody class="rows_tabla_trans_stock_orden"></tbody>
                    </table>
                    <button type="button" class="btn btn-warning mb-2" onclick="guardar_tso(event)" style=" float:right; margin-top:1.7em;">Save</button>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_ver_pt" data-target="#modal_ver_pt">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Orders price tickets</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <h4 id=""><span class="glyphicon glyphicon-check" aria-hidden="true"></span> Mark price tickets as printed </h4>
                <div id="div_tabla_order_price_ticket" class="row" style=" padding: 1em; height:40em; overflow:auto;">

                    <table id="tabla_order_price_ticket" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_order_price_ticket" style="background:#3479bf; color:white;">
                            <tr><th style="width:15em;">Order</th><th style="width:10em;">Customer</th><th style="width:30em;">Style</th><th>Sizes</th></tr>
                        </thead>
                        <tbody class="rows_tabla_order_price_ticket"></tbody>
                    </table>

                </div>
                <button type="button" class="btn btn-warning" onclick="obtener_datos_pt(event)" id="btn_marcar_pt" style="visibility:hidden; float: right; margin: 1em; ">Save</button>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_lista_stock" data-target="#modal_lista_stock">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:40% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>Stock list</strong></h4>
            </div>

            <div class="row" id="" style=" padding:2em 2em 0em 2em; ">
                <div class="form-group">

                    <div class="form-group col-sm-3 ">
                        <label class=" col-form-label">Branch</label>
                        <select class="form-control   " style="width:100%;  " id="caja_sucursal_stock_list">
                            <option value="SELECT">SELECT</option>
                            <option value="0">ALL</option>
                            <option value="1">FORTUNE</option>
                            <option value="2">LUCKY 1</option>
                            <option value="3">LUCKY 2</option>
                        </select>
                    </div>
                    <div class="form-group col-sm-3 ">
                        <label class=" col-form-label">Location</label>
                        <select class="form-control   " style="width:100%;  " id="caja_location_stock_list">
                        </select>
                    </div>

                    <div class="form-group col-sm-3 ">
                        <br />
                        <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="ver_reporte_stock(event)" data-toggle="modal">Report</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_lista_transferencias" data-target="#modal_lista_transferencias">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Stock</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" id="" style="padding: 0em 2em; ">
                    <div class="form-group col-sm-2 ">
                        <label for="caja_inicio" class=" col-form-label ">From </label>
                        <input type="text" class="form-control order " placeholder="SELECT DATE" maxlength="10" id="caja_inicio_transfer">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label for="caja_final" class=" col-form-label ">To </label>
                        <input type="text" class="form-control order " placeholder="SELECT DATE" maxlength="10" id="caja_final_transfer">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label"></label>
                        <button type="button" class="btn btn-success mb-2 " onclick="buscar_transferencias()" style=" margin-top:1.5em;  margin-right:2em;">Search</button>
                    </div>
                </div>
                <div class="row panel" style="padding: 0em 2em;">
                    <table id="tabla_transferencias" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla cabecera_transferencias">
                            <tr>
                                <th>Date</th>
                                <th>User</th>
                                <th>Item</th>
                                <th>Total</th>
                                <th>Branch</th>
                                <th>Location</th>
                                <th>Order</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody class="body_transferencias"></tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_transferencia_trim" data-target="#modal_transferencia_trim">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Stock</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" id="" style="padding: 0em 2em; ">
                    <div class="form-group col-sm-4 ">
                        <label class=" col-form-label">Item</label>
                        <select class="form-control js-example-basic-single  " style="width:100%; " id="caja_stock_transfer"></select>
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label"></label>
                        <button type="button" class="btn btn-success mb-2 glyphicon glyphicon-plus" onclick="agregar_transferencia()" style=" margin-top:1.5em;  margin-right:2em;"></button>
                    </div>
                </div>
                <div class="row panel" style="padding: 0em 2em;">
                    <table id="tabla_transferencia_trim" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla cabecera_tabla_stock_orden">
                            <tr>
                                <th>#</th>
                                <th>Description</th>
                                <th>Branch</th>
                                <th>Location</th>
                                <th>Total</th>
                                <th>New branch</th>
                                <th>New location </th>
                                <th>New total</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody class="body_transferencia_trim"></tbody>
                    </table>
                    <button type="button" class="btn btn-success mb-2" onclick="guardar_transferencia_trims(event)" style=" margin-top:1.5em; float: right; margin-right:2em;">Save</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_cantidades_stock" data-target="#modal_cantidades_stock">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Stock</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row panel" style="padding: 0em 2em;">
                    <table id="tabla_cambiar_cantidades_stock" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla cabecera_tabla_stock_orden">
                            <tr>
                                <th>#</th>
                                <th>Description</th>
                                <th>Branch</th>
                                <th>Location</th>
                                <th>Total</th>
                                <th>New total</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody class="body_tabla_cambiar_cantidades_stock"></tbody>
                    </table>
                    <button type="button" class="btn btn-success mb-2" onclick="guardar_cambio_cantidades_stock(event)" style=" margin-top:1.5em; float: right; margin-right:2em;">Save</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_lista_inventario_trim" data-target="#modal_lista_inventario_trim">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Trims</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div class="row" id="" style=" padding:0em 2em 0em 2em; ">
                    <div class="form-group">
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Description </label>
                            <input type="text" placeholder="DESCRIPTION" class=" form-control validacion " onkeyup="buscar_inventario_tabla_trims(event)" maxlength="30" id="caja_busqueda_trim_inventario">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Family </label>
                            <input type="text" placeholder="FAMILY" class=" form-control validacion " onkeyup="buscar_inventario_tabla_trims(event)" maxlength="30" id="caja_busqueda_familia_trim_inventario">
                        </div>

                    </div>
                </div>
                <div class="row panel" id=" " style="height:500px; padding:0em 2em 0em 2em; ">
                    <div style=" ">
                        <table id="" class="table table-striped " style="margin:0px; ">
                            <thead class="cabecera_tabla">
                                <tr>
                                    <th style="width:5%;">#</th>
                                    <th style="width:25%;">Description</th>
                                    <th style="width:10%;">Total</th>
                                    <th style="width:10%">Order</th>
                                    <th style="width:10%;">Family</th>
                                    <th style="width:10%;">Customer</th>
                                    <th style="width:10%;">Branch</th>
                                    <th style="width:11%;">Location</th>
                                    <th style="width:3%;"></th>
                                    <th style="width:3%;"></th>
                                    <th style="width:3%;"></th>
                                </tr>
                            </thead>
                        </table>
                        <div style="margin:0px; height:400px; overflow:auto; border: 2px solid #3479bf; border-top:none; border-radius: 5px; ">
                            <table id="tabla_trims_lista_inventario" class="table table-striped ">
                                <tbody class="body_tabla_trims_lista_inventario"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row" id="div_cambiar_lugar" style=" padding:0em 2em 0em 2em; display:none; ">
                    <h4 style="">Edit location </h4>
                    <div class="form-group">
                        <div class="form-group col-sm-1">
                            <button type="button" class="btn btn-danger mb-2" onclick="cerrar_div_cambiar_lugar()" style=" margin-top:1.5em;">X</button>
                        </div>
                        <input type="hidden" id="hidden_id_inventario_location">
                        <div class="form-group col-sm-3 ">
                            <label class=" col-form-label">Item</label>
                            <input readonly type="text" style="" class=" form-control validacion " maxlength="30" id="etiqueta_item_edicion_location">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Location</label>
                            <input readonly type="text" style="" class=" form-control validacion " maxlength="30" id="caja_lugar_actual">
                        </div>
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Total</label>
                            <input readonly type="text" class=" form-control validacion " maxlength="30" id="caja_total_lugar_actual">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">New Location</label>

                            <select class="form-control js-example-basic-single " style="width:100%;" id="caja_lugar_nuevo"></select>
                            <!--<input type="text" class=" form-control validacion " maxlength="30" id="caja_lugar_nuevo">-->
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Total</label>
                            <input type="text" class=" form-control numeric " maxlength="30" id="caja_total_lugar_nuevo">
                        </div>
                        <div class="form-group col-sm-1">
                            <button type="button" class="btn btn-success mb-2" onclick="cambiar_locacion_inventario(event)" style=" margin-top:1.5em;  margin-right:2em;">Save</button>
                        </div>
                    </div>
                    <br />
                </div>
                <div class="row" id="div_editar_inventario" style=" padding:0em 2em 0em 2em; display:none; ">
                    <h4 id="letrero_cambio" style="">Edit </h4>
                    <div class="form-group">
                        <div class="form-group col-sm-1">
                            <button type="button" class="btn btn-danger mb-2" onclick="cerrar_div_edicion_inventario()" style=" margin-top:1.5em;">X</button>
                        </div>
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Id</label>
                            <input readonly type="text" class=" form-control validacion " id="caja_id_inventario_trim_ed">
                        </div>
                        <div class="form-group col-sm-3 ">
                            <label class=" col-form-label">Item</label>
                            <input readonly type="text" style="width:200%;" class=" form-control validacion " maxlength="30" id="etiqueta_item_cambiar_ed">
                        </div>
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Quantity</label>
                            <input type="text" class=" form-control validacion " maxlength="30" id="caja_cantidad_cambio_trim_inventario_ed">
                        </div>
                        <div class="form-group col-sm-1">
                            <button type="button" class="btn btn-success mb-2" id="boton_intercambiar_inventario" onclick="editar_inventario_trims(event)" style=" margin-top:1.5em;  margin-right:2em;">Save</button>
                        </div>
                    </div>
                    <br />
                </div>
                <div class="row" id="div_cambiar_inventario" style=" padding:0em 2em 0em 2em; visibility:hidden; ">
                    <h3 id="letrero_cambio" style="">
                        Items change  <button type="button" class="btn btn-danger mb-2" id="boton_cerrar_cambio" onclick="cerrar_div_cambio_inventario()" style="">X</button>
                    </h3>
                    <div class="form-group">
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Id</label>
                            <input readonly type="text" class=" form-control validacion " id="caja_id_inventario_trim">
                        </div>
                        <div class="form-group col-sm-3 ">
                            <label class=" col-form-label">Item</label>
                            <input readonly type="text" style="width:200%;" class=" form-control validacion " maxlength="30" id="etiqueta_item_cambiar">
                        </div>
                        <div class="form-group col-sm-1 ">
                            <label class=" col-form-label">Quantity</label>
                            <input type="text" class=" form-control validacion " maxlength="30" id="caja_cantidad_cambio_trim_inventario">
                        </div>
                        <div id="div_pedido_inventario_trim" class="form-group col-sm-2 " style="visibility:hidden;">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_inventario_trims " style="width:100%;  " id="caja_pedido_inventario"></select>
                        </div>

                        <div class="form-group col-sm-1">
                            <button type="button" class="btn btn-success mb-2" id="boton_intercambiar_inventario" onclick="cambiar_inventario_trims(event)" style=" margin-top:1.5em;  margin-right:2em;">Save</button>
                        </div>
                    </div>
                    <br />
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_stickers" data-target="#modal_stickers">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Stickers</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div id="div_buscar_p_t" class="form-group" style="">

                    <div class="form-group col-md-2 ">
                        <label for="caja_pedido_buscar_price_ticket">Order </label>
                        <select class="form-control js-example-basic-single pedidos_buscar_stickers" style="width:100%;  " id="caja_pedido_buscar_stickers"></select>
                    </div>
                </div>
                <br />
                <div id="div_tabla_stickers" class="row" style="visibility:hidden; padding: 1em; ">
                    <h3 id="titulo_stickers"> </h3>
                    <table id="tabla_stickers" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_stickers" style="background:#3479bf; color:white;">
                            <tr>

                                <th>Family</th>
                                <th>Item</th>
                                <th>Style</th>
                                <th>Description</th>
                                <th>Size</th>
                                <th>Printed</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody class="rows_tabla_stickers"></tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_buscar_pt" data-target="#modal_buscar_pt">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">Search price tickets</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">

                <div id="div_buscar_p_t" class="form-group" style="">
                    <h4>Select order</h4>
                    <div class="form-group col-md-2 ">
                        <label for="caja_pedido_buscar_price_ticket">Order </label>
                        <select class="form-control js-example-basic-single pedidos_buscar_pt" style="width:100%;  " id="caja_pedido_buscar_price_ticket"></select>
                    </div>
                </div>
                <br />
                <div id="div_tabla_buscar_price_ticket" class="row" style="visibility:hidden; padding: 1em; ">
                    <h3 id="titulo_buscar_price_tickets"> </h3>
                    <table id="tabla_buscar_price_ticket" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_buscar_price_ticket" style="background:#3479bf; color:white;">
                            <tr>
                                <th>#</th>
                                <th>PO</th>
                                <th>Style</th>
                                <th>UPC</th>
                                <th>Description</th>
                                <th>Color</th>
                                <th>Size</th>
                                <th>Tickets</th>
                                <th>Dept</th>
                                <th>Class</th>
                                <th>Sub</th>
                                <th>Retail</th>
                                <th>Cl</th>
                                <th>Register date</th>
                                <th>User</th>
                                <th>Printed</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody class="rows_tabla_buscar_price_ticket"></tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_comparar_excel" data-target="#modal_comparar_excel">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_comparacion_excel" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="">New price tickets</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">


                <div id="div_formulario_archivo" class="form-group" style="display:inline;">
                    <h3>Upload file </h3>
                    <div class="form-group col-md-2 ">
                        <label for="caja_pedido_subir_archivos">Order </label>
                        <select class="form-control js-example-basic-single pedidos_subir_archivos" style="width:100%;  " id="caja_pedido_subir_archivos"></select>
                    </div>
                    <div class="form-group col-md-2 ">
                        <input type="file" class="custom-file-input" id="FileUpload1" style=" float:left; margin-right:1em; padding-top:2em;" />
                    </div>
                    <div class="form-group col-md-2 ">
                        <br />
                        <!--<input type="button" class="btn btn-warning " id="btnUpload" value="Upload File" style="margin-top:1.5em;" />-->
                        <button type="button" class="btn btn-warning" id="btnUpload" style=" ">Upload</button>
                    </div>
                </div>

                <div id="div_tabla_price_ticket" class="row" style="visibility:hidden; padding: 1em; ">
                    <div>
                        <div style="float:left;">
                            <h3 id="titulo_pedido_price_tickets"> </h3>
                        </div>
                        <div style="float:left; padding-top:1.6em; margin-left:2em;">
                            <input type="checkbox" id="caja_impreso" /> <span class="checkboxtext"> &nbsp;&nbsp;Mark as printed </span>
                        </div>
                    </div>

                    <table id="tabla_price_ticket" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_price_ticket" style="background:#3479bf; color:white;">
                            <tr>
                                <th>#</th>
                                <th>State</th>
                                <th>PO</th>
                                <th>Style</th>
                                <th>UPC</th>
                                <th>Description</th>
                                <th>Color</th>
                                <th>Size</th>
                                <th>Tickets</th>
                                <th>Dept</th>
                                <th>Class</th>
                                <th>Sub</th>
                                <th>Reail</th>
                                <th>Cl</th>
                            </tr>
                        </thead>
                        <tbody class="rows_tabla_price_ticket"></tbody>
                    </table>
                    <div class="form-group">
                        <div class="form-group col-1">
                            <br />
                            <button type="button" class="btn btn-danger mb-2 " id="boton_back_pt" style=" float:right;margin-right:2em;">Return</button>
                        </div>
                        <div class="form-group col-1">
                            <br />
                            <button type="button" class="btn btn-success mb-2" id="boton_guardar_informacion" onclick="guardar_price_tickets(event)" style=" margin-top:0.3em;float:right;margin-right:2em;">Save</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_archivo_colores" data-target="#modal_archivo_colores">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>States</strong></h4>
            </div>

            <div class="row" id="" style=" padding:2em 2em 0em 2em; ">
                <div class="form-group">
                    <div class="form-group col-sm-2">
                        <label for="caja_pedido_request">Order </label>
                        <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_pedido_reporte_colores"></select>
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">State</label>
                        <select class="form-control   " style="width:100%;  " id="caja_estado_reporte_colores">
                            <option value="0">All</option>
                            <option value="1">Open</option>
                            <option value="2">Closed</option>
                            <option value="3">Canceled</option>
                        </select>
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Customer</label>
                        <select class="form-control  cliente_recibo_trims " style="width:100%;  " id="caja_cliente_reporte_colores">
                            <option value="0">All</option>
                            <option value="1">Mad Engine</option>
                            <option value="2">Fantasy</option>
                            <option value="3">Fortune</option>
                        </select>
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">From</label>
                        <input type="text" autocomplete="false" style="" placeholder="FROM" class="form-control must_trans_edit  " maxlength="10" id="caja_inicio_colores">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">To</label>
                        <input style="" autocomplete="false" type="text" placeholder="TO" class="form-control validacion " maxlength="10" id="caja_final_colores">
                    </div>

                    <div class="form-group col-sm-2 ">
                        <br />
                        <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="enviar_datos_reporte_colores()" data-toggle="modal">Report</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_request" data-target="#modal_request">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Material request</h4>
            </div>
            <div class="modal-body " style="overflow:auto;">
                <div class="row" style="">
                    <div class="form-group">
                        <div class="form-group col-md-2 ">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_request " style="width:100%;  " id="caja_pedido_request"></select>
                        </div>
                        <div class="form-group col-md-3" id="div_estilos_request" style="display:none;"></div>
                        <div class="form-group col-md-2" id="div_tallas_request" style="display:none;"></div>
                        <div class="form-group col-md-3" id="div_item_request" style="visibility:hidden;">
                            <label for="caja_item_request">Item </label>
                            <select class="form-control js-example-basic-single items_request " multiple style="width:100%; " id="caja_item_request"></select>
                        </div>
                        <div class="form-group col-1" id="div_button_add" style="visibility:hidden;">
                            <br />
                            <button type="button" class="btn btn-success mb-2" id="boton_agregar_item_tabla" onclick="agregar_item_tablas()" style="margin-top:0.3em;">Add</button>
                        </div>
                    </div>
                </div>
                <div class="row" id="div_tabla_trim_seleccionado" style="display:none;">
                    <div class="form-group">
                        <div class="form-group col-md-3">
                            <label for="caja_fold_size_tc">Fold size </label>
                            <input type="text" class="form-control validacion" style="width:100%; " id="caja_fold_size_trim" />
                        </div>
                        <div class="form-group col-md-3">
                            <label for="caja_hang_size_trim">Hang size </label>
                            <input type="text" class="form-control validacion" style="width:100%; " id="caja_hang_size_trim" />
                        </div>
                        <div class="form-group col-md-3" style="padding-top: 0.60em;">
                            <br />
                            <input type="checkbox" id="caja_instruccion_empaque_cb" style="margin-left:1em;" /> <span class="checkboxtext"> &nbsp;&nbsp;Packing intruction arrived </span>
                        </div>
                        <div class="form-group col-md-3">
                            <label for="caja_hang_size_trim">State </label>
                            <select class="form-control " style="width:100%; " id="caja_estado_request">
                                <option value="1">Open</option>
                                <option value="2">Closed</option>
                                <option value="3">Canceled</option>
                            </select>
                        </div>
                    </div>

                    <h4 style="border-bottom: solid 1px #3c763d;color: #3c763d; font-weight: bold; margin-top: 5em;">Trims</h4>
                    <div style="height:200px; overflow:auto; ">
                        <table id="tabla_trim_seleccionado" class="table table-striped ">
                            <thead><tr><th>Style</th><th>Trim</th><th>Quantity</th><th>Blank</th><th>Total</th><th></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th></tr></thead>
                            <tbody class="body_tabla_trim_seleccionado"></tbody>
                        </table>
                    </div>
                </div>
                <div class="row" id="div_tabla_cajas_seleccionadas" style="display:none;">
                    <h4 style="border-bottom: solid 1px #3c763d; color: #3c763d; font-weight: bold;">Boxes</h4>
                    <div style="height:200px; overflow:auto;">
                        <table id="tabla_cajas_seleccionadas" class="table table-striped ">
                            <thead><tr><th>Style</th><th>Box</th><th>Quantity</th><th></th><th style="visibility:hidden; width:.5em;"></th><th style="visibility:hidden;width:.5em;"></th></tr></thead>
                            <tbody class="body_tabla_cajas_seleccionadas"></tbody>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_request" onclick="guardar_request(event)" style="display:none; margin-top:0.3em; float:right; margin-right:2em;">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_editar_recibo_trims" data-target="#modal_editar_recibo_trims">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Edit receive</h4>
            </div>
            <div class="modal-body " style="overflow:auto; height:57em;">

                <div class="row" id="" style=" padding:0em 2em 0em 2em; ">
                    <div class="form-group">
                        <div class="form-group col-sm-2">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single check_rec_trim_edit " style="width:100%;  " id="caja_pedido_recibo_edit"></select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">MP </label>
                            <input type="text" class=" form-control validacion check_rec_trim_edit" maxlength="30" id="caja_mp_recibo_edit">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Mill PO </label>
                            <input type="text" class=" form-control validacion check_rec_trim_edit" maxlength="30" id="caja_millpo_recibo_edit">
                        </div>

                        <div class="form-group col-sm-2 ">
                            <label for="caja_date_trans" class=" col-form-label  ">Date </label>
                            <input type="text" class="form-control check_rec_trim_edit" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_fecha_recibo_edit">
                        </div>
                        <div class="form-group col-sm-4 ">
                            <label for="caja_comentarios_recibo" class=" col-form-label">Comments</label>
                            <input type="text" class=" form-control validacion " maxlength="500" id="caja_comentarios_recibo_edit">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Customer</label>
                            <select class="form-control  cliente_recibo_trims " style="width:100%;  " id="caja_cliente_recibo_edit">
                                <option value="1">MDE</option>
                                <option value="2">FANTASY</option>
                                <option value="3">FORTUNE</option>
                            </select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Branch</label>
                            <select class="form-control   " style="width:100%;  " id="caja_sucursal_recibo_edit">
                                <option value="1">Fortune</option>
                                <option value="2">Lucky</option>
                                <option value="3">Lucky 2</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row panel" id="div_busqueda " style="height:350px; padding:0em 2em 0em 2em;margin-top:1em;">
                    <div class="panel-heading " tyle="padding-bottom: 1.5em;">
                        <label>Search trim</label>
                        <input style="float:right; " type="text" class=" form-control validacion " placeholder="SEARCH" onkeyup="llenar_tabla_items_edit()" id="caja_busqueda_recibo_trims_edit">
                    </div>

                    <div style=" ">
                        <table id="" class="table table-striped " style="margin:0px; ">
                            <thead class="cabecera_tabla"><tr><th style="width:6em;">#</th><th style="width:10em;">AMT</th><th style="width:20em;">Description</th><th style="width:6em;">Family</th></tr></thead>
                        </table>
                        <div style="margin:0px; height:260px; overflow:auto; border: 2px solid #3479bf; border-top:none; border-radius: 5px; ">
                            <table id="tabla_trims_recibos_temporal_edit" class="table table-striped ">
                                <tbody class="body_tabla_trims_recibos_temporal_edit"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row panel" id="div_tabla_trims_recibos_edit" style="visibility:hidden; padding:2em; padding-top:0px; height:360px; border-radius: 5px;">
                    <h4>Items</h4>
                    <table id="" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla">
                            <tr>
                                <th style="width:10%;">#</th>
                                <th style="width:15%;">AMT</th>
                                <th style="width:40%;">Trim</th>
                                <th style="width:15%;">Ubication</th>
                                <th style="width:15%;">Quantity</th>
                                <th style="width:5%;"></th>
                            </tr>
                        </thead>
                    </table>
                    <div style="margin:0px; height:260px; overflow:auto; border: 2px solid #3479bf; border-top:none;">
                        <table id="tabla_trims_recibos_edit" class="table table-striped ">
                            <tbody class="body_tabla_trims_recibos_edit"></tbody>
                        </table>
                    </div>
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_recibo_trims_edit" onclick="guardar_recibo_trims_edit(event)" style=" margin-top:0.3em; float:right; margin-right:2em;">Save</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_listado_recibos" data-target="#modal_listado_recibos">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Receives and details</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_listado_recibos">


                <div class="row" id="" style="padding:1em; ">
                    <div class="form-group col-sm-3 ">
                        <label for="caja_inicio" class=" col-form-label ">Search</label>
                        <input type="text" class="form-control validacion " maxlength="30" id="caja_busqueda_recibo_trim">

                    </div>
                    <div class="form-group col-sm-3 ">
                        <label for="caja_inicio" class=" col-form-label ">From this date</label>
                        <input type="text" class="form-control order " maxlength="23" id="caja_inicio">
                    </div>
                    <div class="form-group col-sm-3 ">
                        <label for="caja_final" class=" col-form-label ">To this date</label>
                        <input type="text" class="form-control order " maxlength="23" id="caja_final">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <br />
                        <button type="button" style="margin-top: 0.1em; " class="btn btn-sm btn-success" onclick="buscar_recibos_fechas(event)" data-toggle="modal">Search</button>
                    </div>
                </div>
                <div class="panel" style="border:2px solid #3479bf; max-height:500px; ">
                    <table id="" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_recibos_trim" style="background:#3479bf; color:white;">
                            <tr>
                                <th style="width:5%;">#</th>
                                <th style="width:10%;">DATE</th>
                                <th style="width:10%;">MP</th>
                                <th style="width:15%;">MILL PO</th>
                                <th style="width:10%;">ORDER</th>
                                <th style="width:10%;">BRANCH</th>
                                <th style="width:25%;">ITEMS</th>
                                <th style="width:10%;">TOTAL</th>
                                <th style="width:5%;"></th>
                            </tr>
                        </thead>
                    </table>
                    <div style="overflow:auto; max-height: 450px;">
                        <table id="tabla_recibos_trim" class="fold-table table table-striped table-hover ">
                            <tbody class="rows_tabla_recibos_trim"></tbody>
                        </table>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_recibos_trims" data-target="#modal_recibos_trims">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_material_request" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>New Receive</h4>
            </div>
            <div class="modal-body " style="overflow:auto; height: 57em;">

                <div class="row" id="" style=" padding:0em 2em 0em 2em; ">
                    <div class="form-group">
                        <div class="form-group col-sm-2 ">
                            <label for="caja_pedido_request">Order </label>
                            <select class="form-control js-example-basic-single pedidos_recibo_trims " style="width:100%;  " id="caja_pedido_recibo"></select>
                        </div>

                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">MP </label>
                            <input type="text" class=" form-control validacion check_rec_trim" maxlength="30" id="caja_mp_recibo">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Mill PO </label>
                            <input type="text" class=" form-control validacion check_rec_trim" maxlength="30" id="caja_millpo_recibo">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label for="caja_date_trans" class=" col-form-label  ">Date </label>
                            <input type="text" class="form-control check_rec_trim" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_fecha_recibo">
                        </div>
                        <div class="form-group col-sm-4 ">
                            <label for="caja_comentarios_recibo" class=" col-form-label">Comments</label>
                            <input type="text" class=" form-control validacion " maxlength="500" id="caja_comentarios_recibo">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Customer</label>
                            <select class="form-control  cliente_recibo_trims " style="width:100%;  " id="caja_cliente_recibo">
                                <option value="1">MDE</option>
                                <option value="2">FANTASY</option>
                                <option value="3">FORTUNE</option>
                            </select>
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Branch</label>
                            <select class="form-control   " style="width:100%;  " id="caja_sucursal_recibo">
                                <option value="1">Fortune</option>
                                <option value="2">Lucky</option>
                                <option value="3">Lucky 2</option>
                            </select>
                        </div>

                    </div>
                </div>
                <div class="row panel" id="div_busqueda " style="height:350px; padding:0em 2em 0em 2em;">
                    <div class="panel-heading " tyle="padding-bottom: 1.5em;">
                        <label>Search trim</label>
                        <input style="float:right; " type="text" class=" form-control validacion " placeholder="SEARCH" onkeyup="llenar_tabla_items()" id="caja_busqueda_recibo_trims">
                    </div>

                    <div style=" ">
                        <table id="" class="table table-striped " style="margin:0px; ">
                            <thead class="cabecera_tabla"><tr><th style="width:6em;">#</th><th style="width:10em;">AMT</th><th style="width:20em;">Description</th><th style="width:6em;">Family</th></tr></thead>
                        </table>
                        <div style="margin:0px; height:260px; overflow:auto; border: 2px solid #3479bf; border-top:none; border-radius: 5px; ">
                            <table id="tabla_trims_recibos_temporal" class="table table-striped ">
                                <tbody class="body_tabla_trims_recibos_temporal"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row panel" id="div_tabla_trims_recibos" style="visibility:hidden; padding:2em; padding-top:0px; height:360px; border-radius: 5px;">
                    <h4>Items</h4>
                    <table id="" class="table table-striped " style="margin:0px; ">
                        <thead class="cabecera_tabla">
                            <tr>
                                <th style="width:10%;">#</th>
                                <th style="width:15%;">AMT</th>
                                <th style="width:40%;">Trim</th>
                                <th style="width:15%;">Ubication</th>
                                <th style="width:15%;">Quantity</th>
                                <th style="width:5%;"></th>
                            </tr>
                        </thead>
                    </table>
                    <div style="margin:0px; height:260px; overflow:auto; border: 2px solid #3479bf; border-top:none;">
                        <table id="tabla_trims_recibos" class="table table-striped ">
                            <tbody class="body_tabla_trims_recibos"></tbody>
                        </table>
                    </div>
                    <button type="button" class="btn btn-success mb-2" id="boton_guardar_recibo_trims" onclick="guardar_recibo_trims(event)" style=" margin-top:0.3em; float:right; margin-right:2em;">Save</button>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_catalogo" data-target="#modal_catalogo">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Catalogue</h4>
            </div>
            <div class="modal-body">
                <input type="hidden" id="id_item_hidden">
                <div class="row" id="formulario_nuevo_item" style="padding: 0em 2em; ">
                    <div class="form-group col-sm-2">
                        <label for="caja_trim_item" class=" col-form-label">Item</label>
                        <input type="text" class="form-control validacion  must_ttrim " maxlength="30" id="caja_trim_item">
                    </div>
                    <div class="form-group col-sm-3">
                        <label for="caja_descripcion" class=" col-form-label">Description</label>
                        <input type="text" class="form-control validacion  must_ttrim " maxlength="200" id="caja_descripcion">
                    </div>
                    <div class="form-group col-sm-2">
                        <label for="caja_family_trim" class=" col-form-label">Family trim</label>
                        <select class="form-control familia_trim" id="caja_family_trim"></select>
                    </div>
                    <div class="form-group col-sm-1">
                        <label for="caja_minimo_trim" class=" col-form-label">Minimum</label>
                        <input type="text" class="form-control numeric  must_ttrim " maxlength="50" id="caja_minimo_trim" value="0">
                    </div>
                    <div class="form-group col-sm-1">
                        <br />
                        <button type="button" class="btn btn-warning mb-2" id="boton_guardar_trim" onclick="recibir(event);">Save</button>
                    </div>

                </div>


                <div class="row " style="padding: 0em 3em; padding-bottom: 1.5em;">
                    <label>Search trim</label>
                    <input style=" " type="text" class=" form-control validacion " placeholder="SEARCH" onkeyup="llenar_tabla_catalogo()" id="caja_busqueda_catalogo">
                </div>
                <div id="div_tabla_catalogo" class=" " style="padding: 0em 2em;  visibility:visible;   width: 100%;   height:250px; ">
                    <table id="" class="table table-striped results_e" style="margin:0px;">
                        <thead class="" style="background:#3479bf; color:white;">
                            <tr>
                                <th style="width:5%;">#</th>
                                <th style="width:20%;">AMT</th>
                                <th style="width:45%;">DESCRIPTION</th>
                                <th style="width:20%;">FAMILY</th>
                                <th style="width:5%;"></th>
                                <th style="width:5%;"></th>
                            </tr>
                        </thead>
                    </table>
                    <div style="overflow:auto; height:250px; border: 1px solid #337ab7; border-radius: 5px;">
                        <table id="tabla_catalogo" class="table table-striped results_e" style="margin:0px;">
                            <tbody class="body_tabla_catalogo"></tbody>
                        </table>
                    </div>
                    <br />
                </div>

                <div class="row" id="edicion_trim_catalogo" style="display:none;margin-top:2em;">

                    <div class="form-group" style=" margin-top: 3em;margin-left: 1em;">
                        <div class="form-group " style=" margin: 0px; padding: 0px; margin-left: 1em;">
                            <br />
                            <button type="button" title="Cancel edition" id="boton_cerrar_edicion_catalogo" style="" class="btn btn-sm btn-danger ">x</button>
                        </div>
                        <div class="form-group col-sm-2">
                            <label for="caja_trim_item" class=" col-form-label">Item</label>
                            <input type="text" class="form-control validacion  edit_trim " maxlength="30" id="caja_trim_item_edit">
                        </div>
                        <div class="form-group col-sm-3">
                            <label for="caja_descripcion" class=" col-form-label">Description</label>
                            <input type="text" class="form-control validacion  edit_trim " maxlength="200" id="caja_descripcion_edit">
                        </div>
                        <div class="form-group col-sm-2">
                            <label for="caja_family_trim" class=" col-form-label">Family trim</label>
                            <select class="form-control familia_trim" id="caja_family_trim_edit"></select>
                            <!--<input type="text" class="form-control validacion  edit_trim " maxlength="50"   id="caja_family_trim_edit">-->
                        </div>
                        <div class="form-group col-sm-1">
                            <label for="caja_minimo_trim" class=" col-form-label">Minimum</label>
                            <input type="text" class="form-control numeric  edit_trim " maxlength="50" id="caja_minimo_trim_edit" value="0">
                        </div>
                        <div class="form-group col-sm-2">
                            <br />
                            <button type="button" class="btn btn-success mb-2" id="boton_guardar_trim" onclick="guardar_edicion_trim(event);">Save</button>
                        </div>

                    </div>
                </div>



            </div>
        </div>
    </div>
</div>