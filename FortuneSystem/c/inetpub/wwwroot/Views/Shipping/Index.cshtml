@{
    ViewBag.Title = "SHIPPING";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/base_m.css" rel="stylesheet" />
<script src="~/Content/Chart.js-master/Chart.bundle.js"></script>
<script src="~/Content/Chart.js-master/Chart.bundle.min.js"></script>
<script src="~/Content/Chart.js-master/Chart.min.js"></script>
<script src="~/Content/Chart.js-master/moment.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
<link href="~/Content/base_m.css" rel="stylesheet" />
<script>
    var dc, rows_stock;
    var tipo_packing;
    var estilos_fantasy_lista;
    $(document).ready(function () {
        $("#load_shipping").css('display', 'inline');        
        //obtener_pos('');
        obtener_drivers();
        obtener_carriers();
        obtener_contenedores_edicion();
        obtener_conductores_edicion();
        obtener_direcciones_pk();
        obtener_direcciones();
        obtener_pks('');
        dc = 0; tipo_packing = 0;
        estilos_fantasy_lista = '';
        rows_stock = 0;
        cargar_estilos_ordenes_stock();
        llenar_years();
        //$("#load_shipping").css('display', 'none');
    });
    var tipo_packing = 0;
    //VALIDACIONES
    $(document).on("input", ".numeric", function () {
        this.value = this.value.replace(/\D/g, '');
    });
    $(document).on("input", ".validacion", function () {
        var c = this.selectionStart,
            r = /[^a-zA-Z0-9áéíóúÁÉÍÓÚñÑ .()!@@/#%-]/,
            v = $(this).val();
        if (r.test(v)) {
            $(this).val(v.replace(r, ''));
            c--;
        }
        this.setSelectionRange(c, c);
    });
    //INICIO
    function busqueda_pk() {
        obtener_pks($("#caja_buscar_pk").val());
    }
    function obtener_pks(busqueda) {
        $.ajax({
            url: "/Shipping/buscar_pk_tabla",
            data: "{'busqueda':'" + busqueda + "'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = ''; var faltan_ids = 0;
                $.each(result, function (key, item) {
                    if (item.id_packing_list != 0) {
                        html += '<tr>';
                        html += '<td>' + item.id_packing_list + '</td>';
                        html += '<td>' + item.packing + '</td>';
                        html += '<td>' + item.fecha + '</td>';
                        html += '<td>' + item.customer_po + '</td>';
                        html += '<td><button type="button" ToolTip="Print Bill Of Loading"  class="btn edit_driver edicion_driver" onclick="ver_bol(' + item.id_packing_list + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-print" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                        html += '<td><button type="button" ToolTip="Add Ids"  class="btn edit_driver edicion_driver" onclick="agregar_ids(' + item.id_packing_list + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-tag" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                        html += '<td><button type="button" ToolTip="Edit seal, driver or container"  class="btn edit_driver edicion_driver" onclick="edit(' + item.id_packing_list + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-pencil" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                        html += '<td><button type="button" ToolTip="Add Ext/Dmg"  class="btn edit_driver edicion_driver" onclick="add_others(' + item.id_packing_list + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';

                        html += '</tr>';
                    }
                });
                $(".body_tabla_pk").html(html);
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    function obtener_contenedores_edicion() {
       $.ajax({
            url: '/Shipping/buscar_contenedores_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Container&nbsp;</label> <select class="form-control pk " id="caja_contenedor_edit_pk" >';
                // var html = '<select class="form-control " id="caja_contenedor_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_container + '">' + item.eco + '</option>';
                });
                html += '</select>';
                $("#div_container_edit").html(html);
            }
        });
    }
    function obtener_conductores_edicion() {
        $.ajax({
            url: '/Shipping/buscar_conductores_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Driver&nbsp;</label> <select class="form-control  " id="caja_conductor_edit_pk" >';
                //var html = '<select class="form-control " id="caja_conductor_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_driver + '">' + item.driver_name + '</option>';
                });
                html += '</select>';
                $("#div_driver_edit").html(html);
            }
        });
    }
    /**
     * *********************************************************************************************************
     *
     */
    var packing_list_number;
    function agregar_ids(id) {
        $("#load_shipping").css('display', 'inline');
        $.ajax({
            url: "/Shipping/buscar_estilos_packing",
            data: "{'id':'"+id+"'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (jsonData) {
                var html='';
                var i = 0;
                var lista_estilo = jsonData.Data.estilos;
                tipo_packing = jsonData.Data.tipo_packing;
                $("#ppk_bk_id").css('display', 'none');
                $("#assort_id").css('display', 'none');
                $(".rows_tabla_estilos_ids").html("");
                $(".rows_tabla_estilos_ids_assort").html("");
                if (tipo_packing != 3) {
                    $.each(lista_estilo, function (key, item) {
                        packing_list_number = item.pk;
                        html += '<tr>';
                        html += '<td>' + item.id_shipping_id + '</td>';
                        html += '<td>' + item.estilo + " " + item.descripcion + " " + item.color + '</td>';
                        html += '<td>' + item.boxes + '</td>';
                        html += '<td>' + item.dc + '</td>';
                        html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cbid_' + item.id_shipping_id + '"></td>';
                        html += '</tr>';
                        i++;
                    });
                    $("#ppk_bk_id").css('display', 'inline');
                    $(".rows_tabla_estilos_ids").html(html);
                } else {
                    $.each(lista_estilo, function (key, item) {
                        packing_list_number = item.pk;
                        html += '<tr>';
                        html += '<td>' + item.id_assortment + '</td>';
                        html += '<td>' + item.nombre+ '</td>';
                        html += '<td>' + item.cartones + '</td>';
                        html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cbid_ass' + item.id_assortment + '"></td>';
                        html += '</tr>';
                        i++;
                    });
                    $("#assort_id").css('display', 'inline');
                    $(".rows_tabla_estilos_ids_assort").html(html);
                }
                $("#load_shipping").css('display', 'none');
                if (i > 0) {
                    $("#modal_ids").modal("show");
                } else {
                    alertify.alert('Error!', 'There are not more styles without Ids');
                }
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    var estilos_id_seleccionados= 0;
    $(document).on("click", "#tabla_estilos_ids tr", function () {
        var row = this.rowIndex;
        var chekbox = $('#tabla_estilos_ids tr:eq(' + row + ')  td:nth-child(1)').html();
        if (this.style.background == "" || this.style.background == "white") {
            $("#cbid_" + chekbox).prop('checked', true);
            $(this).css('background', '#46a772');
            $(this).css('color', 'white');
            estilos_id_seleccionados++;
        } else {
            $("#cbid_" + chekbox).prop('checked', false);
            $(this).css('background', 'white');
            $(this).css('color', 'black');
            estilos_id_seleccionados--;
        }
    });
    $(document).on("click", "#tabla_estilos_ids_assort tr", function () {
        var row = this.rowIndex;
        var chekbox = $('#tabla_estilos_ids_assort tr:eq(' + row + ')  td:nth-child(1)').html();
        if (row!= 0) {
            if (this.style.background == "" || this.style.background == "white") {
                $("#cbid_ass" + chekbox).prop('checked', true);
                $(this).css('background', '#46a772');
                $(this).css('color', 'white');
                estilos_id_seleccionados++;
            } else {
                $("#cbid_ass" + chekbox).prop('checked', false);
                $(this).css('background', 'white');
                $(this).css('color', 'black');
                estilos_id_seleccionados--;
            }
        }
    });
    var ids_estilos_pk;
    function guardar_ids(event) {
        var error = 0; ids_estilos_pk = '';
        if (estilos_id_seleccionados == 0) { error++; }
        if ($("#caja_numero_id").val() == '') {
            $("#caja_numero_id").css('border', '2px solid #e03f3f');
            error++;
         } else {
            $("#caja_numero_id").css('border', '1px solid #cccccc');
         }
        if (error == 0) {
            $("#load_shipping").css('display', 'inline');
            if (tipo_packing != 3) {
                $('#tabla_estilos_ids tbody tr').each(function () {
                    if ($(this).find('td:eq(4) input').is(":checked")) {
                        ids_estilos_pk += "*" + $(this).find('td:eq(0) ').html();
                    }
                });
            } else {
                $('#tabla_estilos_ids_assort tbody tr').each(function () {
                    if ($(this).find('td:eq(3) input').is(":checked")) {
                        ids_estilos_pk += "*" + $(this).find('td:eq(0) ').html();
                    }
                });
            }
            enviar_datos_ids();
            $("#load_shipping").css('display', 'none');
        } else {
            $("#load_shipping").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_ids() {
        $("#load_shipping").css('display', 'inline');
        $.ajax({
            url: '/Shipping/guardar_ids_pk',
            data: "{'tarima':'" + $("#caja_numero_id").val() + "','estilos':'" + ids_estilos_pk + "','pk':'" + packing_list_number+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                //$("#modal_packinglist").modal("hide");
                $("#caja_numero_id").val("");
                var html = '';
                var i = 0;
                var lista_estilo = jsonData.Data.estilos;
                tipo_packing = jsonData.Data.tipo_packing;
                if (tipo_packing != 3) {
                    $.each(lista_estilo, function (key, item) {
                        packing_list_number = item.pk;
                        html += '<tr>';
                        html += '<td>' + item.id_shipping_id + '</td>';
                        html += '<td>' + item.estilo + " " + item.descripcion + " " + item.color + '</td>';
                        html += '<td>' + item.boxes + '</td>';
                        html += '<td>' + item.dc + '</td>';
                        html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cbid_' + item.id_shipping_id + '"></td>';
                        html += '</tr>';
                        i++;
                    });
                    $("#ppk_bk_id").css('display', 'inline');
                    $(".rows_tabla_estilos_ids").html(html);
                } else {
                    $.each(lista_estilo, function (key, item) {
                        packing_list_number = item.pk;
                        html += '<tr>';
                        html += '<td>' + item.id_assortment + '</td>';
                        html += '<td>' + item.nombre + '</td>';
                        html += '<td>' + item.cartones + '</td>';
                        html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cbid_ass' + item.id_assortment + '"></td>';
                        html += '</tr>';
                        i++;
                    });
                    $("#assort_id").css('display', 'inline');
                    $(".rows_tabla_estilos_ids_assort").html(html);
                }
                $("#load_shipping").css('display', 'none');
                if (i > 0) {
                    $("#modal_ids").modal("show");
                } else {
                    $("#modal_ids").modal("hide");
                    alertify.alert('Error!', 'There are not more styles without Ids');
                }


            }
        });
    }
    //tabla_estilos_ids_assort
    function llenar_select_po() {
        $.ajax({
            url: "/Shipping/buscar_po_summary",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    if (item.id_packing_list != 0) {
                        html += '<tr>';
                        html += '<td>' + item.id_packing_list + '</td>';
                        html += '<td>' + item.packing + '</td>';
                        html += '<td>' + item.fecha + '</td>';
                        html += '<td>' + item.customer_po + '</td>';

                        html += '<td> <button type="button" ToolTip="PRINT BILL OF LOADING"  class="btn edit_driver edicion_driver" onclick="ver_bol(' + item.id_packing_list + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-print" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';

                        html += '</tr>';
                    }
                });
                $(".body_tabla_pk").html(html);
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }

    $(document).on("dblclick", "#tabla_pks tr", function () {
         var row = this.rowIndex;
        var number = $('#tabla_pks tr:eq(' + row + ') td:eq(0)').html();
        if (!(isNaN(number))) { ver_pk(number); }
    });
    //CAMBIAR LOS ROW DE COLOR
    var tarimas_seleccionadas = 0;
    $(document).on("click", "#tabla_pks tr", function () {
        var row = this.rowIndex;
        if (row > 0) {
            if (this.style.background == "" || this.style.background == "white") {
                $(this).css('background', '#46a772');
                $(this).css('color', 'white');
            } else {
                $(this).css('background', 'white');
                $(this).css('color', 'black');
            }
        }

    });
    function ver_pk(id) {
        $.ajax({
            url: '/Shipping/abrir_pk',
            data: "{'id':'" + id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                //imprimir_pk();
            }
        });
        $("#espera").css('display','inline');
        var boton = document.getElementById('link_excel');        
        setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
        boton.click();
        //$("#load_shipping").css('display', 'none');
        $("#loading").css('display', 'none');

    }


    $(document).on("input", ".po", function () { $('.po').autocomplete({ source: '@Url.Action("Autocomplete_po")' }); });
    $(document).on("input", ".tallas", function () { $('.tallas').autocomplete({ source: '@Url.Action("Autocomplete_tallas")' }); });
    function redireccionar_recibos() {
        window.location = '/Shipping/recibo_fantasy';
    }
    var columnas_dc, rows_dc,columnas_estilos_dc;

    /*********************************************************************************************************************************************/
    function edit(id) {
        $.ajax({
            url: "/Shipping/buscar_informacion_edicion_pk",
            data: "{'pk':'"+id+"'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                //var html = '';
                $("#caja_pk_edit").val(result.packing);
                $("#caja_seal_pk_edit").val(result.seal);
                $("#caja_replacement_pk_edit").val(result.replacement);
                $("#caja_conductor_edit_pk").val(result.id_driver);
                $("#caja_contenedor_edit_pk").val(result.id_container);
                $("#caja_id_pk").val(result.id_packing_list);
                $("#modal_edicion").modal("show");
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }//guardar_edicion
    function guardar_edicion() {
        $.ajax({
            url: "/Shipping/guardar_informacion_edicion_pk",
            data: "{'id':'" + $("#caja_id_pk").val() + "','sello':'" + $("#caja_seal_pk_edit").val() + "','replacement':'" + $("#caja_replacement_pk_edit").val() + "','conductor':'" + $("#caja_conductor_edit_pk").val() + "','contenedor':'" + $("#caja_contenedor_edit_pk").val() +"'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                $("#modal_edicion").modal("hide");
                alertify.success('Succes! Changes saved!');
                alertify.set('notifier', 'position', 'top-right');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    /*********************************************************************************************************************************************/

    function obtener_drivers() {
        $("#load_fantasy").css('display', 'inline');
        $("#load_shipping").css('display', 'inline');
        $.ajax({
            url: "/Shipping/buscar_conductores",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td>' + item.id_driver + '</td>';
                    html += '<td>' + item.carrier + '</td>';
                    html += '<td>' + item.driver_name + '</td>';
                    html += '<td>' + item.plates + '</td>';
                    html += '<td>' + item.scac + '</td>';
                    html += '<td>' + item.caat + '</td>';
                    html += '<td>' + item.tractor + '</td>';
                    html += '<td> <button type="button" class="btn edit_driver edicion_driver" onclick="modificar_driver(' + item.id_driver + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-pencil" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                    html += '<td> <button type="button" class="btn edit_driver" onclick="eliminar_driver(' + item.id_driver + ')" style="padding: 0em 0.3em !important; background:none; color:#3479bf; font-weight: bolder;"> <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                    html += '</tr>';
                });
                $(".body_tabla_drivers").html(html);
                $("#load_fantasy").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    function obtener_carriers() {
        $("#load_fantasy").css('display', 'inline');
        $.ajax({
            url: '/Shipping/buscar_carriers',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Carrier</label> <select class="form-control " id="caja_carrier" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.carrier + '">' + item.carrier + '</option>';
                });
                html += '</select>';
                $("#carrier_div").html(html);
                $("#load_fantasy").css('display', 'none');
            }
        });
    }
    function guardar_driver(event) {
        var error = 0;
        $(".check_driver").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
       if (error == 0) {
            $("#load_shipping").css('display', 'inline');
           enviar_datos_driver();
            $("#load_shipping").css('display', 'none');
        } else {
            $("#load_shipping").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_driver() {
        $.ajax({
            url: '/Shipping/enviar_informacion_driver',
            data: "{'carrier':'" + $("#caja_carrier").val() + "','nombre':'" + $("#caja_nombre_driver").val() + "','plates':'" + $("#caja_plates").val() + "','scac':'" + $("#caja_scac").val() + "','caat':'" + $("#caja_caat").val() + "','tractor':'" + $("#caja_tractor").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                limpiar_driver();
                obtener_drivers();
                $("#formulario_nuevo_conductor").toggle("slow");
                alertify.success('Succes! you can add another Id');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function limpiar_driver() {
        $(".check_driver").each(function () { $(this).val(''); });
        $(".check_driver_edit").each(function () { $(this).val(''); });
        $(".check_dir").each(function () { $(this).val(''); });
        $(".check_dir_edit").each(function () { $(this).val(''); });
    }
    function modificar_driver(ID) {
        obtener_carriers_edit();
        $("#caja_id_driver").val(ID);
        $.ajax({
            url: '/Shipping/buscar_informacion_driver',
            data: "{'id':'" + ID + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $.each(result, function (key, item) {
                    $("#caja_carrier_edit").val(item.carrier);
                    $("#caja_nombre_driver_edit").val(item.driver_name);
                    $("#caja_plates_edit").val(item.plates);
                    $("#caja_scac_edit").val(item.scac);
                    $("#caja_caat_edit").val(item.caat);
                    $("#caja_tractor_edit").val(item.tractor);
                });
            }
        });
    }
    $(document).on("dblclick", "#tabla_drivers tr", function () {
        var row = this.rowIndex;
        $("#editar_driver").css('display','inline');
        modificar_driver($('#tabla_drivers tr:eq(' + row + ')  td:nth-child(1)').html());
        
    });



    function eliminar_driver(ID) {
        $.ajax({
            url: '/Shipping/eliminar_conductor',
            data: "{'id':'" + ID + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                obtener_drivers();
            }
        });
    }
    function obtener_carriers_edit() {
        $.ajax({
            url: '/Shipping/buscar_carriers',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Carrier</label> <select class="form-control " id="caja_carrier_edit" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.carrier + '">' + item.carrier + '</option>';
                });
                html += '</select>';
                $("#carrier_div_edit").html(html);
            }
        });
    }
    $(document).on("click", "#boton_formulario_nuevo_conductor", function () {
        var texto = $("#boton_formulario_nuevo_conductor").text();
        if (texto == 'New driver') {
            $("#boton_formulario_nuevo_conductor").text('x');
        } else {
            $("#boton_formulario_nuevo_conductor").text('New driver');
        }
        $("#formulario_nuevo_conductor").toggle("slow");
    });
    $(document).on("click", ".edicion_driver", function () {
        $("#editar_driver").toggle("slow");
    });
    function guardar_driver_edit(event) {
        var error = 0;
        $(".check_driver_edit").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            $("#load_shipping").css('display', 'inline');
            enviar_datos_driver_edicion();
            $("#load_shipping").css('display', 'none');
        } else {
            $("#load_shipping").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_driver_edicion() {
        $.ajax({
            url: '/Shipping/enviar_informacion_driver_edicion',
            data: "{'id':'" + $("#caja_id_driver").val() + "','carrier':'" + $("#caja_carrier_edit").val() + "','nombre':'" + $("#caja_nombre_driver_edit").val() + "','plates':'" + $("#caja_plates_edit").val() + "','scac':'" + $("#caja_scac_edit").val() + "','caat':'" + $("#caja_caat_edit").val() + "','tractor':'" + $("#caja_tractor_edit").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                limpiar_driver();
                obtener_drivers();
                $("#editar_driver").toggle("slow");
                alertify.success('Changes saved!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    /************************DIRECCIONES*********************************************************************************************************************/
    function obtener_direcciones() {
        $("#load_fantasy").css('display', 'inline');
        $.ajax({
            url: "/Shipping/buscar_direcciones_envio",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>';
                    html += '<td>' + item.id_direccion + '</td>';
                    html += '<td>' + item.nombre + '</td>';
                    html += '<td>' + item.direccion + '</td>';
                    html += '<td>' + item.ciudad + '</td>';
                    html += '<td>' + item.zip + '</td>';
                    html += '<td> <button type="button" class="btn edit_driver edit_direccion" onclick="modificar_direccion(' + item.id_direccion + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-pencil" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                    html += '<td> <button type="button" class="btn edit_driver" onclick="eliminar_direccion(' + item.id_direccion + ')" style="padding: 0em 0.3em !important; background:none; color:#3479bf; font-weight: bolder;"> <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"  style="padding 0px !important;"></span> </button></td>';
                    html += '</tr>';
                });
                $(".body_tabla_direcciones").html(html);
                $("#load_fantasy").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    $(document).on("dblclick", "#tabla_direcciones tr", function () {
        var row = this.rowIndex;
        $("#editar_direccion").css('display', 'inline');
        modificar_direccion($('#tabla_direcciones tr:eq(' + row + ')  td:nth-child(1)').html());

    });
    $(document).on("click", "#boton_formulario_nueva_direccion", function () {
        var texto = $("#boton_formulario_nueva_direccion").text();
        if (texto == 'New address') {
            $("#boton_formulario_nueva_direccion").text('x');
        } else {
            $("#boton_formulario_nueva_direccion").text('New address');
        }
        $("#formulario_nueva_direccion").toggle("slow");
    });
    $(document).on("click", ".edit_direccion", function () { $("#editar_direccion").toggle("slow"); });
    $(document).on("click", "#boton_cerrar_edicion_direccion", function () { $("#editar_direccion").toggle("slow"); });
    $(document).on("click", "#boton_ocultar_formulario_nuevo_conductor", function () {
        $("#formulario_nuevo_conductor").css('display', 'none');
    });
    $(document).on("click", "#boton_ocultar_edicion_conductor", function () { $("#editar_driver").css('display','none'); });
    //oton_ocultar_edicion_conductor
    function guardar_direccion(event) {
        var error = 0;
        $(".check_dir").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            $("#load_shipping").css('display', 'inline');
            enviar_datos_direccion();
            $("#load_shipping").css('display', 'none');
        } else {
            $("#load_shipping").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_direccion() {
        $.ajax({
            url: '/Shipping/enviar_informacion_direccion',
            data: "{'nombre':'" + $("#caja_nombre_dir").val() + "','direccion':'" + $("#caja_direccion_dir").val() + "','ciudad':'" + $("#caja_ciudad_dir").val() + "','zip':'" + $("#caja_codigo_postal_dir").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                limpiar_driver();
                $("#formulario_nuevo_conductor").toggle("slow");
                obtener_direcciones();
                alertify.success('Changes saved!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function modificar_direccion(ID) {
        $("#caja_id_direccion").val(ID);
        $.ajax({
            url: '/Shipping/buscar_modificar_edicion',
            data: "{'id':'" + ID + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $.each(result, function (key, item) {
                    $("#caja_nombre_dir_edit").val(item.nombre);
                    $("#caja_direccion_dir_edit").val(item.direccion);
                    $("#caja_ciudad_dir_edit").val(item.ciudad);
                    $("#caja_codigo_postal_dir_edit").val(item.zip);
                });
            }
        });
    }
    function guardar_direccion_edicion(event) {
        var error = 0;
        $(".check_dir_edit").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (error == 0) {
            $("#load_shipping").css('display', 'inline');
            enviar_datos_direccion_edit();
            $("#load_shipping").css('display', 'none');
        } else {
            $("#load_shipping").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_direccion_edit() {
        $.ajax({
            url: '/Shipping/enviar_informacion_direccion_edicion',
            data: "{'id':'" + $("#caja_id_direccion").val() + "','nombre':'" + $("#caja_nombre_dir_edit").val() + "','direccion':'" + $("#caja_direccion_dir_edit").val() + "','ciudad':'" + $("#caja_ciudad_dir_edit").val() + "','zip':'" + $("#caja_codigo_postal_dir_edit").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                limpiar_driver();
                obtener_direcciones();
                $("#editar_direccion").toggle("slow");
                alertify.success('Changes saved!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });
    }
    function eliminar_direccion(ID) {
        $.ajax({
            url: '/Shipping/eliminar_direccion',
            data: "{'id':'" + ID + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                obtener_direcciones();
            }
        });
    }
    /*********CONTENEDORES************************************************************************************************************************************/
    obtener_contenedores();
    obtener_conductores();
    obtener_direcciones_pk();
    function obtener_contenedores() {
        $("#loading_pk").css('display', 'inline');
        $.ajax({
            url: '/Shipping/buscar_contenedores_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Container&nbsp;</label> <select class="form-control pk " id="caja_contenedor_pk" >';
                // var html = '<select class="form-control " id="caja_contenedor_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_container + '">' + item.eco + '</option>';
                });
                html += '</select>';
                $("#div_container").html(html);
            }
        });
    }
    function obtener_conductores() {
        $.ajax({
            url: '/Shipping/buscar_conductores_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Driver&nbsp;</label> <select class="form-control pk " id="caja_conductor_pk" >';
                //var html = '<select class="form-control " id="caja_conductor_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_driver + '">' + item.driver_name + '</option>';
                });
                html += '</select>';
                $("#div_driver").html(html);
            }
        });
    }
    function obtener_direcciones_pk() {
        $.ajax({
            url: '/Shipping/buscar_direcciones_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Address&nbsp;</label> <select class="form-control pk" id="caja_direccion_pk" >';
                //var html = '<select class="form-control " id="caja_direccion_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_direccion + '">' + item.nombre + '</option>';
                });
                html += '</select>';
                $("#div_shipto").html(html);
                $("#loading_pk").css('display', 'none');
            }
        });
    }
    function obtener_estilos_tarimas(pedido) {
        $("#load_fantasy").css('display', 'inline');
        $.ajax({
            url: "/Shipping/buscar_estilos_pk",
            data:"{'pedido':'"+pedido+"'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                //<th>ID</th><th>PO NUM</th><th>STYLE</th><th>BOXES</th><th>DC</th>
                var html = '';
                var estilos,rows;
                $.each(result, function (key, item) {
                    estilos = 0;
                    rows = 0;
                    $.each(item.lista_estilos, function (key, i) {
                        estilos++;
                    });
                    html += '<tr>';
                    html += '<td >' + item.id_tarima + '</td>';

                    html += '<td>  ';
                    $.each(item.lista_estilos, function (key, i) {
                        html += ' <p>' + i.number_po + '</p>';
                    });
                    html += '</td>';

                    html += '<td>  ';
                    $.each(item.lista_estilos, function (key, i) {
                        html += ' <p>' + i.estilo + ' ' + i.descripcion + '</p>';
                    });
                    html += '</td>';

                    html += '<td>  ';
                    $.each(item.lista_estilos, function (key, i) {
                        html += ' <p>' + i.boxes + '</p>';
                    });
                    html += '</td>';

                    html += '<td>   ';
                    $.each(item.lista_estilos, function (key, i) {
                        if (i.dc == 0) {
                            html += '<p>None</p>';
                        } else {
                            html += '<p>' + i.dc + '</p>';
                        }
                    });
                    html += '</td>';
                    html += '<td style="visibility:hidden; width:1em;"><input type="checkbox"  class="custom-control-input" id="cb_' + item.id_tarima + '"></td>';

                    html += '</tr>';

                });
                //---ID----PO NUM-----STYLE-----BOXES-
                $(".body_tabla_ids_estilos").html(html);
                $("#div_tabla_estilos_pk").css('visibility','visible');
                $("#load_fantasy").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }
    $(document).on("dblclick", "#tabla_ids_estilos tr", function () {
       /* var row = this.rowIndex;
        //alert($('#items_recibos tr:eq('+row+') td:eq(0)').html()); //empieza las columas desde 0
        //alert($('#items_recibos tr:eq(' + row + ') td:nth-child(2)').html());     //empieza las columnas desde 1
        agregar_row($('#tabla_ids_estilos tr:eq(' + row + ') td:eq(1)').html() + "&" + $('#items_recibos tr:eq(' + row + ') td:eq(0)').html());*/
    });
    //CAMBIAR LOS ROW DE COLOR
    var tarimas_seleccionadas=0;
    $(document).on("click", "#tabla_ids_estilos tr", function () {
        var row = this.rowIndex;
        var chekbox = $('#tabla_ids_estilos tr:eq(' + row + ')  td:nth-child(1)').html();
        if (this.style.background == "" || this.style.background == "white") {
            $("#cb_" + chekbox).prop('checked', true);
            $(this).css('background', '#46a772');
            $(this).css('color', 'white');
            tarimas_seleccionadas++;
        } else {
            $("#cb_" + chekbox).prop('checked', false);
            $(this).css('background', 'white');
            $(this).css('color', 'black');
            tarimas_seleccionadas--;
        }
    });
    var tarimas;
    
    function enviar_datos_tarimas() {
        $.ajax({
            url: '/Shipping/guardar_pk',
            data: "{'tarimas':'" + tarimas + "','po':'" + $("#caja_po_number_pk").val() + "','address':'" + $("#caja_direccion_pk").val() + "','driver':'" + $("#caja_conductor_pk").val() + "','container':'" + $("#caja_contenedor_pk").val() + "','seal':'" + $("#caja_seal_pk").val() + "','replacement':'" + $("#caja_replacement_pk").val() + "','manager':'" + $("#caja_manager_pk").val() + "','tipo':'" + $("#caja_tipo_pk").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#caja_po_number_pk").val('');
                $(".body_tabla_ids_estilos").html('');
                $("#div_tabla_estilos_pk").css('visibility', 'hidden');
                $("#modal_packinglist").modal("hide");
                $("#caja_seal_pk").val('');
                $("#caja_replacement_pk").val('');
                $("#caja_manager_pk").val('');
                $("#caja_po_number_pk").val('');
                obtener_pks('');
                imprimir_pk();
                //AQUI ALGO PARA IMPRIMIR EL PDF
            }
        });
    }
    function imprimir_pk() {
        var h = screen.height - 100;
        var w = screen.width - 30;
        window.open('/PDF/imprimir_pk', '_blank', 'toolbar=0,location=0,menubar=0,width=' + w + ',height=' + h + ', fullscreen=yes');
    }
    function imprimir_bol() {
        var h = screen.height - 100;
        var w = screen.width - 30;
        window.open('/PDF/imprimir_bol', '_blank', 'toolbar=0,location=0,menubar=0,width=' + w + ',height=' + h + ', fullscreen=yes');
    }
    function ver_bol(id) {
        $.ajax({
            url: '/Shipping/abrir_pk',
            data: "{'id':'" + id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                imprimir_bol();
            }
        });
    }

    /*********************************************************************************************************************************************/




    var columnas_estilos_dc; var number_po;
    function add_others(id) {
        $("#load_shipping").css('display', 'inline');
        $(".rows_estilos_otros").html("");
        $.ajax({
            url: '/Shipping/buscar_estilos_pk_otros',
            data: "{'id':'" + id + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var lista_estilo = jsonData.Data.estilos;
                number_po = jsonData.Data.po_number;
                var html = '';
                $.each(lista_estilo, function (key, item) {
                    if (item.tipo_empaque == 1 || item.tipo_empaque == 2 || item.tipo_empaque == 3) {
                        tipo_packing = item.tipo_empaque;
                    }
                    html += '<tr>';
                    html += '<td>' + item.id_estilo + '</td>';
                    html += '<td>' + item.estilo + '</td>';
                    html += '<td>' + item.descripcion + '</td>';
                    html += '<td>' + item.color + '</td>';
                    html += '</tr>';
                });
                $("#div_estilos_otros").css('display', 'inline');
                $(".rows_estilos_otros").append(html);
                //************************************************************
                $("#div_otros_tallas").css('display', 'inline');
                columnas_dc = 0;//same que el de abajo
                columnas_estilos_dc = '';//USAR SOLAMENTE CUANDO ES OTROS
                var html = '<td><select class="form-control dc_estilos"  ><option  value="0" selected>#</option></select></td>';
                html += '<td><select class="form-control dc_estilos"  ><option  value="0" selected>Style</option></select></td>';
                html += '<td><select class="form-control dc_estilos"  ><option  value="0" selected>Type</option></select></td>';
                var x = 0;
                $.each(lista_estilo, function (key, item) {
                    if (x == 0) {
                        $.each(item.lista_ratio, function (key, i) {
                            html += '<td><select class="form-control dc_estilos"  ><option  value="' + i.id_talla + '" selected>' + i.talla + '</option></select></td>';
                            columnas_estilos_dc += "*" + i.id_talla;
                            columnas_dc++;
                        });
                        x++;
                    }
                });
                html += '<td></td>'; //
                $(".cabeceras_otros").html(html);
                estilos_seleccionados = 0;
                $("#modal_shipping_ratio").modal("show");
                $("#load_shipping").css('display', 'none');
            }       //success
        });
    }

    $(document).on("dblclick", "#tabla_estilos_otros tr", function () {
        var row = this.rowIndex;
        if (row != 0) {
            agregar_row_otros($('#tabla_estilos_otros tr:eq(' + row + ') td:eq(0)').html() + "&" + $('#tabla_estilos_otros tr:eq(' + row + ') td:eq(1)').html());
        }
    });
    function agregar_row_otros(ID) {
        var data = ID.split("&");
        var html = '<tr>' +
            '<td><input readonly  class="validacion form-control estilos_tablas"  value="' + data[0] + '"  /></td>' +
            '<td><input readonly  class="validacion form-control estilos_tablas" style="width: 100% !important;" id="" value="' + data[1] + '" /></td>';
        html += '<td><select class="form-control js-example-basic-single "  >' +
            '<option>DMG</option><option>EXT</option><option>ECOM</option><option>RPLN</option>'; //<option>EXT</option><option>DMG</option>
        html += '</select ></td>';
        for (var i = 0; i < columnas_dc; i++) {
            html += '<td><input ondrop="return false;" onpaste="return false;" maxlength="6" class="numeric form-control check_item  " id="" value="0" /></td>';  //boxes
        }
        html += '<td><button type="button" class="btn btn-light deleteRowOtros"><b>-</b></button></td></tr>';
        estilos_seleccionados++;
        $('#tabla_otros').css('visibility', 'visible');
        $('#boton_guardar_otros').css('visibility', 'visible');
        $('.rows_otros').append(html);
    }
    $(document).on("click", ".deleteRowOtros", function () {
        $(this).closest("tr").remove();
        estilos_seleccionados--;
        if (estilos_seleccionados <= 0) {
            $('#tabla_otros').css('visibility', 'hidden');
            $('#boton_guardar_otros').css('visibility', 'hidden');
        } else {
            $('#tabla_otros').css('visibility', 'visible');
            $('#boton_guardar_otros').css('visibility', 'visible');
        }
    });
    function limpiar_otros() {
        $(".rows_estilos_otros").html('');
        $(".cabeceras_otros").html('');
        $(".rows_otros").html('');
        $("#div_estilos_otros").css('display', 'none');
    }
    $(document).on("click", ".cerrar_extras", function () {
        limpiar_otros();
    });
    var row_otro;
    function guardar_estilos_otros(event) {
        var error = 0;

        $(".check_item").each(function () {
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });

        if (error == 0) {
            row_otro = []; var row;
            $('#tabla_otros tbody tr').each(function () {
                row = $(this).find('td:eq(0) input').val() + '*' + $(this).find("select option:selected").text();
                for (var i = 3; i < (columnas_dc + 3); i++) {
                    if ($(this).find('td:eq(' + i + ') input').val() == "") { row += "*0"; }
                    else { row += "*" + $(this).find('td:eq(' + i + ') input').val(); }
                }
                row_otro.push(row);
            });
            enviar_otros();
            $("#loading_pk").css('display', 'none');
        } else {
            $("#loading_pk").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_otros() {
        var actionData = "{'estilos':'" + columnas_estilos_dc + "','rows':'" + row_otro + "','number_po':'" + number_po + "'}";
        $.ajax({
            url: '/Shipping/agregar_otros_estilos',
            data: actionData,
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                alertify.success('Succes!');
                alertify.set('notifier', 'position', 'top-right');
                $("#modal_shipping_ratio").modal("hide");
                limpiar_otros();

            }
        });
    }


    /*********************************************************************************************************************************************/
    $(document).on("input", ".pedidos_stock", function () { $('.pedidos_stock').autocomplete({ source: '@Url.Action("Autocomplete_po")' }); });
    $(document).on("click", "#boton_stock_fantasy", function () {
        $("#load_shipping").css('display', 'inline');

        agregar_stock();
        $("#load_shipping").css('display', 'none');
    });

    function cargar_estilos_ordenes_stock() {
        $.ajax({
            url: '/Fantasy/buscar_estilos_fantasy',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                //html = '<label class=" col-form-label">Style</label>';
                html += ' <select class="form-control " id="caja_estilo_orden" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_estilo_fantasy + '">' + (item.estilo).trim() + " " + (item.descripcion).trim() + '</option>';
                });
                html += '</select>';
                estilos_fantasy_lista = html;
                $(".estilos_stock").html(html);
                $("#load_shipping").css('display', 'none');
            }
        });
    }//deleteRowEstilosStock
    $(document).on("click", ".deleteRowEstilosStock", function () {
        $(this).closest("tr").remove();
        rows_stock--;
        if (rows_stock <= 0) {
            $("#modal_stock").modal("hide");
        } else {
            $('#tabla_stock_fantasy').css('visibility', 'visible');
        }
    });
    function agregar_stock() {//<tr><<th>PO</th><th>SM</th><th>MD</th><th>LG</th><th>XL</th><th>2X</th><th>-</th></tr>
        var html = '<tr>';
        //html += estilos_fantasy_lista;
        html += '<td>' + estilos_fantasy_lista+'</td>';
        html += '<td> <input type="text" class=" form-control pedidos_stock order validacion" ondrop="return false;" onpaste="return false;" maxlength="30" id="caja_estilo"></td>';
        html += '<td><input  style="width:8em;" type="text" class=" form-control numeric stock" ondrop="return false;" onpaste="return false;" value="0" maxlength="10" id="caja_sm"></td>';
        html += '<td><input  style="width:8em;" type="text" class=" form-control numeric stock" ondrop="return false;" onpaste="return false;" value="0" maxlength="10" id="caja_sm"></td>';
        html += '<td><input  style="width:8em;" type="text" class=" form-control numeric stock" ondrop="return false;" onpaste="return false;" value="0" maxlength="10" id="caja_sm"></td>';
        html += '<td><input  style="width:8em;" type="text" class=" form-control numeric stock" ondrop="return false;" onpaste="return false;" value="0" maxlength="10" id="caja_sm"></td>';
        html += '<td><input  style="width:8em;" type="text" class=" form-control numeric stock" ondrop="return false;" onpaste="return false;" value="0" maxlength="10" id="caja_sm"></td>';
        html += '<td><button type="button" class="btn btn-light deleteRowEstilosStock"><b>-</b></button></td></tr>';
        rows_stock++;
        $('#tabla_stock_fantasy').css('visibility', 'visible');
        $('.body_tabla_stock_fantasy').append(html);
    }
    var estilo_stock,  po_stock, sm, md, lg, xl, xx;
    function guardar_stock(event) {
        estilo_stock = ''; po_stock = ''; sm = ''; md = ''; lg = ''; xl = ''; xx = '';
        if (rows_stock < 1) { error++; }
        var valores = 0;
        var error = 0;
        $(".stock").each(function () {
            if ($(this).val() != '0' && $(this).val() != '') { valores++; }
            if ($(this).val() == '') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
        });
        if (valores == 0) { error++;}
        if ($("#caja_cliente_orden").val() == "0") { error++; }
        $('#tabla_tallas_fantasy tbody tr').each(function () {
            if ($(this).find('td:eq(2) input').val() == "0" && $(this).find('td:eq(3) input').val() == "0" && $(this).find('td:eq(4) input').val() == "0" && $(this).find('td:eq(5) input').val() == "0" && $(this).find('td:eq(6) input').val() == "0") { error++; }
        });
        if (error == 0) {//th>Style</th><th>PO</th><th>SM</th><th>MD</th><th>LG</th><th>XL</th><th>2X</th
            $("#load_fantasy").css('display', 'inline');
            $('#tabla_stock_fantasy tbody tr').each(function () {
                estilo_stock += "*" + $(this).find("select option:selected").val();
                po_stock += "*" + $(this).find('td:eq(1) input').val();
                if ($(this).find('td:eq(2) input').val() == '') { sm += "*0"; } else { sm += "*" + $(this).find('td:eq(2) input').val(); }
                if ($(this).find('td:eq(3) input').val() == '') { md += "*0"; } else { md += "*" + $(this).find('td:eq(3) input').val(); }
                if ($(this).find('td:eq(4) input').val() == '') { lg += "*0"; } else { lg += "*" + $(this).find('td:eq(4) input').val(); }
                if ($(this).find('td:eq(5) input').val() == '') { lx += "*0"; } else { xl += "*" + $(this).find('td:eq(5) input').val(); }
                if ($(this).find('td:eq(6) input').val() == '') { xx += "*0"; } else { xx += "*" + $(this).find('td:eq(6) input').val(); }
            });
            enviar_datos_order();
            $("#load_fantasy").css('display', 'none');
        } else {
            $("#load_fantasy").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function enviar_datos_order() {
        $.ajax({
            url: '/Fantasy/agregar_inventario_fantasy',
            data: "{'estilo':'" + estilo_stock + "','talla_sm':'" + sm + "','talla_md':'" + md + "','talla_lg':'" + lg + "','talla_xl':'" + xl + "','talla_xx':'" + xx + "','pedido':'" + po_stock + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $('.body_tabla_stock_fantasy').html("");
                $("#modal_stock").modal("hide");
                batch = result;
                alertify.success('Success!');
                alertify.set('notifier', 'position', 'top-right');
            }
        });

    }




    /*********************************************************************************************************************************************/
    /*****REPORTES****************************************************************************************************************************************/
    //caja_rep1_inicio
    $(function () {
        $.datepicker.regional['en'] = {
            /*closeText: 'Cerrar',
            prevText: '<Ant',
            nextText: 'Sig>',
            currentText: 'Hoy',
            monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            monthNamesShort: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
                'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            dayNames: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
            dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mié', 'Juv', 'Vie', 'Sáb'],
            dayNamesMin: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sá'],
            weekHeader: 'Sm',*/
            dateFormat: 'yy-mm-dd',
            firstDay: 1,
            isRTL: false,
            showMonthAfterYear: false,
            yearSuffix: ''
        };
        $.datepicker.setDefaults($.datepicker.regional['en']);
        $('#caja_rep1_inicio').datepicker();
        $('#caja_rep1_final').datepicker();
    });

    function enviar_fechas_reporte(event) {
        if ($('#caja_rep1_inicio').val() != '' && $("#caja_rep1_final").val() != '') {
            $.ajax({
                url: '/Shipping/fechas_reporte',
                data: "{'inicio':'" + $("#caja_rep1_inicio").val() + "','final':'" + $("#caja_rep1_final").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#caja_rep1_inicio').val('');
                    $("#caja_rep1_final").val('');
                    $("#modal_fechas_ordenes_abiertas").modal("hide");
                    return false;
                }
            });
            reporte_po_abierto();
        } else {
            event.preventDefault();
            if ($('#caja_rep1_inicio').val() == '') { $('#caja_rep1_inicio').css('border', '2px solid #e03f3f'); } else { $('#caja_rep1_inicio').css('border', '1px solid #cccccc'); }
            if ($('#caja_rep1_final').val() == '') { $('#caja_rep1_final').css('border', '2px solid #e03f3f'); } else { $('#caja_rep1_final').css('border', '1px solid #cccccc'); }
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function reporte_po_abierto() {
        $("#espera").css('display', 'inline');
        var boton = document.getElementById('reporte1');
        boton.click();
        setTimeout(function () { $("#espera").css('display', 'none'); }, 10000);
    }
    $(document).on("input", ".ordersc", function () { $('.ordersc').autocomplete({ source: '@Url.Action("Autocomplete_po_abiertos")' }); });
    function close_order(event) {
        if ($('#caja_order_close').val() != '') {
            $('#caja_order_close').css('border', '1px solid #cccccc');
            $.ajax({
                url: '/Shipping/cerrar_po',
                data: "{'po':'" + $("#caja_order_close").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    //$("#modal_cerrar_pedido").modal("hide");
                    $('#caja_order_close').val('');
                    /*alertify.success('Success!');
                    alertify.set('notifier', 'position', 'top-right');*/
                }
            });
        } else {
            event.preventDefault();
            $('#caja_order_close').css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }

    function estado_estilos_orden(event) {
        if ($('#caja_order_status').val() != '') {
            $('#caja_order_status').css('border', '1px solid #cccccc');
            $.ajax({
                url: '/Shipping/po_reporte',
                data: "{'po':'" + $("#caja_order_status").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#caja_order_status').val('');
                    $("#modal_estado_envio_estilos").modal("hide");
                    return false;
                }
            });
            reporte_estado_po();
        } else {
            event.preventDefault();
            $('#caja_order_status').css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function reporte_estado_po() {
        $("#espera").css('display', 'inline');
        var boton = document.getElementById('reporte_estados');
        boton.click();
        setTimeout(function () { $("#espera").css('display', 'none'); }, 10000);
    }

    $(document).on("input", ".styles", function () { $('.styles').autocomplete({ source: '@Url.Action("Autocomplete_estilos")' }); });
    function ordenes_por_estilo(event) {
        if ($('#caja_style_po').val() != '') {
            $('#caja_style_po').css('border', '1px solid #cccccc');
            $.ajax({
                url: '/Shipping/estilo_reporte',
                data: "{'estilo':'" + $("#caja_style_po").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $('#caja_style_po').val('');
                    $("#modal_pos_mismo_estilo").modal("hide");
                    return false;
                }
            });
            reporte_pos_estilo();
        } else {
            event.preventDefault();
            $('#caja_order_status').css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function reporte_pos_estilo() {
        $("#espera").css('display', 'inline');
        var boton = document.getElementById('reporte_pos_estilo');
        boton.click();
        setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
    }
    /*********************************************************************************************************************************************/
     
   
    function llenar_years() {
        var html = '<label class=" col-form-label">Year</label> <select class="form-control " id="caja_fecha_pk" >';
        var d = new Date();
        var year = d.getFullYear();
        for (var i = year; i >= year-10; i--) {
            html += '<option  value="' + i + '">' + i + '</option>';
        }
        html += '</select>';
        $("#div_fecha_pk").html(html);
        $("#loading").css('display', 'none');
    }
    function packing_list(event) {
        $.ajax({
            url: '/Shipping/year_report',
            data: "{'year':'" + $("#caja_fecha_pk").val() + "'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                $("#modal_packing_fecha").modal("hide");
                return false;
            }
        });
        reporte_year();
    }
    function reporte_year() {
        $("#espera").css('display', 'inline');
        var boton = document.getElementById('reporte_year');
        boton.click();
        setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
    }
    /*********************************************************************************************************************************************/
    function ver_estado_orden(event) {
        if ($('#caja_orden_faltantes').val() != '') {
            $('#caja_orden_faltantes').css('border', '1px solid #cccccc');
            $.ajax({
                url: '/Shipping/po_reporte',
                data: "{'po':'" + $("#caja_orden_faltantes").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    $("#modal_orden_abierta").modal("hide");
                    $('#caja_orden_faltantes').val('');
                    /*alertify.success('Success!');
                    alertify.set('notifier', 'position', 'top-right');*/
                    return false;
                }
            });
            abrir_reporte_estado_orden();
        } else {
            event.preventDefault();
            $('#caja_orden_faltantes').css('border', '2px solid #e03f3f');
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }
    }
    function abrir_reporte_estado_orden() {
        $("#espera").css('display', 'inline');
        var boton = document.getElementById('reporte_estado_orden');
        boton.click();
        setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
    }
    /*********************************************************************************************************************************************/
    //
    function abrir_reporte_historial() {
        $("#espera").css('display', 'inline');
        var boton = document.getElementById('reporte_historial_ordenes');
        boton.click();
        setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
    }

    window.onload = function () {
        var a = document.getElementById("link");       
        a.onclick = function () {
            $("#espera").css('display', 'inline');
            var boton = document.getElementById('reporte_historial_ordenes');
            boton.click();
            setTimeout(function () { $("#espera").css('display', 'none'); }, 3000);
            return false;
        }
    }

    /*********************************************************************************************************************************************/
    /*********************************************************************************************************************************************/
    /*********************************************************************************************************************************************/
</script>
<a id="link_excel" href="@Url.Action("excel_pk", "Shipping")" style="visibility:hidden;">Daily</a>


<a id="reporte1" href="@Url.Action("excel_reporte_po_abierto", "Shipping")" style="visibility:hidden;">Daily</a>
<a id="reporte_estados" href="@Url.Action("excel_reporte_status", "Shipping")" style="visibility:hidden;">Daily</a>
<a id="reporte_pos_estilo" href="@Url.Action("excel_reporte_por_estilos", "Shipping")" style="visibility:hidden;">Daily</a>
<a id="reporte_year" href="@Url.Action("listado_year", "Shipping")" style="visibility:hidden;">Daily</a>
<a id="reporte_estado_orden" href="@Url.Action("excel_reporte_status_orden", "Shipping")" style="visibility:hidden;">Daily</a>
<a id="reporte_historial_ordenes" href="@Url.Action("estados_pedidos", "Shipping")" style="visibility:hidden;">Daily</a>
<style>
    th {
        text-align: center;
    }

    .breakhere {
        page-break-after: always
    }

    p {
        /*   border: 1px solid black !important;
        margin: 0 !important;*/
    }

    input, select, textarea {
        max-width: 100% !important;
    }

    .table-striped {
        cursor: pointer;
    }

    .edit_driver {
    }

        .edit_driver:hover {
            color: white !important;
            background: #3479bf !important;
            border-radius: 15px;
        }

    .estilos_tablas {
        width: 6em;
        background: none !important;
        border: none !important;
        box-shadow: none !important;
    }

    .custom_check {
        width: 1.3em !important;
        height: 1.3em !important;
    }

    .ui-autocomplete {
        z-index: 2147483647;
    }

    .dc_estilos {
        -webkit-appearance: none;
        border: none;
        background: #337ab7;
        box-shadow: none;
        color: white;
    }

    .dropbtn {
        background-color: #3479bf;
        color: white;
        padding: 16px;
        font-size: 18px;
        border: none;
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        color: black;
        min-width: 160px;
        box-shadow: 1px 5px 25px 1px rgba(0,0,0,0.2);
        z-index: 1;
    }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

    .menu {
        background: #3479bf;
        border-radius: 5px;
        border: solid 1px #3479bf;
        margin-bottom: .5em;
        margin: 1em;
    }

    .dropdown-content a:hover {
        /*background-color: #f1f1f1;
        color: black;*/
        background-color: #61b363;
        color: white;
    }

    .dropdown:hover .dropdown-content {
        display: block;
    }

    .modal-header-primary {
        color: #fff;
        padding: 9px 15px;
        border-bottom: 1px solid #eee;
        background-color: #3479bf;
        -webkit-border-top-left-radius: 5px;
        -webkit-border-top-right-radius: 5px;
        -moz-border-radius-topleft: 5px;
        -moz-border-radius-topright: 5px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }

    .x {
        transition: transform .25s ease-in-out;
        color: white !important;
    }

        .x:hover {
            transform: rotate(180deg);
            color: white !important;
        }

        .x:before {
            transform: rotate(45deg);
            transform-origin: center;
        }

        .x:after {
            transform: rotate(-45deg);
            transform-origin: center;
        }

    .load3 {
        position: fixed;
        z-index: 2001 !important;
        height: 100%;
        display: none;
        border: 0;
        padding: .5em 1em;
        overflow: auto;
        top: 0%;
        left: 0%;
        background: white;
        width: 100%;
        border: none;
        opacity: 0.8;
    }

    .imagen_loading2 {
        position: absolute;
        z-index: 2000 !important;
        top: 35%;
        left: 43%;
        width: 300px;
        height: 300px;
        background: url('../../Content/img/gif/loader3.gif');
    }
</style>
</div>
<div id="load_shipping" class="load3">
    <div id="spinner" class="imagen_loading2" style=""></div>
</div>
<div id="espera" class="" style="display:none; z-index:999; position:absolute; top:0; left:0; width:100%; height:100%; background:white; opacity:0.6; ">
    <div id="" class="" style="float:left; background-image:url('../../Content/img/gif/preloader.gif'); background-repeat: no-repeat; width:300px; height:160px; position:absolute; left:45%; top:25%; "></div>
    <div id="" class="" style="float:left; font-size:2em; color:#3479bf; top:50%; position:absolute; left:36%; width:100%;">We are making the report, please wait a few seconds</div>
</div>
<div class="container-fluid" style="padding-left:7em; padding-right:3em;">
    <center><h3>SHIPPING</h3></center>
    <div class="row">
        <div class="menu">
            <!-------------------- <div class="dropdown">
                <button class="dropbtn">DC</button>
                <div class="dropdown-content">
                    <a href="#modal_agregar_dc" data-toggle="modal" style="cursor:pointer;">Add DC</a>
                </div>
            </div>---------------------->

            <div class="dropdown">
                <button class="dropbtn" type="button" id="boton_recibo_fantasy" href="#modal_drivers" data-toggle="modal">
                    Drivers
                </button>
            </div>

            <div class="dropdown">
                <button class="dropbtn" type="button" id="boton_recibo_fantasy" href="#modal_direcciones" data-toggle="modal">
                    Addresses
                </button>
            </div>

            <div class="dropdown">
                <a href="@Url.Action("new_pk","Shipping")">
                    <button class="dropbtn" type="button" id="boton_recibo_fantasy">New PK</button>
                </a>
            </div>
            <div class="dropdown">
                <button class="dropbtn" type="button" id="boton_stock_fantasy" href="#modal_stock" data-toggle="modal">
                    Fantasy
                </button>
            </div>
            <div class="dropdown">
                <button class="dropbtn">Reports</button>
                <div class="dropdown-content">
                    <a href="#modal_fechas_ordenes_abiertas" data-toggle="modal">Open orders list </a>
                    <a href="#modal_orden_abierta" data-toggle="modal">See open order</a>
                    <a href="#modal_cerrar_pedido" data-toggle="modal">Close order </a>
                    <a href="#modal_estado_envio_estilos" data-toggle="modal">Order state</a>
                    <a href="#modal_pos_mismo_estilo" data-toggle="modal">Orders with same styles</a>
                    <a href="@Url.Action("listado_diario", "Shipping")">Packing daily list</a>
                    <a href="#modal_packing_fecha" data-toggle="modal">Packing list by year</a>                    
                    <a id="link" href="#" >Orders list</a>
                </div>
            </div>
        </div>
    </div>
    <!--------------------------------------------------------------------------------------------------------------------------->
    <div id="div_graficas" class="row" style="margin-left:0px !important;  width: 100%; margin:0px; ">
        <div class=" " style=" width: 100%; margin-top:1em;  ">
            <b style="left:0em; float:left; padding-top:.5em; ">Search </b>
            <input type="text" class="search_po form-control validacion" onkeyup="busqueda_pk()" placeholder="Type to search" id="caja_buscar_pk" style="width: 15em; float:left; margin-top:0px; margin-left:1em; margin-bottom:1em; ">
        </div><br />
        <div class="row" style="width: 100%;  height:600px !important; overflow:auto; margin:0px; border:3px solid #337ab7; border-radius:3px;">
            <table id="tabla_pks" class="table table-striped table-hover">
                <thead style="background:#3479bf; color:white;">
                    <tr><th>#</th><th>PK</th><th>DATE</th><th>CUSTOMER</th><th></th><th></th><th></th><th></th></tr>
                </thead>
                <tbody class="body_tabla_pk"></tbody>
            </table>
        </div>

    </div>
</div>
<!---------------------------MODALES----------------------------------------------------------------------------------------->
<input type="hidden" id="caja_id_driver">
<input type="hidden" id="caja_id_direccion">
<input type="hidden" id="caja_id_pk">

<div class="modal fade" id="modal_shipping_ratio" data-target="#modal_shipping_ratio">
    <div class="modal-dialog modal-lg" style="width:80% !important; height:80% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x cerrar_extras " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Examples, extras and damages</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_shipping_ratio">

                <div class="row" id="div_estilos_otros" style="display:none;margin:0px;padding:0px;">
                    <h3>Styles</h3>
                    <table id="tabla_estilos_otros" class="fold-table table table-striped table-hover ">
                        <thead style="background:#3479bf; color:white;"><tr><th>#</th><th>Style</th><th>Description</th><th>Color</th></tr></thead>
                        <tbody class="rows_estilos_otros"></tbody>
                    </table>
                </div>

                <div id="div_otros_tallas" class="row" style="display:none;margin:0px;padding:0px;">
                    <h3></h3>
                    <table id="tabla_otros" class="fold-table table table-striped table-hover " style="visibility:hidden;">
                        <thead class="cabeceras_otros" style="background:#3479bf; color:white;"></thead>
                        <tbody class="rows_otros"></tbody>
                    </table>
                    <button type="button" class="btn btn-primary btn mb-2" id="boton_guardar_otros" onclick="guardar_estilos_otros(event);" style="float:right; visibility:hidden; margin:1em;">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_ids" data-target="#modal_ids">
    <div class="modal-dialog modal-lg" style="width:80% !important; height:80% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Add ID's</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_agregar_ids">

                <div class="form-group  " id="div_id_number" style="margin-top:3em;margin-bottom:1.5em;">
                    <label class="">ID&nbsp; </label>
                    <input type="text" class=" form-control numeric" placeholder="Type ID" maxlength="10" ondrop="return false;" onpaste="return false;" style="width:25%;" id="caja_numero_id">&nbsp;
                </div>
                <div id="ppk_bk_id" class="row" style=" display:none;margin:0px;padding:0px;">
                    <table id="tabla_estilos_ids" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_estilos_ids" style="background:#3479bf; color:white;">
                            <tr><th>#</th><th>Style</th><th>Boxes</th><th>DC</th><th style="visibility:hidden;width:1em;"></th></tr>
                        </thead>
                        <tbody class="rows_tabla_estilos_ids"></tbody>
                    </table>
                </div>
                <div id="assort_id" class="row" style=" display:none;margin:0px;padding:0px;">
                    <table id="tabla_estilos_ids_assort" class="fold-table table table-striped table-hover ">
                        <thead class="cabecera_tabla_estilos_ids_assort" style="background:#3479bf; color:white;">
                            <tr><th>#</th><th>Assortment</th><th>Boxes</th><th style="visibility:hidden;width:1em;"></th></tr>
                        </thead>
                        <tbody class="rows_tabla_estilos_ids_assort"></tbody>
                    </table>
                </div>
                <button type="button" class="btn btn-primary btn-lg mb-2" id="boton_guardar_bp" onclick="guardar_ids(event);" style="float:right; margin:1em;">Save</button>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_edicion" data-target="#modal_edicion">
    <div class="modal-dialog modal-lg" style="width:80% !important; height:80% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:50% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Edit information</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_agregar_ids">

                <div class="row">
                    <div class="form-group ">
                        <div class="form-group col-sm-4 ">
                            <label for="caja_by_trans" class=" col-form-label">PK </label>
                            <input type="text" readonly class="form-control numeric " ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_pk_edit">
                        </div>
                        <div class="form-group col-sm-4 " id="div_driver_edit"></div>
                        <div class="form-group col-sm-4 " id="div_container_edit"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group ">
                        <div class="form-group col-sm-4 ">
                            <label for="caja_by_trans" class=" col-form-label pk_edit">Seal </label>
                            <input type="text" class="form-control numeric pk_edit" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_seal_pk_edit">
                        </div>
                        <div class="form-group col-sm-4 ">
                            <label for="caja_by_trans" class=" col-form-label pk_edit ">Replacement</label>
                            <input type="text" class="form-control validacion pk_edit" ondrop="return false;" onpaste="return false;" maxlength="50" id="caja_replacement_pk_edit">
                        </div>
                        <div class="form-group col-sm-4 ">
                            <label for="caja_by_trans" class=" col-form-label pk_edit "></label>
                            <button type="button" class="btn btn-primary btn-lg mb-2" id="boton_guardar_bp" onclick="guardar_edicion(event);" style="float:left; margin:1em;">Save</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_drivers" data-target="#modal_drivers">
    <div class="modal-dialog modal-lg" style="width:80% !important; height:80% !important; overflow:auto; padding:0px;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Drivers</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_drivers">
                <button type="button" id="boton_formulario_nuevo_conductor" style="margin-top: 0.1em; margin: .5em 2em;" class="btn  btn-danger ">New driver</button>

                <div class="row" id="formulario_nuevo_conductor" style="padding: 0em 2em; display:none;">
                    <div class="form-group col-sm-2 " id="carrier_div">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Name</label>
                        <input type="text" class=" form-control validacion check_driver" ondrop="return false;" onpaste="return false;" maxlength="150" id="caja_nombre_driver">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Plates</label>
                        <input type="text" class=" form-control validacion check_driver" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_plates">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Scac</label>
                        <input type="text" class=" form-control validacion check_driver" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_scac">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Caat</label>
                        <input type="text" class=" form-control numeric check_driver" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_caat">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Tractor</label>
                        <input type="text" class=" form-control validacion check_driver" ondrop="return false;" onpaste="return false;" id="caja_tractor">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <br />
                        <button type="button" style="margin-top: 0.1em; " class="btn btn-sm btn-success" onclick="guardar_driver(event)" data-toggle="modal">Save driver</button>
                    </div>
                </div>

                <div id="div_tabla_drivers" class=" " style="padding: 0em 2em;  visibility:visible;   width: 100%;   height:250px; ">
                    <div style="overflow:auto; height:250px; border: 1px solid #337ab7; border-radius: 5px;">
                        <table id="tabla_drivers" class="table table-striped results_e">
                            <thead class="cabecera_tabla" style="background:#3479bf; color:white;">
                                <tr><th>#</th><th>CARRIER</th><th>NAME</th><th>PLATES</th><th>SCAC</th><th>CAAT</th><th>TRACTOR</th><th>EDIT</th><th>DELETE</th></tr>
                            </thead>
                            <tbody class="body_tabla_drivers"></tbody>
                        </table>
                    </div>
                    <br />
                </div>

                <div id="editar_driver" class="row" style="padding:0em 2em; margin-top:2em; display:none;">

                    <div style="margin-bottom:3px;">
                        <h4 style="margin-left:2em; margin-bottom:1em; ">
                            Edit driver
                            <button type="button" id="boton_ocultar_edicion_conductor" style="margin-top: 0.1em; margin: .5em 2em;" class="btn btn-sm btn-danger ">Cancel</button>
                        </h4>
                    </div>
                    <div class="form-group ">
                        <div class="form-group col-sm-2 " id="carrier_div_edit">

                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Name</label>
                            <input type="text" class=" form-control validacion check_driver_edit" ondrop="return false;" onpaste="return false;" maxlength="150" id="caja_nombre_driver_edit">
                        </div>
                        <div class="form-group col-sm-2  ">
                            <label class=" col-form-label">Plates</label>
                            <input type="text" class=" form-control validacion check_driver_edit" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_plates_edit">
                        </div>
                    </div>
                    <div class="form-group ">
                        <div class="form-group col-sm-2  ">
                            <label class=" col-form-label">Scac</label>
                            <input type="text" class=" form-control validacion check_driver_edit" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_scac_edit">
                        </div>
                        <div class="form-group col-sm-2  ">
                            <label class=" col-form-label">Caat</label>
                            <input type="text" class=" form-control numeric check_driver_edit" ondrop="return false;" onpaste="return false;" maxlength="10" id="caja_caat_edit">
                        </div>
                        <div class="form-group col-sm-2 ">
                            <label class=" col-form-label">Tractor</label>
                            <input type="text" class=" form-control validacion check_driver_edit" ondrop="return false;" onpaste="return false;" id="caja_tractor_edit">
                        </div><br />
                    </div>
                        <div class="form-group col-sm-2  ">
                            <br />
                            <button type="button" style="margin-top: 0.1em; " class="btn btn-sm btn-success " onclick="guardar_driver_edit(event)" data-toggle="modal">Save changes</button>
                        </div>
                    </div>




                </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_direcciones" data-target="#modal_direcciones">
    <div class="modal-dialog modal-lg" style="width:80% !important; height:80% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Addresses</h4>
            </div>
            <div class="modal-body " id="contenedor_modal_direccion">
                <button type="button" id="boton_formulario_nueva_direccion" style="margin-top: 0.1em; margin: .5em 2em;" class="btn  btn-danger ">New address</button>

                <div class="row" id="formulario_nueva_direccion" style="padding: 0em 2em; display:none;">
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Name</label>
                        <input type="text" class=" form-control validacion check_dir" ondrop="return false;" onpaste="return false;" maxlength="50" id="caja_nombre_dir">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Street</label>
                        <input type="text" class=" form-control validacion check_dir" ondrop="return false;" onpaste="return false;" maxlength="80" id="caja_direccion_dir">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">City & State</label>
                        <input type="text" class=" form-control validacion check_dir" ondrop="return false;" onpaste="return false;" maxlength="80" id="caja_ciudad_dir">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Zip Code</label>
                        <input type="text" class=" form-control numeric check_dir" ondrop="return false;" onpaste="return false;" maxlength="7" id="caja_codigo_postal_dir">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <br />
                        <button type="button" style="margin-top: 0.1em; " class="btn btn-sm btn-success" onclick="guardar_direccion(event)" data-toggle="modal">Save address</button>
                    </div>
                </div>

                <div id="div_tabla_direcciones" class=" " style="padding: 0em 2em;  visibility:visible;   width: 100%;   height:250px; ">
                    <div style="overflow:auto; height:250px; border: 1px solid #337ab7; border-radius: 5px;">
                        <table id="tabla_direcciones" class="table table-striped results_e">
                            <thead class="cabecera_tabla" style="background:#3479bf; color:white;">
                                <tr><th>#</th><th>NAME</th><th>STREET</th><th>CITY/STATE</th><th>ZIP CODE</th><th></th><th></th></tr>
                            </thead>
                            <tbody class="body_tabla_direcciones"></tbody>
                        </table>
                    </div>
                    <br />
                </div>

                <div id="editar_direccion" class="row" style="padding:0em 2em; margin-top:2em; display:none;">

                    <h4 style="margin-left:2em; margin-bottom:1em;">Edit address <button type="button" id="boton_cerrar_edicion_direccion" style="margin-top: 0.1em; margin: .5em 2em;" class="btn btn-sm btn-danger ">x</button></h4>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Name</label>
                        <input type="text" class=" form-control validacion check_dir_edit" ondrop="return false;" onpaste="return false;" maxlength="50" id="caja_nombre_dir_edit">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Street</label>
                        <input type="text" class=" form-control validacion check_dir_edit" ondrop="return false;" onpaste="return false;" maxlength="80" id="caja_direccion_dir_edit">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">City & State</label>
                        <input type="text" class=" form-control validacion check_dir_edit" ondrop="return false;" onpaste="return false;" maxlength="80" id="caja_ciudad_dir_edit">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Zip Code</label>
                        <input type="text" class=" form-control numeric check_dir_edit" ondrop="return false;" onpaste="return false;" maxlength="7" id="caja_codigo_postal_dir_edit">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <br />
                        <button type="button" style="margin-top: 0.1em; " class="btn btn-sm btn-success" onclick="guardar_direccion_edicion(event)" data-toggle="modal">Save</button>
                    </div>
                </div>




            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_stock" data-target="#modal_stock">
    <div class="modal-dialog modal-lg" style="width:80% !important; height:80% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Stock</h4>
            </div>
            <h4 class="modal-title" style="padding-top:2em; padding-left:2em;">Enter the number of boxes per size</h4>
            <div class="modal-body " id="">
                <br /><br />
                <div id="div_tabla_stock_fantasy" class=" " style="padding: 0em 2em 0em 2em;  visibility:visible;   width: 100%;   height:500px; overflow:auto;">
                    <table id="tabla_stock_fantasy" class="table table-striped results_e" style="visibility:visible;">
                        <thead class="cabecera_tabla_stock_fantasy" style="background:#3479bf; color:white;">
                            <tr><th>Style</th><th>PO</th><th>SM</th><th>MD</th><th>LG</th><th>XL</th><th>2X</th><th><button type="button" style=" " class="btn btn btn-danger" onclick="agregar_stock()" data-toggle="modal">+</button></th></tr>
                        </thead>
                        <tbody class="body_tabla_stock_fantasy"></tbody>
                    </table>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="guardar_stock(event)" data-toggle="modal">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_fechas_ordenes_abiertas" data-target="#modal_fechas_ordenes_abiertas">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Open orders report</h4>
            </div>
            <h4 class="modal-title" style="padding-top:2em; padding-left:2em;"><b>Select dates</b></h4>
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-6 ">
                            <label for="caja_ship_date" class=" col-form-label ">From this date</label>
                            <input type="text" class="form-control order " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_rep1_inicio">
                        </div>
                        <div class="form-group col-sm-6 ">
                            <label for="caja_ship_date" class=" col-form-label ">To this date</label>
                            <input type="text" class="form-control order " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_rep1_final">
                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="enviar_fechas_reporte(event)" data-toggle="modal">See report</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_cerrar_pedido" data-target="#modal_cerrar_pedido">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Close an order</h4>
            </div>
            <h4 class="modal-title" style="padding-top:2em; padding-left:2em;"><b>Type the order to close</b></h4>
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-5 ">
                            <label for="caja_ship_date" class=" col-form-label ">Order</label>
                            <input type="text" class="form-control ordersc " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_order_close">
                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="close_order(event)" data-toggle="modal">Close order</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_estado_envio_estilos" data-target="#modal_estado_envio_estilos">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Order status</h4>
            </div>
            <h4 class="modal-title" style="padding-top:2em; padding-left:2em;"><b>Type the order</b></h4>
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-5 ">
                            <label for="caja_ship_date" class=" col-form-label ">Order</label>
                            <input type="text" class="form-control po " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_order_status">
                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="estado_estilos_orden(event)" data-toggle="modal">Get status</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_pos_mismo_estilo" data-target="#modal_pos_mismo_estilo">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Orders by style</h4>
            </div>
            <h4 class="modal-title" style="padding-top:2em; padding-left:2em;"><b>Type the style</b></h4>
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-5 ">
                            <label for="caja_ship_date" class=" col-form-label ">Style</label>
                            <input type="text" class="form-control styles " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_style_po">
                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="ordenes_por_estilo(event)" data-toggle="modal">Search</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_packing_fecha" data-target="#modal_packing_fecha">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Orders list by year</h4>
            </div>
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-5 " id="div_fecha_pk">

                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="packing_list(event)" data-toggle="modal">Search</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_orden_abierta" data-target="#modal_orden_abierta">
    <div class="modal-dialog modal-lg" style=" ">
        <div class="modal-content" style="  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Missing pieces from order</h4>
            </div>
            <h4 class="modal-title" style="padding-top:2em; padding-left:2em;"><b>Type the order</b></h4>
            <div class="modal-body " id="">
                <div id="" class=" " style=" ">
                    <div class="row" id="" style="padding:1em; ">
                        <div class="form-group col-sm-5 ">
                            <label for="caja_ship_date" class=" col-form-label ">Order</label>
                            <input type="text" class="form-control ordersc " onkeydown="upperCaseF(this)" ondrop="return false;" onpaste="return false;" maxlength="23" id="caja_orden_faltantes">
                        </div>
                    </div>
                    <button type="button" style="margin-left:2em; " class="btn btn btn-warning" onclick="ver_estado_orden(event)" data-toggle="modal">Report</button>
                </div>
            </div>
        </div>
    </div>
</div>







