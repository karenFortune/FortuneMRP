@{ ViewBag.Title = "PK"; Layout = "~/Views/Shared/_Layout.cshtml"; }
<link href="~/Content/base_m.css" rel="stylesheet" />
<script src="~/Content/Chart.js-master/moment.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>

<script>
    var cantidades_estilo_pedido;
    //VALIDACIONES
    $(document).on("input", ".numeric", function () {
        this.value = this.value.replace(/\D/g, '');
    });
    $(document).on("click", "a", function () {
        //setTimeout(function () { $("#loading").css('display', 'none'); }, 1000);
        $("#loading").css('display', 'none');
    });
    $(document).on("input", ".validacion", function () {
        var c = this.selectionStart,
            r = /[^a-zA-Z0-9áéíóúÁÉÍÓÚ .()&!@@/#%-]/,
            v = $(this).val();
        if (r.test(v)) {
            $(this).val(v.replace(r, ''));
            c--;
        }
        this.setSelectionRange(c, c);
    });
    $(document).on("input", ".tallas", function () { $('.tallas').autocomplete({ source: '@Url.Action("Autocomplete_tallas")' }); });
    $(document).on("input", ".dcs_usados", function () { $('.dcs_usados').autocomplete({ source: '@Url.Action("Autocomplete_dcs")' }); });
    var rows_tabla_labels, estilos_seleccionados, tipo_packing;
    var rows_dc, include_dc, error_total, indice;
    var active = 0;
    $(document).ready(function () {
        indice = 0;
        error_total = 0;
        rows_dc = 0; include_dc = 0;
        rows_tabla_labels = 0;
        estilos_seleccionados = 0;
        tipo_packing = 0;
        obtener_contenedores();
        llenar_po('pedidos');
        obtener_conductores();
        obtener_direcciones_pk();
        $('.js-example-basic-single').select2();
        $('#caja_contenedor_pk').select2();
        $('#caja_conductor_pk').select2();

        $('#check_ucclabels').on('change', function () {
            if (this.value != 0) {
                agregar_row_label();
                $('.div_tabla_labels').css('visibility', 'visible');
            } else {
                $('.div_tabla_labels').css('visibility', 'hidden');
            }
        });
    });
    //MOVERSE ENTRE LOS INPUT DE LA TABLA CON LAS FLECHAS DEL TECLADO
    //MOVERSE ENTRE LOS INPUT DE LA TABLA CON LAS FLECHAS DEL TECLADO    
    rePosition();
    $(document).keydown(function(e) {
        var inp = String.fromCharCode(e.keyCode);
        if ((!(/[a-zA-Z0-9-_ ]/.test(inp) || e.keyCode == 96)) && e.keyCode != 8){
          reCalculate(e);
          rePosition();
          // if key is an arrow key, don't type the user input.
          // if it is any other key (a, b, c, etc)
          // edit the text
          if (e.keyCode > 36 && e.keyCode < 41) {
            return false;
          }
        }
    });
    $('td').click(function() {
        active = $(this).closest('table tbody').find('td').index(this);
        rePosition();
    });
    function reCalculate(e) {
        var rows = $('.tblnavigate tbody tr').length;
        var columns = $('.tblnavigate tbody tr:eq(0) td').length;
        var temp;

        if (e.keyCode == 37) { //move left or wrap
            temp = active;
            while (temp > 0) {
                temp = temp - 1;
                // only advance if there is an input field in the td
                if ($('.tblnavigate tbody tr td').eq(temp).find('input').length != 0) {
                    active = temp;
                    break;
                }
            }
        }
        if (e.keyCode == 38) { // move up
            temp = active;
            while (temp - columns >= 0) {
                temp = temp - columns;
                // only advance if there is an input field in the td
                if ($('.tblnavigate tbody tr td').eq(temp).find('input').length != 0) {
                    active = temp;
                    break;
                }
            }
        }
        if (e.keyCode == 39) { // move right or wrap
            temp = active;
            while (temp < (columns * rows) - 1) {
                temp = temp + 1;
                // only advance if there is an input field in the td
                if ($('.tblnavigate tbody tr td').eq(temp).find('input').length != 0) {
                    active = temp;
                    break;
                }
            }
        }
        if (e.keyCode == 40) { // move down
            temp = active;
            while (temp + columns <= (rows * columns) - 1) {
                temp = temp + columns;
                // only advance if there is an input field in the td
                if ($('.tblnavigate tbody tr td').eq(temp).find('input').length != 0) {
                    active = temp;
                    break;
                }
            }
        }
    }
    function rePosition() {
        console.log(active);
        $('.active').removeClass('active');
        $('.tblnavigate tbody tr td').eq(active).addClass('active');
        $('.tblnavigate tbody tr td').find('input').removeClass('textClass');
        $('.tblnavigate tbody tr td').eq(active).find('input').addClass('textClass');
        $('.tblnavigate tbody tr td').eq(active).find('input').select();
        var input = $('.tblnavigate tbody tr td').eq(active).find('input').focus();
        scrollInView();
    }
    function scrollInView() {
        var target = $('.tblnavigate tbody tr td:eq(' + active + ')');
        if (target.length) {
            var top = target.offset().top;

            $('html,body').stop().animate({
                scrollTop: top - 100
            }, 400);
            return false;
        }
    }
    //MOVERSE ENTRE LOS INPUT DE LA TABLA CON LAS FLECHAS DEL TECLADO
    //MOVERSE ENTRE LOS INPUT DE LA TABLA CON LAS FLECHAS DEL TECLADO
    //--------------------------------------------------------------------------------------------------------------------------------------------
    //OBTENER ESTILOS DEL PEDIDO PRINCIPAL SIN GUARDAR EL PK
    //ESO SE HARA AL FINAL ANTES DE GUARDAR LOS ESTILOS
    //PARA EVITAR BASURA O PKS VACÍOS
    $(document).on("change", "#caja_pedido_pk", function () {
        $("#loading_pk").css('display', 'none');                        
        // $("#caja_pedido_estilo").val($("#caja_pedido_pk").val());
        var orden = $("#caja_pedido_pk option:selected").text();
        if (orden.includes("HOT")) {
            estilos_hottopic();
            //NO SE VA A MOVER NADA DE HOTTOPIC
        } else {
            $("#div_pedido_dropdown").css('visibility', 'visible');
            llenar_po('pedidos_estilos');
            setTimeout(function () {
                $('#caja_pedido_estilo').val($("#caja_pedido_pk").val()).trigger('change');
            }, 1000);
        }        
    });
    function llenar_customer() {
        $.ajax({
            url: '/Shipping/buscar_clientes',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                // += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_customer + '">' + item.customer + '</option>';
                });
                //html += '</select>';
                $(".cliente_po").append(html);
            }
        });
    }
    function obtener_contenedores() {
        $("#loading_pk").css('display', 'inline');
        $.ajax({
            url: '/Shipping/buscar_contenedores_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                //var html = '<label class="">Container&nbsp;</label> <select class="form-control pk ui search dropdown " id="caja_contenedor_pk" >';
                var html = '';
                // var html = '<select class="form-control " id="caja_contenedor_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_container + '">' + item.eco + '</option>';
                });
               // html += '</select>';
                $(".contenedores").append(html);
            }
        });
    }
    function obtener_conductores() {
        $.ajax({
            url: '/Shipping/buscar_conductores_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                //var html = '<label class="">Driver&nbsp;</label> <select class="form-control pk js-example-basic-single " id="caja_conductor_pk" >';
                var html = '';
                //var html = '<select class="form-control " id="caja_conductor_pk" >';
                $.each(result, function (key, item) {
                    html += '<option value="' + item.id_driver + '">' + item.driver_name + '</option>';
                });
                //html += '</select>';
                $(".conductores").append(html);
            }
        });
    }
    function obtener_direcciones_pk() {
        $.ajax({
            url: '/Shipping/buscar_direcciones_select',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '<label class="">Address&nbsp;</label> <select class="form-control pk" id="caja_direccion_pk" >';
                //var html = '<select class="form-control " id="caja_direccion_pk" >';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_direccion + '">' + item.nombre + '</option>';
                });
                html += '</select>';
                $("#div_shipto").html(html);
                $("#loading_pk").css('display', 'none');
            }
        });
    }
    function agregar_row_label() {
        var html = '<tr>' +
            '<td><input    maxlength="30" class="validacion form-control check_item_labels pk" id="" /></td>' +
            '<td><button type="button"  title="Delete row" class="btn btn-light deleteRowLabel"><b>-</b></button></td></tr>';
        $('.rows_ucc_labels').append(html);
        rows_tabla_labels++;
    }
    $(document).on("click", ".deleteRowLabel", function () {
        $(this).closest("tr").remove();
        rows_tabla_labels--;
        if (rows_tabla_labels <= 0) {
            $('#check_ucclabels').val('1').change();
            $('.div_tabla_labels').css('visibility', 'hidden');
        } else {
            $('.div_tabla_labels').css('visibility', 'visible');
        }0
    });
    function llenar_po(clase) {
        $.ajax({
            url: '/Shipping/buscar_pedidos',
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = ''; //'<label class="">PO&nbsp;</label> <select class="form-control js-example-basic-single" id="caja_pedido" >';
                html += '<option  value="0">Select</option>';
                $.each(result, function (key, item) {
                    html += '<option  value="' + item.id_pedido + '">' + item.po + '</option>';
                });
                //html += '</select>';
                $("."+clase).append(html);
            }
        });
    }
    var labels;
    var columnas_dc, rows_dc=0, columnas_estilos_dc;
    function redireccionarPagina() { window.location = '/Shipping/Index'; }
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////NUEVO JS PARA LOS NUEVOS PACKING LIST//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    var ppk = 0, bp = 0, ass = 0;
    var lista_estilo;
    var lista_assorts;
    var dcs=0;
    var dc_arr = [],cabecera_dc='';
    var tallas,idTallas;
    var columnas_dc_ppk, columnas_dc_bp, rows_dc_ppk, rows_dc_bp, estilos_seleccionados;
    function deshabilitar_campos_pk() {
        $('#caja_pedido_pk').prop('disabled', true);
       /* $(".pk").each(function () { $(this).prop('disabled', true); });
        $(".check_item_labels").each(function () { $(this).prop('disabled', true); });*/
    }
    
    /***************************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************************/
    /***************************************************************************************************************************************************************************/
        var estilos_seleccionados_ht;
        function estilos_hottopic() {
            $("#loading_pk").css('display', 'inline');
            $.ajax({
                url: '/Shipping/obtener_estilos_hottopic',
                data: "{'pedido':'" + $("#caja_pedido_pk").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (jsonData) {
                    lista_estilo = jsonData.Data.estilos;//AQUI ES DONDE VOY A JALAR LAS CANTIDADES POR ESTILO Y TALLA
                    tallas = jsonData.Data.tallas;
                    estilos_seleccionados_ht = 0;
                    $("#caja_number_po").val(jsonData.Data.number_po);
                    var html = '';
                    $(".rows_estilos_ht").html('');
                    $.each(lista_estilo, function (key, item) {  //ESTILOS PPK O BP EN LISTA ESTILOS                   
                        html += '<tr>';
                        html += '<td style="width:10%;">' + item.id_summary + '</td>';
                        html += '<td style="width:20%;">' + item.number_po + '</td>';
                        html += '<td style=" width:20%;">' + item.estilo + '</td>';
                        html += '<td style=" width:20%;">' + item.descripcion + '</td>';
                        html += '<td style=" width:20%;">' + item.color + '</td>';
                        var texto_empaque = '';
                        $.each(item.lista_empaque, function (key, empaque) {
                            $.each(empaque.lista_ratio, function (key, ratio) {
                                texto_empaque += ' ' + ratio.talla + ':' + ratio.ratio;
                            });
                        });
                        if (item.tipo_empaque == 1) {
                            bp++;
                            html += '<td style=" width:9%;">BP ' + texto_empaque + '</td>';
                        } else {
                            ppk++;
                            html += '<td style=" width:9%;">PPK ' + texto_empaque + '</td>';
                        }
                        html += '<td style=" border: none; width:1%;" ><input style="width:1%; border: none; visibility:hidden;  border: none;" value="' + item.tipo_empaque + '" /></td>';
                        html += '</tr>';
                    });
                    deshabilitar_campos_pk();//DESABILITAR CAMPOS //PENSANDO EN DISPLAY NONE PARA ESE DIV
                    $("#div_hottopic").css('display', 'inline');//TABLA DE ESTILOS VISIBLES
                    $(".rows_estilos_ht").html(html);
                    html = '<tr>';
                    html += '<th>#</th>';
                    html += '<th>Style</th>';
                    $.each(tallas, function (key, item) {
                        html += '<th>';
                        html += '<select disabled id="' + item.id_talla + '" style="border: 0px; outline: 0px; box-shadow: none;background: #337ab7;">'
                        html += '<option>' + item.talla + '</option></select>';
                        html += '</th>';
                    });
                    html += '<th>PPK</th>';
                    html += '<th>Cartons</th>';
                    html += '<th>Store</th>';
                    html += '<th>Type</th>';
                    html += '<th>Label</th>';
                    html += '<th>DC</th>';
                    html += '<th></th>';
                    html += '<th style="visibility:hidden; border: none;"></th>';//tipo de empaque
                    html += '<th style="visibility:hidden; border: none;"></th>';// indice
                    html += '</tr>';
                    $(".cabecera_tabla_temporal_ht").html(html);
                    $("#loading_pk").css('display', 'none');
                    contador_ht = 0;

                }
            });
        }
        $(document).on("dblclick", "#tabla_estilos_ht tr", function () {
            var row = this.rowIndex;
            var id = $('#tabla_estilos_ht tr:eq(' + row + ') td:eq(0)').html();
            var number_po = $('#tabla_estilos_ht tr:eq(' + row + ') td:eq(1)').html();
            var tipo = $('#tabla_estilos_ht tr:eq(' + row + ') td:eq(5)').html();
            var estilo = $('#tabla_estilos_ht tr:eq(' + row + ') td:eq(2)').html();
            var descripcion = $('#tabla_estilos_ht tr:eq(' + row + ') td:eq(3)').html();
            var tipo_empaque = $('#tabla_estilos_ht tr:eq(' + row + ')').find('td:eq(6) input').val();//$('#tabla_estilos tr:eq(' + row + ') td:eq(5)').val();
            agregar_fila_ht(id + "&" + number_po + "-" + tipo + "&" + tipo_empaque);
            //agregar_fila_ht(id + "&" + estilo + " " + descripcion + "&" + tipo_empaque + "&" + number_po);
        });
        //AGREGAR FILA A TABLA TEMPORAL
        var contador_ht = 0;
        function agregar_fila_ht(informacion) {
            obtener_labels_tabla();
            var contador_for = $("#caja_repeticiones_fila").val();        
            for (var x = 0; x < contador_for; x++) {
                contador_ht++;
                var data = informacion.split("&");
                var html = '';
                var html = '<tr>' +
                    '<td>' + data[0] + '</td>' + //ID
                    '<td>' + data[1] + '</td>';//ESTILO
                $.each(tallas, function (key, item) {
                    html += '<td><input    maxlength="6" class="numeric form-control " value="0" style="width: 4em; padding: 1px 2px;" /></td>'//TALLAS
                });
                html += '<td><input    maxlength="6" class="numeric form-control " value="0" style="padding: 1px 2px;" /></td>'//PPK
                html += '<td><input    maxlength="6" class="numeric form-control " value="0" style="padding: 1px 2px;"  /></td>'//CARTONES
                html += '<td><input    maxlength="6" class="validation form-control " value="" style="padding: 1px 2px;"  /></td>';//STORE
                html += '<td><select class="form-control tipo_envio_ht" style="width:5em; padding: 1px 2px;" >' +
                    '<option>NONE</option><option>INITIAL</option><option>ECOM</option><option>RPLN</option><option>EXT</option><option>DMG</option>';//TIPO 
                html += '</select ></td>';

                html += '<td><select class="form-control label_envio_ht"   style="width:7em; padding: 1px 2px;"><option>NONE</option>';
                if (labels != 'N/A') {//tipo ucc label
                    var label = labels.split('*');//tipo ucc label
                    for (var i = 1; i < label.length; i++) { html += '<option>' + label[i] + '</option >'; }//tipo ucc label
                }//tipo ucc label
                html += '</select ></td>';//tipo ucc label
                html += '<td><input     maxlength="6" class="validation form-control "  style="padding: 1px 2px;"  /></td>';//DC
                html += '<td><button type="button"  title="Delete row" class="btn btn-light deleteRowHT"><b>-</b></button></td>';
                html += '<td style="visibility:hidden; border: none; width:1px;">' + data[2] + '</td>';//TIPO EMPAQUE
                html += '<td style="visibility:hidden; border: none; width:1px;">' + contador_ht + '</td>';//indice
                estilos_seleccionados_ht++;
                $('.rows_tabla_temporal_ht').append(html);
            }
        }
        //ELIMINAR FILAS TEMPORALES
        $(document).on("click", ".deleteRowHT", function () {
            $(this).closest("tr").remove();
            estilos_seleccionados_ht--;
        });
        var summary_ht, tallas_ht, ppk_ht, cartones_ht, store_ht, tipo_ht, label_ht, dc_ht, empaque_ht, indice_ht, ponumero_ht, size_ht;
        function revisar_informacion_pk_ht(event) {
            $("#loading_pk").css('display', 'inline');
            var error = 0; var total_tallas_ht = 0;
              label = '';
            if ($("#caja_pedido_pk").val() == '' || $("#caja_pedido_pk").val()=='0') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
            $(".check_item_labels").each(function () {
                if ($(this).val() == '') {
                    $(this).css('border', '2px solid #e03f3f');
                    error++;
                } else {
                    $(this).css('border', '1px solid #cccccc');
                }
            });
            if ($("#check_ucclabels").val()!='1') {
                $('#tabla_ucc_labels tbody tr').each(function () {
                    labels += "*" + $(this).find('td:eq(0) input').val();
                });
            } else {
                labels = 'N/A';
            }                    
            $.each(tallas, function (key, item) { total_tallas_ht++; });
            summary_ht = ''; tallas_ht = ''; ppk_ht = ''; cartones_ht = ''; store_ht = ''; tipo_ht = ''; label_ht = ''; dc_ht = ''; empaque_ht = ''; indice_ht = ''; ponumero_ht = ''; size_ht = '';
            $('#tabla_temporal_ht tbody tr').each(function () {
                summary_ht += '*' + $(this).find('td:eq(0)').text();//SUMMARY
                var temporal = $(this).find('td:eq(1)').text();
                var temporal_array = temporal.split('-');
                ponumero_ht += '*' + temporal_array[0];
                var i;
                tallas_ht += '*';
                /*if ($(this).find('td:eq(' + i + ') input').val() == '') {
                    tallas_ht += '&0';
                } else {
                    tallas_ht += '&' + $(this).find('td:eq(' + i + ') input').val();
                }
                i++;*/

                for (i = 2; i < (total_tallas_ht + 2); i++) {
                    if ($(this).find('td:eq(' + i + ') input').val() == '') {
                        tallas_ht += '&0';
                    } else {
                        tallas_ht += '&' + $(this).find('td:eq(' + i + ') input').val();
                    }
                }

                if ($(this).find('td:eq(' + i + ') input').val() == '') {
                    ppk_ht += '*0';
                } else {
                    ppk_ht += '*' + $(this).find('td:eq(' + i + ') input').val();
                } i++; //   
                if ($(this).find('td:eq(' + i + ') input').val() == '') {
                    cartones_ht += '*0';
                } else {
                    cartones_ht += '*' + $(this).find('td:eq(' + i + ') input').val();
                } i++; //  
                if ($(this).find('td:eq(' + i + ') input').val() == '' || $(this).find('td:eq(' + i + ') input').val() == '0') {
                    store_ht += '*N/A';
                } else {
                    store_ht += '*' + $(this).find('td:eq(' + i + ') input').val();
                } i++; //       

                tipo_ht += '*' + $(this).find(".tipo_envio_ht").val(); i++; //       
                label_ht += '*' + $(this).find('.label_envio_ht').val(); i++; //  
                if ($(this).find('td:eq(' + i + ') input').val() == '') {
                    dc_ht += '*0';
                } else {
                    dc_ht += '*' + $(this).find('td:eq(' + i + ') input').val();
                } i = i + 2; //       
                empaque_ht += '*' + $(this).find('td:eq(' + i + ')').text(); i++; //   
                indice_ht += '*' + $(this).find('td:eq(' + i + ')').text(); i++; // 
            });
            $.each(tallas, function (key, item) {
                size_ht += '*' + item.id_talla;
            });
            if (error == 0) {
                $("#loading_pk").css('display', 'none');
                enviar_datos_pk_ht();
            } else {
                $("#loading_pk").css('display', 'none');
                event.preventDefault();
                alertify.alert('Error!', 'Check empty fields, please');
                return false;
            }
        }
    function enviar_datos_pk_ht() { //ENVIAR DATOS PACKING LIST- INFORMACIÓN GENERAL, NOS REGRESA LOS ESTILOS DE ESA ORDEN
        $("#loading_pk").css('display', 'inline');
        var seal, replacement;
        if ($("#caja_seal_pk").val() == '') { seal = 'N/A'; } else { seal = $("#caja_seal_pk").val(); }
        if ($("#caja_replacement_pk").val() == '') { replacement = 'N/A'; } else { replacement = $("#caja_replacement_pk").val(); }   
        var unico_forzado = 0,pk=0;
        if ($("#caja_unico_forzado").is(":checked")) { unico_forzado = 1; } 
        if ($("#caja_sin_pk").is(":checked")) { pk = 1; } 
        $.ajax({
            url: '/Shipping/guardar_pk',
            data: "{'pedido':'" + $("#caja_pedido_pk").val() + "','address':'" + $("#caja_direccion_pk").val() + "','driver':'" + $("#caja_conductor_pk").val() + "','container':'" + $("#caja_contenedor_pk").val() + "','seal':'" + seal + "','replacement':'" + replacement + "','tipo':'" + $("#caja_tipo_pk").val() + "','labels':'" + labels + "','type_labels':'" + $("#check_ucclabels").val() + "','num_envio':'" + $("#caja_num_envio").val() + "','tipo_packing':'1','sin_partes':'"+unico_forzado+"','pk_id':'"+pk+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                 enviar_estilos_pk_ht();
                //$("#loading_pk").css('display', 'none');
                // $("#caja_pedido_estilo").val($("#caja_pedido_pk").val());
                /*var orden = $("#caja_pedido_pk option:selected").text();
                if (orden.includes("HOT")) {
                    estilos_hottopic();
                } else {
                    $("#div_pedido_dropdown").css('visibility', 'visible');
                    llenar_po('pedidos_estilos');
                    setTimeout(function () {
                        $('#caja_pedido_estilo').val($("#caja_pedido_pk").val()).trigger('change');
                    }, 1000);
                }*/
            }
        });  
    }
        function enviar_estilos_pk_ht() {
            $("#loading_pk").css('display', 'inline');
            var unico_forzado = 0,pk=0;
            
            $.ajax({
                url: '/Shipping/guardar_pk_estilos_ht',
                data: "{'size':'" + size_ht + "','summary':'" + summary_ht + "','ponumero':'" + ponumero_ht + "','talla':'" + tallas_ht + "','ppk':'" + ppk_ht + "','carton':'" + cartones_ht + "','store': '" + store_ht + "', 'tipo': '" + tipo_ht + "', 'label': '" + label_ht + "', 'dc': '" + dc_ht + "','empaque':'" + empaque_ht + "','indice':'" + indice_ht + "'}",                
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {
                    var error = result;
                    $("#loading_pk").css('display', 'none');
                    if (error == 1) {
                        event.preventDefault();
                        alertify.alert('Error!', 'Check the quantities, please');
                    } else {
                        alertify.success('Succes!');
                        alertify.set('notifier', 'position', 'top-right');
                        redireccionarPagina();
                    }

                }
            });
        }
        /**********************************************************************************************************************************************************************************/
        /**********************************************************************************************************************************************************************************/
        /**********************************************************************************************************************************************************************************/
        /**********************************************************************************************************************************************************************************/
        /**********************************************************************************************************************************************************************************/
        $(document).on("change", "#caja_pedido_estilo", function () {
            estilos_po();
        });
        function obtener_labels_tabla() {
            labels = '';
            if ($("#check_ucclabels").val()!='0') {
                $('#tabla_ucc_labels tbody tr').each(function () {
                    labels += "*" + $(this).find('td:eq(0) input').val();
                });
            } else {
                labels = 'N/A';
            }
        }
        function estilos_po() {
            $("#loading_pk").css('display', 'inline');
            $.ajax({
                url: '/Shipping/obtener_estilos_orden',
                data: "{'pedido':'" + $("#caja_pedido_estilo").val() + "'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (jsonData) {
                    // cantidades_estilo_pedido = jsonData.Data.cantidades_estilos;//AQUI ES DONDE VOY A JALAR LAS CANTIDADES POR ESTILO Y TALLA
                    lista_estilo = jsonData.Data.estilos;//AQUI ES DONDE VOY A JALAR LAS CANTIDADES POR ESTILO Y TALLA
                    lista_assorts = jsonData.Data.assorts;//AQUI ES DONDE VOY A JALAR LAS CANTIDADES POR ESTILO Y TALLA
                    dcs = jsonData.Data.dc;
                    if (indice == 0) {
                        tallas = jsonData.Data.tallas;
                    }
                    //estilos_seleccionados = 0;                    
                    $("#caja_number_po").val(jsonData.Data.number_po);
                    var html = '';                    
                    $(".rows_estilos").html('');
                    $.each(lista_estilo, function (key, item) {  //ESTILOS PPK O BP EN LISTA ESTILOS
                        $.each(item.lista_empaque, function (key, e) {
                            html += '<tr>';
                            html += '<td style="visibility:hidden; border: none; width:6%;">' + item.id_summary + '</td>';
                            html += '<td style=" width:15%;"><p>' + (item.estilo).replace(/\s/g, ' ') + '</p></td>';
                            if (e.tipo_empaque == 5||e.tipo_empaque == 4) {                                
                                html += '<td style=" width:24%;">' + item.descripcion +' '+(e.packing_name).replace(/\s/g, ' ')+'</td>';
                            } else {
                                html += '<td style=" width:24%;">' +(item.descripcion).replace(/\s/g, ' ') + '</td>';
                            }
                            //html += '<td style=" width:24%;">' + item.descripcion + '</td>';
                            html += '<td style=" width:10%;">' + item.color + '</td>';
                            
                             var texto_empaque = '';
                            $.each(e.lista_ratio, function (key, ratio) {
                                if (e.tipo_empaque == 1 || e.tipo_empaque == 5) {
                                    texto_empaque += ' ' + ratio.talla + ':' + ratio.piezas;
                                } else {
                                    texto_empaque += ' ' + ratio.talla + ':' + ratio.ratio;
                                }
                             });                                 
                            if (e.tipo_empaque == 1 || e.tipo_empaque == 5) {
                                bp++;
                                html += '<td style=" width:43%;">BP ' + texto_empaque + '</td>';
                            } else {
                                ppk++;                                
                                html += '<td style=" width:43%;">PPK ' + texto_empaque + '</td>';
                            }
                            html += '<td style="visibility:hidden;  width:1%; border: none;" >' + e.tipo_empaque + '</td>';
                            if (e.tipo_empaque == 4) {
                                html += '<td style=" visibility:hidden; width:1%; border: none;" >' + e.number_ppk + '*'+e.packing_name+'</td>';
                            } else {
                                if (e.tipo_empaque == 5) {
                                    html += '<td style=" visibility:hidden; width:1%; border: none;" >' + e.packing_name + '</td>';
                                } else {
                                    html += '<td style="visibility:hidden;  width:1%; border: none;" >0</td>';
                                }                                
                            }
                            html += '</tr>';
                        });
                    });
                    $.each(lista_assorts, function (key, item) { //ASSORMENTS EN LISTA DE ESTILOS
                        html += '<tr>';
                        html += '<td style=visibility:hidden; "width:6%; border: none; ">' + item.id_assortment + '</td>';
                        html += '<td style=" width:15%;">' + item.nombre + '</td>';

                        html += '<td style=" width:24%;">';
                        $.each(item.lista_estilos, function (key, e) {
                            html += '<p>' + e.estilo + ' ' + e.descripcion + '</p>';  //DESCRIPCIÓN DE LOS ESTILOS DE LOS ASSORT
                        });
                        html += '</td>';
                        html += '<td style=" width:10%;"></td>';
                        html += '<td style=" width:43%;">ASSP</td>';
                        html += '<td  style=" visibility:hidden; border: none; width:1%;">3</td>';
                        html += '<td style="visibility:hidden;  width:1%; border: none;" >0</td>';
                        html += '</tr>';
                        ass++;
                    });
                    
                    deshabilitar_campos_pk();//DESABILITAR CAMPOS //PENSANDO EN DISPLAY NONE PARA ESE DIV
                    $("#div_estilos").css('display', 'inline');//TABLA DE ESTILOS VISIBLES
                    $(".rows_estilos").html(html);
                    $("#loading_pk").css('display', 'none');
                    
                    if (indice == 0) {
                        $(".cabecera_tabla_temporal").html('');
                        html = '<tr>';
                        html += '<th>#</th>';
                        html += '<th>Style</th>';
                        $.each(tallas, function (key, item) {
                            html += '<th>';
                            html += '<select disabled id="' + item.id_talla + '" style="border: 0px; outline: 0px; box-shadow: none;background: #337ab7;">'
                            html += '<option>' + item.talla + '</option></select>';
                            html += '</th>';
                        });
                        html += '<th>Bxs</th>';
                        html += '<th>Store</th>';
                        html += '<th>Type</th>';
                        html += '<th>Label</th>';
                        html += '<th>DC</th>';
                        html += '<th>Surplus</th>';
                        html += '<th></th>';
                        html += '<th style="visibility:hidden; border: none;"></th>';//tipo de empaque
                        html += '<th style="visibility:hidden; border: none;"></th>';//indice
                        html += '<th style="visibility:hidden; border: none;"></th>';//number_ppk o packing_name
                        html += '</tr>';
                        $(".cabecera_tabla_temporal").html(html);
                    }


                }

                 
            });
           
        }        
        //DOBLE CLICK AGREGAR FILA A TABLA TEMPORAL
        $(document).on("dblclick", "#tabla_estilos tr", function () {
            var row = this.rowIndex;
            var id = $('#tabla_estilos tr:eq(' + row + ') td:eq(0)').html();
            var number_ppk = $('#tabla_estilos tr:eq(' + row + ') td:eq(6)').html();
            var estilo = '';
            var empaque = $('#tabla_estilos tr:eq(' + row + ') td:eq(4)').html();
            var descripcion = $('#tabla_estilos tr:eq(' + row + ') td:eq(2)').html() + ' ' + empaque;            
            var tipo_empaque = $('#tabla_estilos tr:eq(' + row + ') td:eq(5)').html();//$('#tabla_estilos tr:eq(' + row + ') td:eq(5)').val();
            if (tipo_empaque != 3) {
                agregar_fila(id + "&" + estilo + " " + descripcion + "&" + tipo_empaque+ "&" + number_ppk);
            } else {
                agregar_fila(id + "&" + estilo + empaque + "&" + tipo_empaque+ "&" + number_ppk);
            }
            //gregar_fila(id + "&" + estilo + " " + descripcion + "&" + tipo_empaque);
        });
        //AGREGAR FILA A TABLA TEMPORAL
        
    function agregar_fila(informacion) {
        var orden = $("#caja_pedido_pk option:selected").text();
        var contador_for = $("#caja_repeticiones_fila").val();        
        for (var x = 0; x < contador_for; x++) {
            indice++;
            obtener_labels_tabla();
            var data = informacion.split("&");
            var html = '';
            var html = '<tr>' +
                '<td style="width:1px; border: none;">' + data[0] + '</td>' + //ID
                '<td>' + data[1] + '</td>';//ESTILO
            $.each(tallas, function (key, item) {
                html += '<td><input    maxlength="6" class="numeric form-control " value="0" style=" padding: 1px 2px;" /></td>'//TALLAS
            });
            html += '<td><input    maxlength="6" class="numeric form-control bxs " value="0"   /></td>';  //BXS
            html += '<td><input    maxlength="6" class="validation form-control store" id="" /></td>';  //STORE
            html += '<td><select class="form-control tipo_envio" style="width:6em;" >';
            html += '<option>NONE</option><option>INITIAL</option><option>ECOM</option><option>RPLN</option><option>EXT</option><option>DMG</option>';//TIPO 
            html += '</select ></td>';
            html += '<td><select class="form-control label_envio"   style="width:7em;"><option>NONE</option>';
            if (labels != 'N/A') {//tipo ucc label
                var label = labels.split('*');//tipo ucc label
                for (var i = 1; i < label.length; i++) { html += '<option>' + label[i] + '</option >'; }//tipo ucc label
            }//tipo ucc label
            html += '</select ></td>';//tipo ucc label
            html += '<td><input    maxlength="6" class="validation form-control "  style="width:6em;"  /></td>';//DC
            html += '<td><select class="form-control sobrante_envio" style="width:6em;" ><option value="0">No</option><option value="1">Yes</option></select></td>'; //SOBRANTE              
            html += '<td><button type="button"  title="Delete row" class="btn btn-light deleteRow"><b>-</b></button></td>';
            html += '<td style="visibility:hidden; border: none; width:1px;">' + data[2] + '</td>';//TIPO EMPAQUE
            html += '<td style="visibility:hidden; border: none; width:1px;">' + indice + '</td>';//INDICE
            html += '<td style="visibility:hidden; border: none; width:1px;">' + data[3] + '</td></tr>';//NUMBER PPK            
            estilos_seleccionados++;
            $('#div_tabla_temporal').css('visibility', 'visible');
            $('.rows_tabla_temporal').append(html);
        }
            
    }
        //ELIMINAR FILAS TEMPORALES
        $(document).on("click", ".deleteRow", function () {
           // var temporal_index = $(this).closest("tr").find('td:eq(11)').html();            
            $(this).closest("tr").remove();
            estilos_seleccionados--;
            if (estilos_seleccionados != 0) {
                $('#div_tabla_temporal').css('visibility', 'visible');
            } else {
                $('#div_tabla_temporal').css('visibility', 'hidden');
            }
        });      
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //GUARDAR INFORMACIÓN DEL ENVÍO EN DCS //check_dc
        var error_dc = 0;        
        var summary,  box, id_talla,cantidad_size, store, type, dc_summary, empaque,  sobrante, label,num_ppk,indice_tabla;
        function revisar_informacion_pk(event) {
            $("#loading_pk").css('display', 'inline');
            var error = 0;   label = '';
            if ($("#caja_pedido_pk").val() == '' || $("#caja_pedido_pk").val()=='0') {
                $(this).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $(this).css('border', '1px solid #cccccc');
            }
            $(".check_item_labels").each(function () {
                if ($(this).val() == '') {
                    $(this).css('border', '2px solid #e03f3f');
                    error++;
                } else {
                    $(this).css('border', '1px solid #cccccc');
                }
            });
            labels = '';
            if ($("#check_ucclabels").val()!='0') {
                $('#tabla_ucc_labels tbody tr').each(function () {
                    labels += "*" + $(this).find('td:eq(0) input').val();
                });
            } else {
                labels = 'N/A';
            }                    
            summary = '';  box = ''; cantidad_size = ''; store = ''; type = ''; dc_summary = ''; empaque = '';  sobrante = ''; label = '';num_ppk = '';indice_tabla = '';
            var total_tallas_tabla = 0;
            $.each(tallas, function (key, item) { total_tallas_tabla++; });
            
            $('#tabla_temporal tbody tr').each(function () {
                summary +='*'+ $(this).find('td:eq(0)').text();//SUMMARY
                cantidad_size += '*';
                var i;   
                var con_numero = 0;
                for (i = 2; i < (total_tallas_tabla + 2); i++) {
                    if ($(this).find('td:eq(' + i + ') input').val() != '' && $(this).find('td:eq(' + i + ') input').val() != 0) {
                        con_numero++;
                    }                    
                    if ($(this).find('td:eq(' + i + ') input').val() == '') {
                        cantidad_size += '&0';
                    } else {
                        cantidad_size += '&' + $(this).find('td:eq(' + i + ') input').val();
                    }
                }
                //BOXES
                if ($(this).find('td:eq(' + (i + 7) + ') ').html() == 2 || $(this).find('td:eq(' + (i + 7) + ') ').html() == 4 || $(this).find('td:eq(' + (i + 7) + ') ').html() == 3) { //ppk-ass
                    if ($(this).find('td:eq(' + i + ') input').val() == '' || $(this).find('td:eq(' + i + ') input').val() == '0') {
                        $(this).find('td:eq(' + i + ') input').css('border', '2px solid #e03f3f');
                        error++;
                    } else {
                        box += '*'+$(this).find('td:eq(' + i + ') input').val();
                        $(this).find('td:eq(' + i + ') input').css('border', '1px solid #cccccc');
                    }                       
                } else{ //bp
                    $(this).find('td:eq(' + i + ') input').css('border', '1px solid #cccccc');
                    if ($(this).find('td:eq(' + i + ') input').val() == '') {
                        box += '*0';
                    } else {
                         box += '*'+$(this).find('td:eq(' + i + ') input').val();
                    }
                }
                if ($(this).find(".tipo_envio").val()=='EXT'||$(this).find(".tipo_envio").val()=='DMG') {
                     if ($(this).find('td:eq(' + i + ') input').val() == '' || $(this).find('td:eq(' + i + ') input').val() == '0') {
                        $(this).find('td:eq(' + i + ') input').css('border', '2px solid #e03f3f');
                        error++;
                    } else {
                        box += '*'+$(this).find('td:eq(' + i + ') input').val();
                        $(this).find('td:eq(' + i + ') input').css('border', '1px solid #cccccc');
                    }
                }
                i++;
                //BOXES
                //STORE
                if ($(this).find('td:eq(' + i + ') input').val() != "") {
                    store+='*'+ $(this).find('td:eq(' + i + ') input').val();
                } else {
                    store+='*'+ "N/A";//STORE
                } i++;
                //STORE
                //TYPE
                type += '*' + $(this).find(".tipo_envio").val();
                if ($(this).find(".tipo_envio").val()=='EXT'||$(this).find(".tipo_envio").val()=='DMG') {
                    if (con_numero == 0) { error++;}
                }
                i++;
                //TYPE
                //LABEL
                label += '*' + $(this).find('.label_envio').val(); i++;
                //LABEL
                //DC
                if ($(this).find('td:eq(' + i + ') input').val() != "") {
                    dc_summary +='*'+ $(this).find('td:eq(' + i + ') input').val();
                } else {
                    dc_summary += "*0";
                } i++;
                //DC
                //SOBRANTE
                sobrante += '*' + $(this).find('.sobrante_envio').val(); i++; i++;              
                //SOBRANTE
                //TIPO_EMPAQUE
                empaque += '*' + $(this).find('td:eq(' + i + ') ').html();
                var cds = $(this).find('td:eq(' + i + ') ').html();
                //alert(cds);
                if (cds == 1 && con_numero==0) {
                    error++;
                }i++;
                //TIPO_EMPAQUE
                //INDICE
                indice_tabla += '*' + $(this).find('td:eq(' + i + ') ').html();i++;
                //INDICE
                //NUMBER_PPK
                num_ppk += '&' + $(this).find('td:eq(' + i + ') ').html();i++;
                //NUMBER_PPK                
            });
            id_talla = '';
            $.each(tallas, function (key, item) {
                id_talla += '*' + item.id_talla;
            });            
            if (error == 0) {
                $("#loading_pk").css('display', 'none');
                enviar_datos_pk();               
            } else {
                $("#loading_pk").css('display', 'none');
                event.preventDefault();
                alertify.alert('Error!', 'Check empty fields, please');
                return false;
            }
        }
   
    function enviar_estilos_pk() {
        $("#loading_pk").css('display', 'inline');
        $.ajax({
            url: '/Shipping/guardar_pk_estilos',
            data: "{'summary':'" + summary + "','box':'" + box + "','talla':'" + id_talla + "','cantidad_size':'" + cantidad_size + "','store':'" + store + "','type': '" + type + "', 'dc': '" + dc_summary + "', 'empaque': '" + empaque + "','indice':'" + indice_tabla + "','label':'" + label + "','sobrante':'" + sobrante +"','tipo_packing':'0','num_ppk':'"+num_ppk+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var error = result;
                $("#loading_pk").css('display', 'none');
                if (error == 1) {
                    event.preventDefault();
                    alertify.alert('Error!', 'Check the quantities, please');
                    //alert("ERRORRRR");
                } else {
                    alertify.success('Succes!');
                    alertify.set('notifier', 'position', 'top-right');
                    //alert("Si se guardó");
                    redireccionarPagina(); 
                }
            }
        });
    }

    function guardar_pk(event) {
       /* var error = 0; 
        if (error == 0) {
            $("#load_shipping").css('display', 'inline');
            
            //alert($("#caja_tipo_pk").val());
            $("#load_shipping").css('display', 'none');
        } else {
            $("#load_shipping").css('display', 'none');
            event.preventDefault();
            alertify.alert('Error!', 'Check empty fields, please');
            return false;
        }*/
    }
    function enviar_datos_pk() { //ENVIAR DATOS PACKING LIST- INFORMACIÓN GENERAL, NOS REGRESA LOS ESTILOS DE ESA ORDEN
        $("#loading_pk").css('display', 'inline');
        var seal, replacement;
        if ($("#caja_seal_pk").val() == '') { seal = 'N/A'; } else { seal = $("#caja_seal_pk").val(); }
        if ($("#caja_replacement_pk").val() == '') { replacement = 'N/A'; } else { replacement = $("#caja_replacement_pk").val(); }       
        var tipo = 1;
        if ($('#caja_tipo_pk').val() == 2) { tipo = 9; } else { tipo = 1; }
        var unico_forzado = 0,pk=0;
        if ($("#caja_unico_forzado").is(":checked")) { unico_forzado = 1; } 
        if ($("#caja_sin_pk").is(":checked")) { pk = 1; } 
        $.ajax({
            url: '/Shipping/guardar_pk',
            data: "{'pedido':'" + $("#caja_pedido_pk").val() + "','address':'" + $("#caja_direccion_pk").val() + "','driver':'" + $("#caja_conductor_pk").val() + "','container':'" + $("#caja_contenedor_pk").val() + "','seal':'" + seal + "','replacement':'" + replacement + "','tipo':'" + $("#caja_tipo_pk").val() + "','labels':'" + labels + "','type_labels':'" + $("#check_ucclabels").val() + "','num_envio':'" + $("#caja_num_envio").val() + "','tipo_packing':'"+tipo+"','sin_partes':'"+unico_forzado+"','pk_id':'"+pk+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                 enviar_estilos_pk();
                //$("#loading_pk").css('display', 'none');
                // $("#caja_pedido_estilo").val($("#caja_pedido_pk").val());
                /*var orden = $("#caja_pedido_pk option:selected").text();
                if (orden.includes("HOT")) {
                    estilos_hottopic();
                } else {
                    $("#div_pedido_dropdown").css('visibility', 'visible');
                    llenar_po('pedidos_estilos');
                    setTimeout(function () {
                        $('#caja_pedido_estilo').val($("#caja_pedido_pk").val()).trigger('change');
                    }, 1000);
                }*/
            }
        });  
    }
 ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
 /////////////////////////NUEVO JS PARA LOS NUEVOS PACKING LIST//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

</script>
<style>
   /* td.active{
    border:2px solid #3c763d;
    font-weight:bold;
    background-color:#3c763d;
}


.textClass{ 
	font-weight:bold; 
}*/

input:focus {
	outline: none; 
}




    select {
        /* for Firefox */
        -moz-appearance: none;
        /* for Chrome */
        -webkit-appearance: none;
    }

        /* For IE10 */
        select::-ms-expand {
            display: none;
        }
    .dc_estilos {
        -webkit-appearance: none !important;
        border: none !important;
        background: #337ab7 !important;
        box-shadow: none !important;
        color: white !important;
    }

    input[type=checkbox] {
        /* Double-sized Checkboxes */
        -ms-transform: scale(2); /* IE */
        -moz-transform: scale(2); /* FF */
        -webkit-transform: scale(2); /* Safari and Chrome */
        -o-transform: scale(2); /* Opera */
        padding: 10px;
    }

    /* Might want to wrap a span around your checkbox text */
    .checkboxtext {
        /* Checkbox text */
        font-size: 110%;
        display: inline;
    }

    .no_caja {
        background: none !important;
        border: none !important;
        box-shadow: none !important;
    }

    .load_pk {
        position: fixed;
        z-index: 2001 !important;
        height: 100%;
        display: none;
        border: 0;
        padding: .5em 1em;
        overflow: auto;
        top: 0%;
        left: 0%;
        background: white;
        width: 100%;
        border: none;
        opacity: 0.8;
    }

    .imagen_loading2 {
        position: absolute;
        z-index: 2000 !important;
        top: 35%;
        left: 43%;
        width: 300px;
        height: 300px;
        background: url('../../Content/img/gif/loader3.gif');
    }

    tr {
        cursor: pointer;
    }

    .counter_lr {
        padding: 8px;
        color: #ccc;
    }

    .agregar {
        border-radius: 20px !important;
        background: #3479bf !important;
        border: solid 1px white !important;
    }

        .agregar:hover {
            border-radius: 20px !important;
            background: white !important;
            border: solid 1px #3479bf !important;
            color: #3479bf !important;
        }

    .lectura {
        border: none !important;
        background: none !important;
        box-shadow: none !important;
    }

    .modal-dialog {
        width: 75% !important;
        padding: 2em;
        height: 90% !important;
        min-height: 90% !important;
    }

    .modal-content {
        height: 90% !important;
    }

    .modal-lg {
        max-width: 80% !important;
    }

    .panel_cajas {
        float: left;
        border: solid 1px #3479bf;
        border-radius: 5px;
        padding: .5em;
        margin: 1em;
    }

    .modal-header-primary {
        color: #fff;
        padding: 9px 15px;
        border-bottom: 1px solid #eee;
        background-color: #3479bf;
        -webkit-border-top-left-radius: 5px;
        -webkit-border-top-right-radius: 5px;
        -moz-border-radius-topleft: 5px;
        -moz-border-radius-topright: 5px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }

    .x {
        transition: transform .25s ease-in-out;
        color: white !important;
    }

        .x:hover {
            transform: rotate(180deg);
            color: white !important;
        }

        .x:before {
            transform: rotate(45deg);
            transform-origin: center;
        }

        .x:after {
            transform: rotate(-45deg);
            transform-origin: center;
        }
</style>
</div>
<input type="hidden" id="caja_number_po">

<div id="loading_pk" class="load_pk">
    <div id="spinner" class="imagen_loading2" style=""></div>
</div>

<div class="container-fluid" style="padding-left:3em;">
    <h2 style="padding-left:2em; ">New Packing List</h2><br />
    <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <div class="row" style="margin-left: 3em;">
        <div class="form-group ">
            <div class="form-group col-sm-3 " id="div_customer">
                <label for="caja_by_trans" class=" col-form-label">Order&nbsp;</label><br />
                <select class="form-control js-example-basic-single pedidos pk" id="caja_pedido_pk"></select>
            </div>
            <div class="form-group col-sm-3 " id="div_shipto"></div>
            <div class="form-group col-sm-3 " id="div_driver">
                <label for="caja_by_trans" class=" col-form-label">Driver&nbsp;</label><br />
                <select class="form-control js-example-basic-single conductores pk" id="caja_conductor_pk"></select>
            </div>
            <div class="form-group col-sm-3 " id="div_container" style="padding: 0;">
                <label for="caja_by_trans" class=" col-form-label">Container&nbsp;</label><br />
                <select class="form-control js-example-basic-single contenedores pk" id="caja_contenedor_pk"></select>
            </div>
        </div>
    </div>
    <div class="row" style="margin-left: 3em;">
        <div class="form-group ">
            <div class="form-group col-sm-3 ">
                <label for="caja_by_trans" class=" col-form-label pk">Seal </label>
                <input type="text" class="form-control numeric pk"   maxlength="10" id="caja_seal_pk">
            </div>
            <div class="form-group col-sm-3 ">
                <label for="caja_by_trans" class=" col-form-label pk ">Replacement</label>
                <input type="text" class="form-control validacion pk"   maxlength="50" id="caja_replacement_pk">
            </div>
            <div class="form-group col-sm-3" style="">
                <label for="caja_by_trans" class=" col-form-label pk">Type</label>
                <select id="caja_tipo_pk" class="form-control pk">
                    <option value="1">1st QUALITY</option>
                    <option value="2">EXT-DMG</option>
                </select>
            </div>
            <div class="form-group col-sm-3" style="padding-left:0px;">
                <label for="caja_num_envio" class=" col-form-label pk">Ship #</label>
                <select class="form-control  pk" id="caja_num_envio">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                    <option>10</option>
                </select>
            </div>
        </div>
    </div>
    <div class="row" style="margin-left: 3em;">
        <div class="form-group">
            <div class="form-group col-sm-3 " style="">
                <label class="custom-control-label" for="check_ucclabels">Labels/TPM</label>
                <select class="form-control  pk" id="check_ucclabels">
                    <option value="0">None</option>
                    <option value="1">UCC Label's</option>
                    <option value="2">TPM</option>
                </select>
            </div>
            <div class="form-group col-sm-3 ">
                <div class="div_tabla_labels" style="visibility:hidden;">
                    <table id="tabla_ucc_labels" class="fold-table table table-striped table-hover ">
                        <thead style=""><tr><th>Label</th><th><button type="button" title="Add label" class="btn btn-sm btn-success " onclick="agregar_row_label()"><b>+</b></button></th></tr></thead>
                        <tbody class="rows_ucc_labels"></tbody>
                    </table>
                </div>
            </div>
            <div class="form-group col-sm-3 " style="margin-top: 1em; margin-bottom: 0px;">
                <input type="checkbox" id="caja_unico_forzado" />
                <span class="checkboxtext">
                    &nbsp;&nbsp;No number/final part
                </span><br />
                <input type="checkbox" id="caja_sin_pk" />
                <span class="checkboxtext">
                    &nbsp;&nbsp;No PK
                </span>
            </div>
            <div class="form-group col-sm-3" style="padding-left:0px;">
                <label for="caja_repeticiones_fila" class=" col-form-label pk">Rows to add</label>
                <select class="form-control  pk" id="caja_repeticiones_fila">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                    <option>10</option>
                </select>
            </div>
            <!-- <br /><button type="button" class="btn btn-primary  mb-2" id="boton_guardar_pk" onclick="guardar_pk(event);" style="float:left; ">Next <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span></button>-->
        </div>
    </div>

    <div class="row" id="div_hottopic" style="display:none; padding:0px;margin-left: 3em;">
        <div style="margin-left: 3em;">
            <center><h4 >Styles</h4></center>
            <table id="" class="fold-table table table-striped table-hover " style="margin:0px;">
                <thead style="background:#3479bf; color:white;">
                    <tr>                        
                        <th style=" width:10%;">#</th>
                        <th style=" width:20%;">PO#</th>
                        <th style=" width:20%;">Style</th>
                        <th style=" width:20%;">Description</th>
                        <th style=" width:20%;">Color</th>
                        <th style=" width:9%;">Packing type</th>
                        <th style=" width:1%;"></th>
                    </tr>
                </thead>
            </table>
            <div style="overflow:auto; height:200px;">
                <table id="tabla_estilos_ht" class="fold-table table table-striped table-hover " style="margin:0px;">
                    <tbody class="rows_estilos_ht"></tbody>
                </table>
            </div>
        </div>
        <br />
        <br />
        <div style="margin-left: 3em;">
            <center><h4>Selected styles</h4></center>
            <table id="tabla_temporal_ht" class="fold-table table table-striped table-hover tblnavigate ">
                <thead class="cabecera_tabla_temporal_ht" style="background:#3479bf; color:white;">                    
                </thead>
                <tbody class="rows_tabla_temporal_ht"></tbody>
            </table>
            <button type="button"  title="Save" class="btn btn-primary mb-2" id="boton_guardar_pk_ht" onclick="revisar_informacion_pk_ht(event)" style="float:right; margin:1em;">Save</button>
        </div>
    </div>











    <div class="row" id="div_pedido_dropdown" style="visibility:hidden; padding:0px;margin-left: 3em;">
        <div class="form-group col-sm-3 ">
            <label for="caja_by_trans" class=" col-form-label">Styles by order</label><br />
            <select class="form-control js-example-basic-single pedidos_estilos" id="caja_pedido_estilo"></select>
        </div>
    </div>


    <div class="row" id="div_estilos" style="display:none;padding:0px;">
        <center><h4>Styles</h4></center>
        <table id="" class="fold-table table table-striped table-hover " style="margin-top:0px;">
            <thead style="background:#3479bf; color:white;">
                <tr>
                    <th style="visibility:hidden;  border:none; width:6%;"></th>
                    <th style=" width:15%;">Style</th>
                    <th style=" width:24%;">Description</th>
                    <th style=" width:10%;">Color</th>
                    <th style=" width:43%;">Packing type</th>
                    <th style="visibility:hidden;  border:none;  width:1%;"></th>
                    <th style="visibility:hidden;  border:none;  width:1%;"></th>
                </tr>
            </thead>
        </table>
        <div style="overflow:auto; height:250px;">
            <table id="tabla_estilos" class="fold-table table table-striped table-hover " style="margin:0px;">
                <tbody class="rows_estilos"></tbody>
            </table>
        </div>
    </div> 

    <div id="div_tabla_temporal" class="row" style="visibility:hidden; margin-left: 3em; padding:0px;">
        <center><h4>Selected styles</h4></center>
        <table id="tabla_temporal" class="fold-table table table-striped table-hover tblnavigate">
            <thead class="cabecera_tabla_temporal" style="background:#3479bf; color:white;"></thead>
            <tbody class="rows_tabla_temporal"></tbody>
        </table>
        <button type="button"  title="Save" class="btn btn-primary mb-2" id="boton_guardar_pk" onclick="revisar_informacion_pk(event)" style="float:right; margin:1em; margin-right:5em;">Save</button>
    </div>






    <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <br />
    <a type="button"  title="Return"  class="btn btn-secondary btn-sm " id="boton_regresar_inventario" href="@Url.Action("Index", "Shipping")" style="float:left; "><span class="glyphicon glyphicon-backward" aria-hidden="true"></span> Back</a>
</div>


<!--<th style="visibility:hidden; width:1px;"></th>
-->
