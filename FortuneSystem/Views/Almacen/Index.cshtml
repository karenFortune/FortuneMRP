@model IEnumerable<FortuneSystem.Models.Almacen.Inventario>
@{
    ViewBag.Title = "STOREHOUSE";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

</div>
<script src="~/Content/Chart.js-master/Chart.min.js"></script>
<script src="~/Content/Chart.js-master/moment.js"></script>
<script src="~/Content/Chart.js-master/Chart.bundle.min.js"></script>
<script>
    $(document).on("input", ".numeric", function () {
        this.value = this.value.replace(/\D/g, '');
    });
    $(document).on("input", "#caja_po_ed", function () { $('#caja_po_ed').autocomplete({ source: '@Url.Action("Autocomplete_po")'         }); });
    $(document).on("input", "#caja_pais_ed", function () { $('#caja_pais_ed').autocomplete({ source: '@Url.Action("Autocomplete_paises")' }); });
    $(document).on("input", "#caja_fabricante_ed", function () { $('#caja_fabricante_ed').autocomplete({ source: '@Url.Action("Autocomplete_fabricantes")' }); });
    $(document).on("input", "#caja_color_ed", function () { $('#caja_color_ed').autocomplete({ source: '@Url.Action("Autocomplete_colores_codigos")' }); });
    $(document).on("input", "#caja_body_type_ed", function () { $('#caja_body_type_ed').autocomplete({ source: '@Url.Action("Autocomplete_body_type")' }); });
    $(document).on("input", "#caja_size_ed", function () { $('#caja_size_ed').autocomplete({ source: '@Url.Action("Autocomplete_tallas")' }); });
    $(document).on("input", ".size_item_ed", function () { $('.size_item_ed').autocomplete({ source: '@Url.Action("Autocomplete_tallas")' }); });
    $(document).on("input", "#caja_genero_ed", function () { $('#caja_genero_ed').autocomplete({ source: '@Url.Action("Autocomplete_generos")' }); });
    $(document).on("input", "#caja_fabric_type_ed", function () { $('#caja_fabric_type_ed').autocomplete({ source: '@Url.Action("Autocomplete_telas")' }); });
    $(document).on("input", "#caja_fabric_percent_ed", function () { $('#caja_fabric_percent_ed').autocomplete({ source: '@Url.Action("Autocomplete_percents")' }); });
    $(document).on("input", "#caja_customer_name_ed", function () { $('#caja_customer_name_ed').autocomplete({ source: '@Url.Action("Autocomplete_customer_name")' }); });

    $(document).on("input", "#caja_unidad_ed", function () { $('#caja_unidad_ed').autocomplete({ source: '@Url.Action("Autocomplete_unidades")' }); });
    $(document).on("input", "#caja_locacion_ed", function () { $('#caja_locacion_ed').autocomplete({ source: '@Url.Action("Autocomplete_locacion")' }); });
    $(document).on("input", "#caja_family_trim_ed", function () { $('#caja_family_trim_ed').autocomplete({ source: '@Url.Action("Autocomplete_family")' }); });
    $(document).on("input", "#caja_location_ed", function () { $('#caja_location_ed').autocomplete({ source: '@Url.Action("Autocomplete_ubicacion")' }); });
    $(document).on("input", "#caja_purchased_for_ed", function () { $('#caja_purchased_for_ed').autocomplete({ source: '@Url.Action("Autocomplete_cliente_final")' }); });
    $(document).on("input", "#caja_descripcion_ed", function () { $('#caja_descripcion_ed').autocomplete({ source: '@Url.Action("Autocomplete_trims")' }); });
    $(document).on("input", "#caja_yarn_ed", function () { $('#caja_yarn_ed').autocomplete({ source: '@Url.Action("Autocomplete_yarns")' }); });
    $(document).on("input", "#caja_unit_trim_ed", function () { $('#caja_unit_trim_ed').autocomplete({ source: '@Url.Action("Autocomplete_units")' }); });

    function guardar_sellos_index(event) {
        var error = 0;
        $(".must").each(function () {
            var id = $(this).attr('id');
            if ($(this).val() == '' && $(this).val() != "0") {
                $("#" + id).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $("#" + id).css('border', '1px solid #cccccc');
            }
        });

        if ($("#caja_sucursal").val() == "Select") {
            $("#caja_sucursal").css('border', '2px solid #e03f3f');
            error++;
        } else {
            $("#caja_sucursal").css('border', '1px solid #cccccc');
        }

        if ($("#caja_inicio").val() != '' && $("#caja_final").val() != '') {
            if (parseFloat($("#caja_inicio").val()) > parseFloat($("#caja_final").val())) {
                error++;
                $("#caja_final").css('border', '2px solid #e03f3f');
                $("#caja_inicio").css('border', '2px solid #e03f3f');
            } else {
                $("#caja_final").css('border', '1px solid #cccccc');
                $("#caja_inicio").css('border', '1px solid #cccccc');
            }
        }

        if (error == 0) {
            guardar_sello_nuevo();
        } else {
            event.preventDefault();
            alertify.alert('¡Error!', 'Favor de revisar los campos.');
            return false;
        }

    }

    function guardar_sello_nuevo() {
        var inicio = $("#caja_inicio").val(), final = $("#caja_final").val(), sucursal = $("#caja_sucursal").val();
        var actionData = "{'inicio':'" + inicio + "','final':'" + final + "','sucursal':'" + sucursal + "'}";
        $.ajax({
            url: '/Almacen/guardar_nuevo_sello',
            data: actionData,
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                limpiar_formularios();
                $("#modal_nuevos_sellos").modal("hide");
            }
        });
    }

    function limpiar_formularios() {
        $(".numeric").each(function () {
            $(this).val("");
        });
        $('#caja_sucursal').val("Select");
    }
    function editar_item(ID) {
        $.ajax({
            url: '/Almacen/edicion_inventario',
            data: "{'ID':'"+ID+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                limpiar_formularios();
               // $("#modal_nuevos_sellos").modal("show");
            }
        });
    }
    $(document).on("dblclick", "#tabla_inventario tr", function () {
        var row = this.rowIndex;
        //alert($('#items_recibos tr:eq('+row+') td:eq(0)').html()); //empieza las columas desde 0
        //alert($('#items_recibos tr:eq(' + row + ') td:nth-child(2)').html());     //empieza las columnas desde 1
        //ver_recibo($('#tabla_inventario tr:eq(' + row + ') td:eq(0)').html());
        var id = $('#tabla_inventario tr:eq(' + row + ') td:eq(0)').html();
        $("#ContenedorModal").load("/Almacen/edicion_inventario/" + id, function () {
            $("#modal_editar_inventario").modal("show");
        });
    });
    //CAMBIAR LOS ROW DE COLOR
    $(document).on("click", "#tabla_inventario tr", function () {
        var row = this.rowIndex;
        if (this.style.background == "" || this.style.background == "white") {
            $(this).css('background', '#46a772');
            $(this).css('color', 'white');
        } else {
            $(this).css('background', 'white');
            var stock = $('#tabla_inventario tr:eq(' + row + ') td:eq(6)').html();
            if (stock == "STOCK") {
                $(this).css('color', '#3c763d');
            } else {
                $(this).css('color', '#a94442');
            }
            
        }
    });
    function cerrar_graficas() {
        $("#graficas").css('display','none');
    }
    function abrir_graficas() {
        $("#graficas").css('display', 'inline');
    }
    $(document).ready(function () {
        $("#loading").css('display','inline');
        //obtener_charts();
        //obtener_charts_transferencias();
        busqueda_items("");  
        
    });
    function obtener_charts() {
        /*$.ajax({
            url: "/Almacen/buscar_datos_grafica",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                datos = result.split('*');
                var ctx = document.getElementById("myChart");
                var staging_chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ["Today", "Yesterday", "Last 7 days", "Current month", "Current year"],
                        datasets: [{
                            label: 'Receive totals',
                            //data: [12, 19, 3, 5, 2, 3],                   
                            data: datos,
                            backgroundColor: [
                                '#2ecc71',
                                '#3498db',
                                '#32CFD0',
                                '#9b59b6',
                                '#F45151'
                            ],
                            borderColor: [
                                '#2ecc71',
                                '#3498db',
                                '#32CFD0',
                                '#9b59b6',
                                '#F45151'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        
                    }
                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });*/



    }
    function obtener_charts_transferencias() {
        /*$.ajax({
            url: "/Almacen/buscar_datos_grafica_transferencias",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                datos = result.split('*');
                var ctx = document.getElementById("myChart2");
                var staging_chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ["Today", "Yesterday", "Last 7 days", "Current month", "Current year"],
                        datasets: [{
                            label: 'Receive totals',
                            //data: [12, 19, 3, 5, 2, 3],                   
                            data: datos,
                            backgroundColor: [
                                '#F45151',
                                '#9b59b6',
                                '#32CFD0',
                                '#3498db',
                                '#2ecc71'
                            ],
                            borderColor: [
                                '#F45151',
                                '#9b59b6',
                                '#32CFD0',
                                '#3498db',
                                '#2ecc71'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {

                    }
                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }
        });*/
    }
    /********************************************************************************************************************************************************************** */
    function busqueda_items_almacen() {
        busqueda_items($("#caja_buscar_item").val());
    }
    function busqueda_items(busqueda) {
        $.ajax({
            url: "/Almacen/buscar_items_tabla_inventario",
            data: "{'busqueda':'" + busqueda + "'}",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = ''; 
                $.each(result, function (key, item) {
                    if (item.estado =="STOCK") {
                        html += '<tr style="color:#3c763d;">';
                    } else {
                        html += '<tr style="color:#a94442;">';
                    }                    
                    html += '<td style="width:5%;">' + item.id_inventario + '</td>';
                    html += '<td style="width:10%;">' + item.sucursal + '</td>';
                    html += '<td style="width:15%;">' + item.po + '</td>';
                    html += '<td style="width:10%;">' + item.total + '</td>';
                    html += '<td style="width:10%;">' + item.categoria_inventario + '</td>';
                    html += '<td style="width:40%;">' + item.descripcion + '</td>';
                    html += '<td style="width:10%;">';
                    html += '<button type="button"  class="btn edit_driver edicion_driver" onclick="cambiar_ubicacion(' + item.id_inventario + ')" style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-retweet" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                    html += '</td>';
                    html += '</tr>';
                });
                $(".body_tabla_inventario").html(html);
                $("#loading").css('display', 'none');
            },
            error: function (errormessage) { alert(errormessage.responseText); }
        });
    }

    $(document).on("click", "a", function () {
        //setTimeout(function () { $("#loading").css('display', 'none'); }, 1000);
        $("#loading").css('display', 'none'); 
    });
    /****************************************************************************///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /****************************************************************************///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

     function test_busqueda() {
        var item, descripcion, color, size, gender;
        if ($("#caja_busqueda_item_ed").val() != '') { item = $("#caja_busqueda_item_ed").val() } else { item = '' }
        if ($("#caja_busqueda_descripcion_ed").val() != '') { descripcion = $("#caja_busqueda_descripcion_ed").val() } else { descripcion = '' }
        if ($("#caja_busqueda_color_ed").val() != '') { color = $("#caja_busqueda_color_ed").val() } else { color = '' }
        if ($("#caja_busqueda_size_ed").val() != '') { size = $("#caja_busqueda_size_ed").val() } else { size = '' }
        if ($("#caja_busqueda_gender_ed").val() != '') { gender = $("#caja_busqueda_gender_ed").val() } else { gender = '' }

        var actionData = "{'item':'"+item+"','descripcion':'"+descripcion+"','color':'"+color+"','size':'"+size+"','gender':'"+gender+"'}";
        $.ajax({
            url: '/Almacen/busqueda_dinamica_items',
            data: actionData,
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (result) {
                var html = '';
                $.each(result, function (key, item) {
                    html += '<tr>' +
                        '<td style="width:5%;">' + item.id_item + '</td>' +
                        '<td style="width:10%;">' + item.item_nombre + '</td>' +
                        '<td style="width:20%;">' + item.descripcion + '</td> ' +
                        '<td style="width:10%;">' + item.color + '</td> ' +
                        '<td style="width:5%;">' + item.size + '</td> ' +
                        '<td style="width:10%;">' + item.gender + '</td> ' +
                        '<td style="width:10%;">' + item.fabric_type + '</td> ' +
                        '<td style="width:10%;">' + item.fabric_percent + '</td> ' +
                        '<td style="width:10%;">' + item.yarn + '</td> ';
                    html += '<td>';
                    html += '<button type="button"  class="btn boton_tabla " onclick="editar_item('+item.id_item+')"  style="padding: 0em 0.3em !important;  background:none; color:#3479bf; font-weight: bolder; " > <span class="glyphicon glyphicon-pencil" aria-hidden="true"  style="padding 0px !important;"></span> </button>';
                    html += '</td>';
                    html+='</tr>';
                });
                $(".resultados_items_recibo").html(html);
            }
        });
    }
    $(document).on("click", ".btn_abrir_modificar_item", function () {
        test_busqueda();
        $("#edit_blanks_form").css('display','none');
    });

    function editar_item(id) {
         $.ajax({
            url: '/Almacen/buscar_informacion_item',
            data: "{'id':'"+id+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
             success: function (result) {
                $("#edit_blanks_form").css('display','inline');
                 $("#id_item_edicion").val(id);
                 debugger
                $("#caja_item_ed").val(result.item_nombre);
                $("#caja_fabricante_ed").val(result.fabricante);
                $("#caja_color_ed").val(result.color);
                $("#caja_body_type_ed").val(result.body_type);
                $("#caja_genero_ed").val(result.gender);
                $("#caja_fabric_type_ed").val(result.fabric_type);
                $("#caja_fabric_percent_ed").val(result.fabric_percent);
                $("#caja_yarn_ed").val(result.yarn);
                $("#caja_size_ed").val(result.size);
            }
        });
    }
    function guardar_edicion_item(event) {
        var error = 0;
        $(".must_blank_ed_in").each(function () {
            var id = $(this).attr('id');
            if ($(this).val() == '') {
                $("#" + id).css('border', '2px solid #e03f3f');
                error++;
            } else {
                $("#" + id).css('border', '1px solid #cccccc');
            }
        });
        var item, manufacturer, color, size, body_type, gender, fabric_type, fabric_percent, yarn, descripcion;
        if ($("#caja_item_ed").val() == "") { item = "N/A"; } else { item = $("#caja_item_ed").val(); }
        if ($("#caja_fabricante_ed").val() == "") { manufacturer = "N/A"; } else { manufacturer = $("#caja_fabricante_ed").val(); }
        if ($("#caja_size_ed").val() == "") { size = "N/A"; } else { size = $("#caja_size_ed").val(); }
        if ($("#caja_color_ed").val() == "") { color = "N/A"; } else { color = $("#caja_color_ed").val(); }
        if ($("#caja_body_type_ed").val() == "") { body_type = "N/A"; } else { body_type = $("#caja_body_type_ed").val(); }
        if ($("#caja_genero_ed").val() == "") { gender = "N/A"; } else { gender = $("#caja_genero_ed").val() }
        if ($("#caja_fabric_type_ed").val() == "") { fabric_type = "N/A"; } else { fabric_type = $("#caja_fabric_type_ed").val(); }
        if ($("#caja_fabric_percent_ed").val() == "") { fabric_percent = "N/A"; } else { fabric_percent = $("#caja_fabric_percent_ed").val(); }
        //if ($("#caja_division").val() == "") { division = "N/A"; } else { division = $("#caja_division").val();}
        if ($("#caja_yarn_ed").val() == "") { yarn = "N/A"; } else { yarn = $("#caja_yarn_ed").val(); }
        descripcion = manufacturer + " " + gender + " " + body_type + " " + color; minimo = 0;
        if (error == 0) {
             $.ajax({
                url: '/Almacen/guardar_edicion_items',
                data: "{'id':'"+$("#id_item_edicion").val()+"','item':'"+item+"','manufacturer':'"+manufacturer+"','size':'"+size+"','color':'"+color+"','body_type':'"+body_type+"','gender':'"+gender+"','fabric_type':'"+fabric_type+"','fabric_percent':'"+fabric_percent+"','yarn':'"+yarn+"','descripcion':'"+descripcion+"'}",
                contentType: 'application/json',
                dataType: 'json',
                type: 'post',
                success: function (result) {       
                    if (result == 0) {
                        $("#modal_formulario_nuevo_item").modal("hide");
                        alertify.success('Success!');
                        alertify.set('notifier', 'position', 'top-right');
                        $("#edit_blanks_form").css('display','none');
                    } else {
                        alertify.alert('Error!', 'This item is already in our database');
                        event.preventDefault();
                        return false;
                    }                  
                }
            });
        } else {
            alertify.alert('Error!', 'Check empty fields, please');
            event.preventDefault();
            return false;
        }
    }
    /****************************************************************************///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /****************************************************************************///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    function cambiar_ubicacion(id) {
        $.ajax({
            url: '/Almacen/buscar_inventario_ubicacion',
            data: "{'id':'"+id+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                var result = jsonData.Data.item, ubicaciones = jsonData.Data.locations;
                var id_ubicacion = 0;
                $.each(result, function (key, item) {
                    $("#caja_id_location").val(item.id_inventario);
                    $("#caja_item_location").val(item.descripcion);
                    $("#caja_old_location").val(item.location);
                    $("#caja_total_location").val(item.total);
                    $("#caja_nuevo_total_location").val(item.total);
                    id_ubicacion = item.id_location;
                });
                var html = '';
                $.each(ubicaciones, function (key, item) {
                    if (item.id_ubicacion != id_ubicacion) {
                        html += '<option  value="' + item.id_ubicacion + '">' + item.ubicacion + '</option>';
                    }
                });
                $("#caja_nueva_location").html(html);
                $("#modal_ubicaciones").modal("show");
            }
        });
    }

    function revisar_cambio_ubicacion(event) {
        if ($("#caja_nuevo_total_location").val() != '' && $("#caja_nuevo_total_location").val() != 0 && parseFloat($("#caja_nuevo_total_location").val()) <= parseFloat($("#caja_total_location").val())) {
            $.ajax({
            url: '/Almacen/cambiar_ubicacion',
            data: "{'id':'"+$("#caja_id_location").val()+"','old_total':'"+$("#caja_total_location").val()+"','new_total':'"+$("#caja_nuevo_total_location").val()+"','ubicacion':'"+$("#caja_nueva_location").val()+"'}",
            contentType: 'application/json',
            dataType: 'json',
            type: 'post',
            success: function (jsonData) {
                 $("#modal_ubicaciones").modal("hide");
                 alertify.success('Success!');
                 alertify.set('notifier', 'position', 'top-right');
                 busqueda_items($("#caja_buscar_item").val());
            }
        });
        } else {
            alertify.alert('Error!', 'Check quantities, please');
            event.preventDefault();
            return false;
        }
    }
    
</script>
<link href="~/Content/base_m.css" rel="stylesheet" />

<style>
    .results tr[visible='false'],
    .no-result {
        display: none;
    }

    .results tr[visible='true'] {
        display: table-row;
    }

    .counter {
        padding: 8px;
        color: #ccc;
    }


    .modal-dialog {
        width: 75% !important;
        padding: 2em;
        height: 90% !important;
        min-height: 90% !important;
    }

    .modal-content {
        height: 90% !important;
    }

    .modal-lg {
        max-width: 80% !important;
    } 

    a {
        text-decoration: none !important;
    }  

    .boton_barra_menu, .btn-info {
        color: #fff;
        background-color: #3479bf !important;
        border-color: #3479bf !important;
    }

    .modal {
        /*z-index: 4 !important;*/
    }

    .dataTables_filter {
    
    }

    .dropbtn {
        background-color: #3479bf;
        color: white;
        padding: 16px;
        /*padding: 0.40em;*/
        font-size: 18px;
        border: none;
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        color: black;
        min-width: 160px;
        box-shadow: 1px 5px 25px 1px rgba(0,0,0,0.2);
        z-index: 1;
    }

    .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
    }

    .menu {
        background: #3479bf;
        border-radius: 5px;
        border: solid 1px #3479bf;
        margin-bottom: .5em;
        margin: 1em;
    }

    .dropdown-content a:hover {
        /*background-color: #f1f1f1;
        color: black;*/
        background-color: #61b363;
        color:white;
    }

    .dropdown:hover .dropdown-content {
        display: block;
    }


    .modal-header-primary {
        color: #fff;
        padding: 9px 15px;
        border-bottom: 1px solid #eee;
        background-color: #3479bf;
        -webkit-border-top-left-radius: 5px;
        -webkit-border-top-right-radius: 5px;
        -moz-border-radius-topleft: 5px;
        -moz-border-radius-topright: 5px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }
    
    .x { 
        transition: transform .25s ease-in-out; 
        color:white !important;
    }
    
    .x:hover {
        transform: rotate(180deg);
        color:white !important;
    }

    .x:before {
        transform: rotate(45deg);
        transform-origin: center;
    }

    .x:after {
        transform: rotate(-45deg);
        transform-origin: center;
    }

    #boton_cerrar_graficas {
        cursor: pointer;
        float: right;
        color: #71bb73 !important;
        margin: 0.5em;
        font-size: 2em;
        padding: 0em 0.5em .05em .5em;
        font-weight: bolder;
        border: 2px solid #71bb73;
        border-radius: 25px;
    }
        #boton_cerrar_graficas:hover {
            color: white !important;
            border: 2px solid white;
            background: #71bb73;
        }
    .boton_menu {
        border: none;
        color: black;
        background: white;
        width: 100%;
        text-align: left;
        padding: 0.5em
    }

        .boton_menu:hover {
            border: none;
            background: #61b363;
            color: white;
            width: 100%;
            text-align: left;
        } 
</style>

<div class="container-fluid" style="padding-left:7em; padding-right:3em;">
    <h3>Warehouse</h3>
    <div id="graficas" style="width:90%;height:50%; display:none; position:absolute; z-index:99; background:white; border-radius:35px; border:5px solid #61b363; padding-left:2em; margin-top:5em;">
        <div class="x" id="boton_cerrar_graficas" onclick="cerrar_graficas()" style="">x</div>

        <div style="width:45% !important; height:45% !important; float:left;">
            <h2>Receive chart</h2>
            <canvas id="myChart"> </canvas>
        </div>
        <div style="width:45% !important; height:45% !important; float:left;">
            <h2>Transfers chart</h2>
            <canvas id="myChart2"> </canvas>
        </div>
    </div>
    <div class="row " style=" ">
        <div class="menu">
            <!-- <div class="dropdown">
         <button class="dropbtn" type="button" href="#modal_formulario_nuevo_item" data-toggle="modal">
             New item
         </button>
     </div>-->

            <div class="dropdown">
                <button class="dropbtn">Items</button>
                <div class="dropdown-content">
                    <a href="#modal_formulario_nuevo_item" data-toggle="modal" class="btn_new_item">New</a>
                    <a href="#modal_tabla_edicion_item" data-toggle="modal" class="btn_abrir_modificar_item">Edit</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Receive</button>
                <div class="dropdown-content">
                    <a href="@Url.Action("recibo_items", "Almacen")">New receive</a>
                    <a href="#modal_listado_recibos" data-toggle="modal" class="btn_abrir_lista_recibos">Receive list</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Transfers </button>
                <div class="dropdown-content">
                    <a href="@Url.Action("nueva_transferencia", "Almacen")">New transfer</a>
                    <a href="@Url.Action("nueva_transferencia_qr", "Almacen")">New transfer scan</a>
                    <a href="#modal_nuevos_sellos" data-toggle="modal">New seal package</a>
                    <a href="#modal_aprobar_transferencia" data-toggle="modal">See transfers</a>
                    <a href="#modal_recibir_transferencias" data-toggle="modal" class="btn_recibir_transferencia">Receive transfers</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Reports </button>
                <div class="dropdown-content">
                    <a href="@Url.Action("excel_diario", "Almacen")">Daily</a>
                </div>
            </div>

            <div class="dropdown">
                <button class="dropbtn" type="button" onclick="abrir_graficas()"></button>
            </div>

            <div class="dropdown">
                <button class="dropbtn">Extra</button>
                <div class="dropdown-content">
                    <a href="#modal_recibos" data-toggle="modal">Receives</a>
                    <a href="#modal_staging" data-toggle="modal">Staging</a>
                </div>
            </div>

        </div>


    <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->


            <div class="modal fade" id="modal_nuevos_sellos" data-target="#modal_nuevos_sellos">
                <div class="modal-dialog" style="width:30% !important; height:15% !important;">
                    <div class="modal-content">
                        <div class="modal-header orange modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title"><strong></strong>Add seal package</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <div class="form-group col-3">
                                    <label for="caja_inicio">First seal </label>
                                    <input type="text" class="form-control numeric must " maxlength="10" onkeydown="upperCaseF(this)" id="caja_inicio">
                                </div>
                                <div class="form-group col-3">
                                    <label for="caja_final">Last seal</label>
                                    <input type="text" class="form-control numeric  must " maxlength="10" onkeydown="upperCaseF(this)" id="caja_final">
                                </div>
                                <div class="form-group col-3">
                                    <label for="caja_sucursal">Branch office </label>
                                    <select type="text" class="form-control" id="caja_sucursal">
                                        <option>Select</option>
                                        <option value="1">Fortune</option>
                                        <option value="2">Lucky one</option>
                                    </select>
                                </div>
                                <div class="form-group col-3">
                                    <br />
                                    <button type="button" class="btn btn-primary mb-2" id="boton_guardar_sello" onclick="guardar_sellos_index(event);">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal_listado_recibos" data-target="#modal_listado_recibos">
                <div class="modal-dialog" style="width:90% !important; padding:0px;">
                    <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
                        <div class="modal-header orange  modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title"><strong></strong>Receives and details</h4>
                        </div>
                        <div class="modal-body " id="contenedor_modal_listado_recibos">

                            @{
                                Html.RenderAction("lista_recibos", "Almacen");
                            }

                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal_formulario_nuevo_item" data-target="#modal_formulario_nuevo_item">
                <div class="modal-dialog">
                    <div class="modal-content" style="overflow:auto;">
                        <div class="modal-header orange modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>

                            </button>
                            <h4 class="modal-title"><strong></strong>New item</h4>

                        </div>
                        <div class="modal-body">
                            @{
                                Html.RenderPartial("formulario_nuevo_item");
                            }
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal_formulario_recibo" data-target="#modal_formulario_recibo">
                <div class="modal-dialog">
                    <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
                        <div class="modal-header orange modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title"><strong></strong>New receive</h4>
                        </div>
                        <div class="modal-body " id="contenedor_modal_recibos">
                            @{
                                //Html.RenderPartial("formulario_recibo");
                            }
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal_aprobar_transferencia" data-target="#modal_aprobar_transferencia">
                <div class="modal-dialog">
                    <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
                        <div class="modal-header orange modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title"><strong></strong>Approval of transfers</h4>
                        </div>
                        <div class="modal-body ">

                            @{
                                Html.RenderAction("lista_transferencias", "Almacen");
                            }

                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal_editar_inventario" data-target="#modal_editar_inventario">
                <div class="modal-dialog">
                    <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
                        <div class="modal-header orange modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title"><strong></strong>Modify inventory item</h4>
                        </div>
                        <div class="modal-body">
                            <div id="ContenedorModal"></div>
                            @{
                                //Html.RenderAction("edicion_inventario", "Almacen");
                            }
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal_recibir_transferencias" data-target="#modal_recibir_transferencias">
                <div class="modal-dialog">
                    <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
                        <div class="modal-header orange modal-header-primary">
                            <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title"><strong></strong>Receive transfer</h4>
                        </div>
                        <div class="modal-body">
                            <div id="contenedor_modal_recibir_transferencia"></div>
                            @{
                                //Html.RenderAction("edicion_inventario","Almacen");
                            }
                        </div>
                    </div>
                </div>
            </div>
    
    

    </div>
    <!----LISTADO DE INVENTARIO----->
   
    <div class="panel panel-default panel-primary " style="margin-left:7em; margin-right:3em;">
        <div class="panel-heading"><h4>Inventory</h4> </div>
        <div class=" " style=" margin-top:1em;  ">
            <b style="left:0em; float:left; padding-top:.5em; padding-left:1em; ">Search </b>
            <input type="text" class="search_po form-control validacion" onkeyup="busqueda_items_almacen()" placeholder="Type to search" id="caja_buscar_item" style="width: 15em; float:left; margin-top: 0px; margin-left:1em; margin-bottom:1em; ">
        </div><br /><br /><br />
        <div style="overflow:auto; height:500px;  ">
            <table id="" class="table table-striped " style="margin:0px;">
                    <thead style=" pointer-events:none; cursor:not-allowed;">
                        <tr>
                            <th style="width:5%;">#</th>
                            <th style="width:10%;">OFFICE</th>
                            <th style="width:15%;">ORDER</th>
                            <th style="width:10%;">QUANTITY</th>
                            <th style="width:10%;">CATEGORY</th>
                            <th style="width:40%;">DESCRIPTION</th>
                            <th style="width:10%;"></th>
                        </tr>
                    </thead>                    
                </table>
            <div style="height:450px; overflow:auto;">
                <table id="tabla_inventario" class="table table-striped " style="margin:0px;">
                    <tbody class="body_tabla_inventario"></tbody>
                </table>
            </div>
        </div>
    </div>
    <div class=" col-md-4">

    </div>

    <!----LISTADO DE nclick="editar_item(item.id_inventario)" INVENTARIO----->

</div>
<div class="modal fade" id="modal_tabla_edicion_item" data-target="#modal_tabla_edicion_item">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Edit item</h4>
            </div>
            <div class="modal-body " style="margin:1.5em;">

                <div class="row" style="padding:0em 0em 0em 0em;">
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label"></label>
                        <input type="text" class=" form-control validacion" placeholder="Type item" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_busqueda_item_ed" onkeyup="test_busqueda()">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label"></label>
                        <input type="text" class=" form-control validacion" placeholder="Type description" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_busqueda_descripcion_ed" onkeyup="test_busqueda()">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label"></label>
                        <input type="text" class=" form-control validacion" placeholder="Type color" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_busqueda_color_ed" onkeyup="test_busqueda()">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label"></label>
                        <input type="text" class=" form-control validacion" placeholder="Type size" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_busqueda_size_ed" onkeyup="test_busqueda()">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label"></label>
                        <input type="text" class=" form-control validacion" placeholder="Type gender" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_busqueda_gender_ed" onkeyup="test_busqueda()">
                    </div>
                </div>

                <div class="row panel panel-default panel-primary" style=" height:200px !important; width:auto; border:none; ">
                    <table id="" class="fold-table table table-striped table-hover " style="margin:0px;">
                        <thead style="background:#3479bf; color:white;">
                            <tr>
                                <th style="width:5%;"></th>
                                <th style="width:10%;">Style</th>
                                <th style="width:20%;">Description</th>
                                <th style="width:10%;">Color</th>
                                <th style="width:5%;">Size</th>
                                <th style="width:10%;">Gender</th>
                                <th style="width:10%;">Fabric</th>
                                <th style="width:10%;">Fabric percent</th>
                                <th style="width:10%;">Yarn</th>
                                <th style="width:5%;"></th>
                                <th style="width:5%;"></th>
                            </tr>
                        </thead>
                    </table>
                    <div style="overflow:auto; height:150px ">
                        <table id="items_recibos" class="fold-table table table-striped table-hover " style="margin:0px;">
                            <tbody class="resultados_items_recibo"></tbody>
                        </table>
                    </div>

                </div>

                <div id="formulario_edicion_item" class="row" style="margin-top:2em;">
                    <input type="hidden" id="id_item_edicion" />
                    <div class="form-group" id="edit_blanks_form" style="display:none;">
                        <div class="form-group col-sm-4">
                            <label for="caja_item">Item </label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion must_blank_ed_in " maxlength="30" onkeydown="upperCaseF(this)" id="caja_item_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_fabricante">Manufacturer</label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  must_blank_ed_in " maxlength="100" onkeydown="upperCaseF(this)" id="caja_fabricante_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_color">Color</label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion must_blank_ed_in  " maxlength="50" onkeydown="upperCaseF(this)" id="caja_color_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_yarn" class=" col-form-label">Size</label>
                            <input type="text" ondrop="return false;" value="" onpaste="return false;" class="form-control validacion  must_blank_ed_in " maxlength="50" onkeydown="upperCaseF(this)" id="caja_size_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_body_type" class=" col-form-label">Body type </label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  must_blank_ed_in " maxlength="50" onkeydown="upperCaseF(this)" id="caja_body_type_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_genero" class=" col-form-label">Gender</label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion must_blank_ed_in  " maxlength="50" onkeydown="upperCaseF(this)" id="caja_genero_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_fabric_type" class=" col-form-label">Fabric type</label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  must_blank_ed_in " maxlength="50" onkeydown="upperCaseF(this)" id="caja_fabric_type_ed">
                        </div>

                        <div class="form-group col-sm-4">
                            <label for="caja_fabric_percent" class=" col-form-label">Fabric % </label>
                            <input type="text" ondrop="return false;" onpaste="return false;" class="form-control validacion  must_blank_ed_in " maxlength="50" onkeydown="upperCaseF(this)" id="caja_fabric_percent_ed">
                        </div>
                        <div class="form-group col-sm-4">
                            <label for="caja_yarn" class=" col-form-label">Yarn</label>
                            <input type="text" ondrop="return false;" value="100-POLY" onpaste="return false;" class="form-control validacion  must_blank_ed_in " maxlength="50" onkeydown="upperCaseF(this)" id="caja_yarn_ed">
                        </div>


                        <button type="button" class="btn btn-primary mb-2" id="boton_guardar" onclick="guardar_edicion_item(event)">Save</button>
                    </div>

                    
                </div>
            </div>
        </div>
    </div>
</div>











<div class="modal fade" id="modal_ubicaciones" data-target="#modal_ubicaciones">
    <div class="modal-dialog" style="width:90% !important; padding:0px;">
        <div class="modal-content" style="overflow:auto; width:100% !important; height:100% !important;">
            <div class="modal-header orange modal-header-primary">
                <button type="button" class="close x" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong></strong>Edit item</h4>
            </div>
            <div class="modal-body " style="margin:1.5em;">

                <div class="row" style="padding:0em 0em 0em 0em;">
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">#</label>
                        <input type="text" readonly class=" form-control validacion" placeholder="" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_id_location">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Item</label>
                        <input type="text" readonly  class=" form-control validacion" placeholder="" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_item_location">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Location</label>
                        <input type="text" readonly  class=" form-control validacion" placeholder="" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_old_location">
                    </div>
                    <div class="form-group col-sm-2 ">
                        <label class=" col-form-label">Total available</label>
                        <input type="text" readonly  class=" form-control numeric" placeholder="" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_total_location">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">Quantity</label>
                        <input type="text" class=" form-control numeric" placeholder="" ondrop="return false;" onpaste="return false;" maxlength="20" id="caja_nuevo_total_location">
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label">New Location</label>
                        <select class="form-control js-example-basic-single  " style="width:100%;  " id="caja_nueva_location"></select>
                    </div>
                    <div class="form-group col-sm-2  ">
                        <label class=" col-form-label"></label>
                        <button type="button" class="btn btn-primary mb-2" id="boton_guardar" onclick="revisar_cambio_ubicacion(event)">Change</button>
                    </div>
                </div>

               

               
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_recibos" data-target="#modal_recibos">
    <div class="modal-dialog modal-lg" style="width:90% !important; height:90% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>RECEIVE</strong></h4>
            </div>
            <div class="modal-body " id="">

                <iframe src="/Almacen/departamentos_recibos" style="width:100%; height: 55em; border: none;"></iframe>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal_staging" data-target="#modal_staging">
    <div class="modal-dialog modal-lg" style="width:90% !important; height:90% !important; overflow:auto;">
        <div class="modal-content" style="width:100% !important; height:100% !important; overflow:auto;  ">
            <div class="modal-header orange  modal-header-primary">
                <button type="button" class="close x " data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title"><strong>STAGING</strong></h4>
            </div>
            <div class="modal-body " id="">

                <iframe src="/Staging/departamentos_stagging" style="width:100%; height: 55em; border: none;"></iframe>
            </div>
        </div>
    </div>
</div>
























<div id="loading" class="load">
    <div id="spinner" class="imagen_loading" style=""></div>
</div>

<!-- Modal -->


<script>
    $(document).ready(function () {
        $('.js-example-basic-single').select2();
        $('.js-example-basic-single2').select2();
        $(".btnEdit").click(function () {
            var id =$(this).data("value");
            $("#ContenedorModal").load("/Almacen/edicion_inventario/"+id, function () {
                $("#modal_editar_inventario").modal("show");
            });
        });
        //btn_recibir_transferencia
        $(".btn_recibir_transferencia").click(function () {            
            $("#contenedor_modal_recibir_transferencia").load("/Almacen/lista_recepcion_transferencias" , function () {               
                $("#modal_recibir_transferencias").modal("show");
            });
        });
        //btn_ver_tabla_recibos
        $(".btn_ver_tabla_recibos").click(function () {            
            $("#contenedor_modal_recibos").load("/Almacen/formulario_recibo", function () {               
                $("#modal_formulario_recibo").modal("show");
            });
        });
        
        $(".btn_abrir_lista_recibos").click(function () {
            $("#contenedor_modal_listado_recibos").load("/Almacen/lista_recibos", function () {
                $("#modal_listado_recibos").modal("show");
            });
        });
    }); 
</script>



